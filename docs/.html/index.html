<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>T-Coffee Version_13.45.68.3c310a9 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="#" class="icon icon-home">
            T-Coffee
          </a>
              <div class="version">
                Version_13.45.68.3c310a9
              </div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-tcoffee_installation">T-Coffee Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-tcoffee_quickstart_regressive">Quick Start Regressive Algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-tcoffee_quickstart_unistrap">Quick Start Unistrap</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-tcoffee_quickstart">Quick Start T-Coffee</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-tcoffee_main_documentation">T-Coffee Main Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-tcoffee_technical_documentation">T-Coffee Technical Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-tcoffee_webserver">T-Coffee Web Server</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-tcoffee_faq">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-tcoffee_release_guide">T-Coffee release guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-tcoffee_release_notes">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-tcoffee_citations_references">Citations &amp; References</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-tcoffee_contacts_adresses">Contacts, Adresses &amp; Contributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-tcoffee_license">License &amp; Terms of Use</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">T-Coffee</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="#" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">T-Coffee Version_13.45.68.3c310a9 documentation</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="t-coffee-and-related-packages-documentation-www-tcoffee-org">
<h1>T-Coffee and related packages documentation (www.tcoffee.org)<a class="headerlink" href="#t-coffee-and-related-packages-documentation-www-tcoffee-org" title="Permalink to this heading"></a></h1>
<p>Contents:</p>
<div class="toctree-wrapper compound">
<span id="document-tcoffee_installation"></span><section id="t-coffee-installation">
<h2>T-Coffee Installation<a class="headerlink" href="#t-coffee-installation" title="Permalink to this heading"></a></h2>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This chapter has been extensively updated in 11/2016. Installation of T-Coffee versions lower than version 9.03 may now be deprecated. Contact us if you need to install an older version !</p>
</div>
<section id="installation">
<h3>Installation<a class="headerlink" href="#installation" title="Permalink to this heading"></a></h3>
<p>This chapter describes the installation procedures relevant for a standard use of T-Coffee on the most common operative systems: Unix/Linux and Mac OS. T-Coffee can only be installed on windows using virtual box simulating a Linux environement. We maintain two versions of T-Coffee:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>the ** <a href="#id1"><span class="problematic" id="id2">`</span></a>stable version &lt;<a class="reference external" href="http://tcoffee.org/Packages/tcoffee/Stable/">http://tcoffee.org/Packages/tcoffee/Stable/</a>&gt; <a href="#id3"><span class="problematic" id="id4">`</span></a>** This is an extensively evaluated version, either linked to the latest paper or benefiting from an important fix- ** recommended <a href="#id5"><span class="problematic" id="id6">**</span></a>.</p></li>
<li><p>the ** <a href="#id7"><span class="problematic" id="id8">`</span></a>beta version &lt;<a class="reference external" href="http://www.tcoffee.org/Packages/Beta/Latest/">http://www.tcoffee.org/Packages/Beta/Latest/</a>&gt; <a href="#id9"><span class="problematic" id="id10">`</span></a>** is the latest release. It passes all the main tests and is usualy of higher quality that the stable. It is recommended to start installing this version if you experience any issue with the stable.</p></li>
<li><p>the ** <a href="#id11"><span class="problematic" id="id12">`</span></a>archives  &lt;<a class="reference external" href="http://www.tcoffee.org/Packages/Archives/">http://www.tcoffee.org/Packages/Archives/</a>&gt; <a href="#id13"><span class="problematic" id="id14">`</span></a>** all previous releases of T-Coffee. If the one you need is missing please contact us.</p></li>
</ol>
</div></blockquote>
<p>T-Coffee is a complex package that interacts with many other third party software and/or servers (such as BLAST, see next section). All available versions on the server (starting from version 1.08) will install on your computer all the third party packages and setup the variables required for the different T-Coffee options to run correctly. Whenever the automated installation fails because of unforeseen system specificities, <strong>don’t hesitate to contact us</strong>. If the installation was successfull with the exception of some packages, users should install the third party package manually. This documentation gives some useful tips, but users are encouraged to send their feedbacks and share their experiences in order to improve it.</p>
<section id="unix-linux-binaries">
<h4>Unix/Linux Binaries<a class="headerlink" href="#unix-linux-binaries" title="Permalink to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>1. Download the installer package corresponding to your system from:
   http://tcoffee.org/Packages/Stable/Latest/

2. Grant execution permission to the downloaded file with the following command:
   ##: chmod +x T-COFFEE_installer_&quot;version_x&quot;.bin

3. Launch the installation wizard with:
   ##: ./T-COFFEE_installer_&quot;version_x&quot;.bin

4. Follow the wizard instructions and complete the installation

5. Open a new terminal session to be sure that your environment is updated

6. Type the following command to verify the installation was successful:
   $$: t_coffee -version
</pre></div>
</div>
</section>
<section id="macos-binaries-updated">
<h4>MacOS Binaries - Updated<a class="headerlink" href="#macos-binaries-updated" title="Permalink to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">##: Get the latest stable version from http://www.tcoffee.org/Packages/Stable/Latest/</span>
<span class="c1">##: Or  the latest Beta   Version from http://www.tcoffee.org/Packages/Beta/Latest/</span>
<span class="c1">##: download the *.tar.gz file</span>
<span class="c1">##: tar -xvf T-COFFEE_distribution_Version_XXXXX.tar.gz</span>
<span class="c1">##: cd T-COFFFEE_distribution_Version_XXXXX</span>
<span class="c1">##: ./install all</span>
<span class="c1">##: add the instructions given at the bottom of the install output to your .profile or your .bashrc</span>
</pre></div>
</div>
</section>
<section id="installation-from-source-binaries-downloader-mac-osx-linux">
<h4>Installation From Source/Binaries downloader (Mac OSX/Linux)<a class="headerlink" href="#installation-from-source-binaries-downloader-mac-osx-linux" title="Permalink to this heading"></a></h4>
<p>The following procedure shows howto install T-Coffee from the pre-packages source distribution. This procedure is recommanded because the version of T-Coffee available there is guarranteed to have passed a set of pre-specified tests. By contrast, the github version is untested, and therefore ongoing work… In most cases the binaries will be downloaded from a repository but you may also trigger local compilation.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">1.</span> <span class="n">Download</span> <span class="n">the</span> <span class="n">desired</span> <span class="n">installer</span><span class="p">:</span>
   <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">tcoffee</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">Packages</span><span class="o">/</span><span class="n">Stable</span><span class="o">/</span><span class="n">Latest</span><span class="o">/</span><span class="n">T</span><span class="o">-</span><span class="n">COFFEE_distribution_Version_</span><span class="o">&lt;</span><span class="n">version</span><span class="o">&gt;.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>
   <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">tcoffee</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">Packages</span><span class="o">/</span><span class="n">Beta</span><span class="o">/</span><span class="n">Latest</span><span class="o">/</span><span class="n">T</span><span class="o">-</span><span class="n">COFFEE_distribution_Version_</span><span class="o">&lt;</span><span class="n">version</span><span class="o">&gt;.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>
   <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">tcoffee</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">Packages</span><span class="o">/</span><span class="n">Archives</span><span class="o">/</span><span class="n">T</span><span class="o">-</span><span class="n">COFFEE_distribution_Version_</span><span class="o">&lt;</span><span class="n">version</span><span class="o">&gt;.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>
   <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">cbcrg</span><span class="o">/</span><span class="n">tcoffee</span>

<span class="mi">2</span><span class="n">a</span><span class="o">.</span> <span class="n">untar</span> <span class="n">the</span> <span class="n">file</span>
   <span class="c1">##: tar -xvf T-COFFEE_distribution.tar.gz</span>
   <span class="c1">##: cd  T-COFFEE_distribution</span>

<span class="mi">2</span><span class="n">b</span><span class="o">.</span> <span class="n">clone</span> <span class="ow">or</span> <span class="n">unzip</span> <span class="n">the</span> <span class="n">github</span> <span class="n">repo</span>
   <span class="c1">##: cd t_coffee/src</span>


<span class="mi">3</span><span class="n">a</span><span class="o">.</span> <span class="n">Launch</span> <span class="n">the</span> <span class="n">installer</span>
   <span class="c1">##:  ./install tcoffee</span>


<span class="mi">3</span><span class="n">b</span><span class="o">.</span> <span class="n">If</span> <span class="n">you</span> <span class="n">want</span> <span class="n">to</span> <span class="n">use</span> <span class="n">remote</span> <span class="n">services</span> <span class="p">(</span><span class="n">psiblast</span><span class="p">,</span> <span class="n">expresso</span><span class="p">)</span><span class="o">.</span> <span class="n">You</span> <span class="n">must</span> <span class="n">enter</span> <span class="n">a</span> <span class="n">proxy</span> <span class="n">value</span> <span class="ow">and</span> <span class="n">a</span> <span class="n">valid</span> <span class="n">e</span><span class="o">-</span><span class="n">mail</span><span class="o">.</span> <span class="n">These</span> <span class="n">values</span> <span class="n">will</span> <span class="n">be</span> <span class="n">stored</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">your</span> <span class="n">home</span><span class="o">&gt;/.</span><span class="n">t_coffee</span><span class="o">/.</span><span class="n">t_coffee_env</span> <span class="ow">and</span> <span class="n">can</span> <span class="n">be</span> <span class="n">edited</span> <span class="n">at</span> <span class="nb">any</span> <span class="n">time</span><span class="o">.</span> <span class="n">The</span> <span class="n">proxy</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">compulsory</span><span class="o">.</span> <span class="n">It</span> <span class="ow">is</span> <span class="n">usualy</span> <span class="n">needed</span> <span class="n">when</span> <span class="n">working</span> <span class="n">behind</span> <span class="n">a</span> <span class="n">firewall</span><span class="o">.</span>
   <span class="c1">##: ./install tcoffee -email=&lt;your email&gt; -proxy=&lt;your proxy&gt;</span>


<span class="mf">4.</span> <span class="k">as</span> <span class="n">you</span> <span class="n">can</span> <span class="n">also</span> <span class="n">install</span> <span class="nb">any</span> <span class="n">of</span> <span class="n">the</span> <span class="n">T</span><span class="o">-</span><span class="n">Coffee</span> <span class="n">mode</span> <span class="n">you</span> <span class="n">are</span> <span class="n">interested</span> <span class="ow">in</span><span class="o">.</span> <span class="n">Get</span> <span class="n">the</span> <span class="nb">list</span> <span class="k">with</span><span class="p">:</span>
   <span class="c1">##: ./install</span>
   <span class="n">Then</span> <span class="n">install</span> <span class="n">one</span><span class="p">,</span> <span class="k">for</span> <span class="n">instance</span>
   <span class="c1">##: ./install expresso</span>
   <span class="n">Or</span> <span class="n">install</span> <span class="n">them</span> <span class="nb">all</span>
   <span class="c1">##: ./install all</span>


<span class="mf">5.</span> <span class="n">By</span> <span class="n">default</span><span class="p">,</span> <span class="n">the</span> <span class="n">installer</span> <span class="n">will</span> <span class="ow">not</span> <span class="n">re</span><span class="o">-</span><span class="n">install</span> <span class="nb">any</span> <span class="n">component</span> <span class="n">already</span> <span class="n">available</span> <span class="n">on</span> <span class="n">your</span> <span class="n">system</span><span class="o">.</span> <span class="n">If</span> <span class="n">you</span> <span class="n">want</span> <span class="n">to</span> <span class="n">update</span> <span class="n">you</span> <span class="n">must</span> <span class="n">specify</span>
   <span class="c1">##: ./install &lt;any component&gt; -update</span>
   <span class="n">OR</span>
   <span class="c1">##: ./install &lt;any component&gt; -update -nobinaries</span>
   <span class="n">For</span> <span class="n">instance</span> <span class="n">the</span> <span class="n">following</span> <span class="n">will</span> <span class="n">cause</span> <span class="n">T</span><span class="o">-</span><span class="n">Coffee</span> <span class="n">to</span> <span class="n">be</span> <span class="n">recompiled</span> <span class="n">on</span> <span class="n">your</span> <span class="n">system</span>
   <span class="c1">##: ./install t_coffee -update -nobinaries</span>

<span class="mf">6.</span> <span class="n">When</span> <span class="n">you</span> <span class="n">are</span> <span class="n">done</span> <span class="n">you</span> <span class="n">will</span> <span class="n">need</span> <span class="n">to</span> <span class="n">make</span> <span class="n">this</span> <span class="n">installation</span> <span class="n">permanent</span> <span class="n">by</span> <span class="n">adding</span> <span class="n">the</span> <span class="n">following</span> <span class="n">lines</span> <span class="o">*</span><span class="n">at</span> <span class="n">the</span> <span class="n">bottom</span><span class="o">*</span> <span class="n">of</span> <span class="n">your</span> <span class="n">configuration</span> <span class="n">file</span> <span class="p">(</span><span class="n">typically</span> <span class="o">.</span><span class="n">bashrc</span><span class="p">)</span>
   <span class="c1">##: export PATH=&lt;your home&gt;/.t_coffee/bin/&lt;macosx|linux&gt;:$PATH</span>
</pre></div>
</div>
</section>
</section>
<section id="template-based-modes-psi-tm-coffee-and-expresso">
<h3>Template based modes: PSI/TM-Coffee and Expresso<a class="headerlink" href="#template-based-modes-psi-tm-coffee-and-expresso" title="Permalink to this heading"></a></h3>
<p>The template modes are special modes of T-Coffee in whichj the tempates are associated with templates. The templates are easier to align the the sequences, thus resulting in more accurate alignments. The templates can be provided manually, or they can be fectched using BLAST. In order to do so, T-offee must be able to use BLAST. It can do so using a remote server like the EBI, or using your local installation.</p>
<p>BLAST is a program that searches databases for homologues of a query sequence. It works for protein and nucleic acid sequences alike. In theory BLAST is just a package like any but in practice things are a bit more complex. To run correctly, BLAST requires up-to-date databases (that can be fairly large, like nr or UniProt) and a powerful computer. Fortunately, an increasing number of institutes or companies are now providing BLAST clients that run over the net. It means that all you need is a small program that send your query to the big server and gets the results back. This prevents you from the hassle of installing and maintaining BLAST, but of course it is less private and you rely on the network and the current load of these busy servers.</p>
<p><strong>Thanks to its interaction with BLAST, T-Coffee can gather more information and deliver alignments significantly more accurate than the default T-Coffee or any similar method. Let us go through the various modes available for T-Coffee…</strong></p>
<section id="why-do-i-need-blast-with-t-coffee">
<h4>Why do I need BLAST with T-Coffee?<a class="headerlink" href="#why-do-i-need-blast-with-t-coffee" title="Permalink to this heading"></a></h4>
<p>The most accurate modes of T-Coffee scan the databases for templates that they use to align the sequences. Let’s see how to get BLAST up and running, from the easy solution to tailored ones. There are currently two types of templates for proteins:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p><strong>structures</strong>, that can be found by a BLASTP against the PDB database.</p></li>
<li><p><strong>profiles</strong>, constructed using BLASTP or PSI-BLAST against nr or UniProt.</p></li>
</ol>
</div></blockquote>
<p>These templates are automatically built by T-Coffee when using one of the following modes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">To</span> <span class="n">fetch</span> <span class="ow">and</span> <span class="n">use</span> <span class="n">structural</span> <span class="n">templates</span><span class="p">:</span>
<span class="c1">##: t_coffee &lt;yourseq&gt; -mode expresso</span>

<span class="n">To</span> <span class="n">fetch</span> <span class="ow">and</span> <span class="n">use</span> <span class="n">profile</span> <span class="n">templates</span><span class="p">:</span>
<span class="c1">##: t_coffee &lt;your seq&gt; -mode psicoffee</span>

<span class="n">To</span> <span class="n">fetch</span> <span class="n">everything</span> <span class="n">possible</span> <span class="ow">and</span> <span class="n">get</span> <span class="n">the</span> <span class="n">best</span> <span class="n">templates</span><span class="p">,</span> <span class="n">structure</span> <span class="ow">or</span> <span class="n">profile</span><span class="p">:</span>
<span class="c1">##: t_coffee &lt;your seq&gt; -mode accurate</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>BLAST based computation is a bit time intensive and results are cached to save time on re-computation (~/.t_coffee/cache/). These files are never erased so remember to empty the cache from time to time otherwise it’s just getting bigger and bigger or use the option <strong>-cache=no</strong></p>
</div>
</section>
<section id="using-a-blast-local-version-on-unix">
<h4>Using a BLAST local version on Unix<a class="headerlink" href="#using-a-blast-local-version-on-unix" title="Permalink to this heading"></a></h4>
<p>This is the most accurate way of using BLAST as it provides you with version control on both the program and the database. The downisde is that it requires installing BLAST and associated databases. If you simply want to make a quick try, you can use the remote cliant (see next section)
If you have BLAST+ &lt;<a class="reference external" href="https://blast.ncbi.nlm.nih.gov/Blast.cgi?PAGE_TYPE=BlastDocs&amp;DOC_TYPE=Download">https://blast.ncbi.nlm.nih.gov/Blast.cgi?PAGE_TYPE=BlastDocs&amp;DOC_TYPE=Download</a>&gt; installed, you can run it using the following command line:</p>
<dl class="simple">
<dt>::</dt><dd><p>##: t_coffee &lt;yourseq&gt; -mode &lt;expresso|piscoffee|tmcoffee&gt; -blast_server=LOCAL -protein_db=&lt;location of NR50 for psi/tm-coffee &gt; -pdb_db=&lt;location of PDB fasta database for expresso&gt;</p>
</dd>
</dl>
<p>The default installation should be compliant with your system. At the time this section is being written (03/2020) Uniprot50 features about 36 million sequences and it takes about 3 minutes/sequences to build a profile on a mid-range workstation.</p>
</section>
<section id="using-the-ebi-blast-client">
<h4>Using the EBI BLAST client<a class="headerlink" href="#using-the-ebi-blast-client" title="Permalink to this heading"></a></h4>
<p>This is by far the easiest way and conveniently the default mode of T-Coffee. The PERL clients are already incorporated in T-Coffee and all you need are the proper PERL libraries. In principle, T-Coffee should have already installed these libraries during the standard installation, yet, this requires having root access. It really is worth the effort since the EBI is providing one of the best webservice available around and most notably, the only public PSI-BLAST via a webservice. Note that because PSI-BLAST is time consuming, T-Coffee stores the runs in its cache (<strong>./tcoffee/cache</strong>) so that it does not need to be rerun. It means that if you realign your sequences (or add a few extra sequences), things will be considerably faster.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The clients require the Perl module XML::Simple to be installed</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Whenever you use a T-Coffee mode requiring BLAST access, it will ask you for an authentification e-mail. Do not provide fake e-mail, the EBI may suspend the service for all machines associated with your IP address (that could mean your entire lab, entire institute, even the entire country or, but I doubt it, the whole universe).</p>
</div>
</section>
<section id="using-the-ncbi-blast-client">
<h4>Using the NCBI BLAST client<a class="headerlink" href="#using-the-ncbi-blast-client" title="Permalink to this heading"></a></h4>
<p>The NCBI is the next best alternative however in my hands it was always a bit slower and, most of all, it does not incorporate PSI-BLAST as a webservice. A big miss! The NCBI web BLAST client is a small executable that you should install on your system. To do so, you just have to follow the instructions given on this <a class="reference external" href="ftp://ftp.ncbi.nih.gov/blast/executables/LATEST">link</a>. Simply go for netbl, download the executable that corresponds to your architecture (Cygwin users should go for the win executable). Despite all the files that come along the executable blastcl3 is a stand alone executable that you can safely move to your $BIN. All you then need to do is to make sure that T-Coffee uses the right client; when you run T-Coffee, specify the client in the command line with the flag <strong>-blast_server=NCBI</strong>.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The clients require the Perl module XML::Simple to be installed</p>
</div>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>No need for any e-mail here, but you don’t get PSI-BLAST. Whenever T-Coffee will need to use it, BLASTP will be used instead.</p>
</div>
</section>
<section id="using-another-client">
<h4>Using another client<a class="headerlink" href="#using-another-client" title="Permalink to this heading"></a></h4>
<p>You may have your own client (lucky you). If that is so, all you need is to make sure that this client is complient with the BLAST command line. If your client is named foo.pl, all you need to do is run T-Coffee command line with the flag <strong>-blast_server=CLIENT_foo.pl</strong>. Foo will be called as if it were BLASTPGP, and it is your responsability to make sure it can handle the following command line.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">##: foo.pl -p &lt;method&gt; -d &lt;db&gt; -i &lt;infile&gt; -o &lt;outfile&gt; -m 7</span>

<span class="s2">&quot;method&quot;</span>  <span class="p">:</span> <span class="n">BLAST</span> <span class="n">method</span> <span class="k">for</span> <span class="n">the</span> <span class="n">search</span> <span class="p">(</span><span class="s2">&quot;blastp&quot;</span> <span class="ow">or</span> <span class="s2">&quot;psiblast&quot;</span><span class="p">)</span>
<span class="s2">&quot;db&quot;</span>      <span class="p">:</span> <span class="n">database</span> <span class="n">used</span> <span class="k">for</span> <span class="n">the</span> <span class="n">search</span>
<span class="s2">&quot;infile&quot;</span>  <span class="p">:</span> <span class="nb">input</span> <span class="n">sequence</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="ow">in</span> <span class="n">FASTA</span> <span class="nb">format</span>
<span class="s2">&quot;outfile&quot;</span> <span class="p">:</span> <span class="n">name</span> <span class="n">the</span> <span class="n">output</span> <span class="n">file</span>
<span class="s2">&quot;-m 7&quot;</span>    <span class="p">:</span> <span class="n">triggers</span> <span class="n">the</span> <span class="n">XML</span> <span class="n">output</span> <span class="p">(</span><span class="n">parses</span> <span class="n">both</span> <span class="n">the</span> <span class="n">EBI</span> <span class="o">&amp;</span> <span class="n">NCBI</span> <span class="n">XML</span> <span class="n">output</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If foo.pl behaves differently, the easiest way will probably be to write a wrapper around it so that wrapped_foo.pl behaves like BLASTPGP.</p>
</div>
</section>
</section>
<section id="troubleshooting">
<h3>Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permalink to this heading"></a></h3>
<section id="third-party-packages">
<h4>Third party packages<a class="headerlink" href="#third-party-packages" title="Permalink to this heading"></a></h4>
<p>These procedures are not needed for default usage of T-Coffee. You will only need to install/configure these packages for specific purposes. T-Coffee is meant to interact with as many packages as possible, especially for aligning or using predictions. You will receive a list of supported packages that looks like the next table if you simply type <strong>t_coffee</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Command:
$$: t_coffee

Display the list of supported packages:

****** Pairwise Sequence Alignment Methods:
--------------------------------------------
fast_pair built_in
exon3_pair built_in
exon2_pair built_in
exon_pair built_in
slow_pair built_in
proba_pair built_in
lalign_id_pair built_in
seq_pair built_in
externprofile_pair built_in
hh_pair built_in
profile_pair built_in
cdna_fast_pair built_in
cdna_cfast_pair built_in
clustalw_pair ftp://www.ebi.ac.uk/pub/clustalw
mafft_pair http://www.biophys.kyoto-u.ac.jp/~katoh/programs/align/mafft/
mafftjtt_pair http://www.biophys.kyoto-u.ac.jp/~katoh/programs/align/mafft/
mafftgins_pair http://www.biophys.kyoto-u.ac.jp/~katoh/programs/align/mafft/
dialigntx_pair http://dialign-tx.gobics.de/
dialignt_pair http://dialign-t.gobics.de/
poa_pair http://www.bioinformatics.ucla.edu/poa/
probcons_pair http://probcons.stanford.edu/
muscle_pair http://www.drive5.com/muscle/
t_coffee_pair http://www.tcoffee.org
pcma_pair ftp://iole.swmed.edu/pub/PCMA/
kalign_pair http://msa.cgb.ki.se
amap_pair http://bio.math.berkeley.edu/amap/
proda_pair http://bio.math.berkeley.edu/proda/
prank_pair http://www.ebi.ac.uk/goldman-srv/prank/
consan_pair http://selab.janelia.org/software/consan/

****** Pairwise Structural Alignment Methods:
--------------------------------------------
align_pdbpair built_in
lalign_pdbpair built_in
extern_pdbpair built_in
thread_pair built_in
fugue_pair http://mizuguchilab.org/fugue/
pdb_pair built_in
sap_pair https://mathbio.crick.ac.uk/wiki/Software#SAP
mustang_pair http://lcb.infotech.monash.edu.au/mustang/
tmalign_pair https://zhanglab.ccmb.med.umich.edu/TM-align/

****** Multiple Sequence Alignment Methods:
--------------------------------------------
clustalw_msa ftp://www.ebi.ac.uk/pub/clustalw
mafft_msa http://www.biophys.kyoto-u.ac.jp/~katoh/programs/align/mafft/
mafftjtt_msa http://www.biophys.kyoto-u.ac.jp/~katoh/programs/align/mafft/
mafftgins_msa http://www.biophys.kyoto-u.ac.jp/~katoh/programs/align/mafft/
dialigntx_msa http://dialign-tx.gobics.de/
dialignt_msa http://dialign-t.gobics.de/
poa_msa http://www.bioinformatics.ucla.edu/poa/
probcons_msa http://probcons.stanford.edu/
muscle_msa http://www.drive5.com/muscle/
t_coffee_msa http://www.tcoffee.org
pcma_msa ftp://iole.swmed.edu/pub/PCMA/
kalign_msa http://msa.cgb.ki.se
amap_msa http://bio.math.berkeley.edu/amap/
proda_msa http://bio.math.berkeley.edu/proda/
prank_msa http://www.ebi.ac.uk/goldman-srv/prank/

####### Prediction Methods available to generate Templates
-------------------------------------------------------------
RNAplfold http://www.tbi.univie.ac.at/~ivo/RNA/
HMMtop http://www.enzim.hu/hmmtop/
GOR4 http://mig.jouy.inra.fr/logiciels/gorIV/
wublast_client http://www.ebi.ac.uk/Tools/webservices/services/wublast
blastpgp_client http://www.ebi.ac.uk/Tools/webservices/services/blastpgp
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>In our hands all these packages where very straightforward to compile and install on a standard Cygwin or Linux configuration. Just make sure you have gcc, the C compiler, properly installed. Once the package is compiled and ready to use, make sure that the executable is on your path, so that T-Coffee can find it automatically. Our favorite procedure is to create a bin directory in the home. If you do so, make sure this bin is in your path and fill it with all your executables (this is a standard Unix practice).</p>
</div>
</section>
<section id="m-coffee-parameters">
<h4>M-Coffee parameters<a class="headerlink" href="#m-coffee-parameters" title="Permalink to this heading"></a></h4>
<p>M-Coffee is a special mode of T-Coffee that makes it possible to combine the output of many Multiple Sequence Alignment packages. By default all the packages will be in the following folder <strong>$HOME/.t_coffee/plugins/linux/</strong>. If you want to have these packages in a different directory, you can either set the environment variable (option 1) or use the flag <strong>-plugin</strong> (to override every other setting). If for some reason, you do not want this directory to be on your path or you want to specify a precise directory containing the executables, you can use option 2. You can also set the following environment variables to the absolute path of the executable you want to use option 3: whenever they are set these variables will supersede any other declaration. This is a convenient way to experiment with multiple package versions. If you would rather have the mcoffee directory in some other location, set the MCOFFEE_4_TCOFFEE environement variable to the proper directory (option 4).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Option</span> <span class="mi">1</span><span class="p">:</span> <span class="nb">set</span> <span class="n">the</span> <span class="n">environment</span> <span class="n">variable</span>
<span class="c1">##: setenv PLUGINS_4_TCOFFEE=&lt;plugins dir&gt;</span>

<span class="n">Option</span> <span class="mi">2</span><span class="p">:</span> <span class="n">specify</span> <span class="n">the</span> <span class="n">directory</span>
<span class="c1">##: export PLUGINS_4_TCOFFEE=&lt;dir&gt;</span>

<span class="n">Option</span> <span class="mi">3</span><span class="p">:</span>
<span class="c1">##: POA_4_TCOFFEE CLUSTALW_4_TCOFFEE TCOFFEE_4_TCOFFEE MAFFT_4_TCOFFEE \</span>
<span class="n">MUSCLE_4_TCOFFEE</span> <span class="n">DIALIGNT_4_TCOFFEE</span> <span class="n">PRANK_4_TCOFFEE</span> <span class="n">DIALIGNTX_4_TCOFFEE</span>

<span class="n">Option</span> <span class="mi">4</span><span class="p">:</span>
<span class="c1">##: setenv MCOFFEE_4_TCOFFEE &lt;directory containing mcoffee files&gt;</span>
</pre></div>
</div>
<p>To be able to run M-Coffee, these following files are enough for a default usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">BLOSUM</span><span class="o">.</span><span class="n">diag_prob_t10</span> <span class="n">BLOSUM75</span><span class="o">.</span><span class="n">scr</span> <span class="n">blosum80_trunc</span><span class="o">.</span><span class="n">mat</span>
<span class="n">dna_diag_prob_100_exp_330000</span> <span class="n">dna_diag_prob_200_exp_110000</span>
<span class="n">BLOSUM</span><span class="o">.</span><span class="n">scr</span> <span class="n">BLOSUM90</span><span class="o">.</span><span class="n">scr</span> <span class="n">dna_diag_prob_100_exp_110000</span>
<span class="n">dna_diag_prob_100_exp_550000</span> <span class="n">dna_diag_prob_250_exp_110000</span>
<span class="n">BLOSUM75</span><span class="o">.</span><span class="n">diag_prob_t2</span> <span class="n">blosum80</span><span class="o">.</span><span class="n">mat</span> <span class="n">dna_diag_prob_100_exp_220000</span>
<span class="n">dna_diag_prob_150_exp_110000</span> <span class="n">dna_matrix</span><span class="o">.</span><span class="n">scr</span>
</pre></div>
</div>
</section>
<section id="structural-modes-using-pdb">
<h4>Structural modes (using PDB)<a class="headerlink" href="#structural-modes-using-pdb" title="Permalink to this heading"></a></h4>
<p>Expresso/3D-Coffee are special modes of T-Coffee that allow to combine sequences and structures to reach more accurate alignments. T-Coffee proposes also other tools (iRMSD/APDB, T-RMSD, etc…) requiring access to structural information. You can do so either by having a database installed locally on your own system or by accessing the PDB through the web server. If you do not have PDB installed, don’t worry, T-Coffee will go and fetch any structure it needs directly from the PDB repository, it will simply be a bit slower. If you prefer to have access to a local installation of the PDB in your file system, you have to indicate their location in your system using one of the following commands:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Using</span> <span class="n">a</span> <span class="n">local</span> <span class="n">version</span> <span class="n">of</span> <span class="n">the</span> <span class="n">PDB</span> <span class="n">database</span><span class="p">:</span>
<span class="c1">##: setenv (or export) PDB_DIR &lt;PATH&gt;/data/structures/all/pdb/</span>
<span class="c1">##: setenv (or export) PDB_DIR &lt;PATH&gt;/structures/divided/pdb/</span>
</pre></div>
</div>
<p>The T-RMSD tools comes along with T_Coffee package in order to build clustering based on structure. In addition to structural information it also requires the package Phylip, containing lots of phylogenetic tree reconstruction tools. If you need more information about the different Phylip tools, information can be obtained <a class="reference external" href="http://www.evolution.genetics.washington.edu/phylip.html">here</a>.</p>
</section>
<section id="r-coffee-associated-packages">
<h4>R-Coffee associated packages<a class="headerlink" href="#r-coffee-associated-packages" title="Permalink to this heading"></a></h4>
<p>R-Coffee is a special mode able to align RNA sequences while taking into account their secondary structure. R-Coffee only requires the package Vienna to be installed, in order to compute Multiple Sequence Alignments. To make the best out of it, you should also have all the packages required by M-Coffee.</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="http://eddylab.org/software/consan/">Consan</a> from Eddy/Riva laboratory.</p></li>
<li><p><a class="reference external" href="http://www.tbi.univie.ac.at/RNA/">RNAplfold</a> from the Vienna package.</p></li>
<li><p><a class="reference external" href="http://probcons.stanford.edu/download.html">ProbConsRNA</a> from Stanford university.</p></li>
</ul>
</div></blockquote>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Regarding ProbConsRNA, make sure you rename the probcons executable into ProbConsRNA.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>In order to insure a proper interface bewteen Consan and R-Coffee, make sure that the file mix80.mod is in the directory <strong>~/.t_coffee/mcoffee</strong> or in the mcoffee directory otherwise declared.</p>
</div>
</section>
</section>
</section>
<span id="document-tcoffee_quickstart_regressive"></span><section id="quick-start-regressive-algorithm">
<h2>Quick Start Regressive Algorithm<a class="headerlink" href="#quick-start-regressive-algorithm" title="Permalink to this heading"></a></h2>
<section id="introduction">
<h3>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading"></a></h3>
<p>This document introduces the regressive mode of T-Coffee (please cite the <a class="reference external" href="https://www.nature.com/articles/s41587-019-0333-6">Nature Biotech original publication</a>). It is meant to align very large datasets with a high accuracy. In order to use it, you need a complete installation of T-Coffee with all supported third-party packages. These come by default in the installation package but you will have to install them manualy if you compile T-Coffee from its source code. See the <a class="reference external" href="https://tcoffee.readthedocs.io/en/latest/tcoffee_installation.html#installation">installation section</a> for more details.</p>
<p>Multiple sequence alignments (MSA) are usualy estimated by progressively aligning all the sequences, starting with the most similar. The regressive alignment is a new procedure that proceeds the other way around and starts by aligning the most distantly related sequences first. Like its progressive sibblin, the regressive algorithm starts with a guide tree. It uses this guide tree to extract the N most diverse sequences. In this first intermediate MSA, each sequence is either a leaf or the representative of a subtree. The algorithm is re-aplied recursively onto every representative sequence until all sequences have been incorporated in an internediate MSA of max size N. The final MSA is then obtained by merging all the intermediate MSAs into the final MSA. The merging is very efficient and does not require further alignment because the intermediate MSAs contain common sequences.</p>
<p>Aside from its improved accuracy, the main benefit of this protocol is to allow any third party multiple sequence aligner to be applied on the sub-groups (ClustalO, MAfft, etc) and any third party guide-tree protocol. The default T-Coffee supports a large number of <a class="reference external" href="https://tcoffee.readthedocs.io/en/latest/tcoffee_main_documentation.html#internal-external-methods">internal and external package</a> but if the one you need is not supported, note that it is relatively simple to create a configuration file allowing T-Coffee to interact with the package you need as documented <a class="reference external" href="https://tcoffee.readthedocs.io/en/latest/tcoffee_main_documentation.html#advanced-method-integration">here</a>.</p>
<p>When deployed serialy, the regressive algorithm scales linearly with the number of sequences both in time and memory. The amount of memory it needs is roughly the amount of memory required to align N sequences with the selected alignment method. Given TOT sequences, the amount of time is roughly TOT/N*(amount of time required to align N Seq with the selected method). The algorithm implementation is multi-threaded and owing to its embarrasingly parralel nature, it benefits from a very efficient speedup when deployed this way.</p>
<p>In the following document, we list its main options and how these can be deployed from the T-Coffee algorithm.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>REG does not support ALL the T-Coffee options. It is especially limited with respect to input and output and will only allow FASTA.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">##: Get the latest stable version from http://www.tcoffee.org/Packages/Stable/Latest/</span>
<span class="c1">##: Or  the latest Beta   Version from http://www.tcoffee.org/Packages/Beta/Latest/</span>
<span class="c1">##: download the *.tar.gz file</span>
<span class="c1">##: tar -xvf T-COFFEE_distribution_Version_XXXXX.tar.gz</span>
<span class="c1">##: cd T-COFFFEE_distribution_Version_XXXXX</span>
<span class="c1">##: ./install all</span>
<span class="c1">##: add the instructions given at the bottom of the install output to your .profile or your .bashrc</span>
</pre></div>
</div>
</section>
<section id="installation-from-source">
<h3>Installation from source<a class="headerlink" href="#installation-from-source" title="Permalink to this heading"></a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">##: get the latest version from https://github.com/cbcrg/tcoffee</span>
<span class="c1">##: cd tcoffee-master/t_coffee/src</span>
<span class="c1">##: make t_coffee</span>
<span class="c1">##: mv t_coffee &lt;Binary Directory&gt;</span>
</pre></div>
</div>
<p>In order to use T-Coffee you must also have the following pacaked installed</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">## Mafft:             https://mafft.cbrc.jp/alignment/software/</span>
<span class="c1">## ClustalOmega:      http://www.clustal.org/omega/#Download</span>
</pre></div>
</div>
<p>More sophisticated modes of the regressive algorithm that use either profile extension (psicoffee) or structural templates (3dcoffee or Expresso)require a local installation of Blast+ and associated databases</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">## Blast+:            https://ftp.ncbi.nlm.nih.gov/blast/executables/blast+/LATEST/</span>
<span class="c1">## Uniprot50:         https://www.uniprot.org/downloads</span>
<span class="c1">## PDB Fasta:         ftp://ftp.wwpdb.org/pub/pdb/derived_data/pdb_seqres.txt.gz</span>
</pre></div>
</div>
<p>Whenever structural modes are used, T-Coffee is able to download directly the PDBs from rscb. It is therefore not needed to install PDB locally, but the program can also use a local version of PDB. T-Coffee is, however, able to use a local version installed in a standard way (cf the RSCB website: <a class="reference external" href="https://www.rcsb.org/">https://www.rcsb.org/</a>)</p>
</section>
<section id="examples">
<h3>Examples<a class="headerlink" href="#examples" title="Permalink to this heading"></a></h3>
<section id="fast-and-accurate">
<h4>Fast and accurate<a class="headerlink" href="#fast-and-accurate" title="Permalink to this heading"></a></h4>
<p>In the following example, the regressive alignment is used to align the sequences in FASTA format. The tree is estimated using the mbed method of Clustal Omega (-reg_tree=mbed), the size of the groups is 100 (-reg_nseq=100) and the method used to align the groups is Clustal Omega:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee -reg -seq proteases_large.fasta -nseq 100 -tree mbed -method clustalo_msa -outfile proteases_large.aln -outtree proteases_large.mbed
</pre></div>
</div>
<p>This mode is the default mode and is expected to deliver fast and reasonnably accurate alignments</p>
</section>
<section id="slower-and-more-accurate">
<h4>Slower and more accurate<a class="headerlink" href="#slower-and-more-accurate" title="Permalink to this heading"></a></h4>
<p>This mode is expected to be the most accurate and combines the ginsi mode of MAFFT which is very accurate with the mbed trees of Clustal Omega. Note that it is the regressive deployment that allows ginsi to be used on datasets of unlimited size.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee -reg -seq proteases_large.fasta -nseq 100 -tree mbed -method mafftginsi_msa -outfile proteases_large.aln -outtree proteases_large.mbed
</pre></div>
</div>
</section>
<section id="very-fast">
<h4>Very Fast<a class="headerlink" href="#very-fast" title="Permalink to this heading"></a></h4>
<p>This mode is expected to be the fastest currently available. Its accuracy is comparable to that of MAFFT-fftnsi running on its own</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee -reg -seq proteases_large.fasta -nseq 100 -tree parttree -reg_method mafftfftnsi_msa -outfile proteases_large.aln -outtree proteases_large.parttree
</pre></div>
</div>
</section>
</section>
<section id="regressive-flags">
<h3>Regressive flags<a class="headerlink" href="#regressive-flags" title="Permalink to this heading"></a></h3>
<ul class="simple">
<li><p><strong>-seq</strong> (usage:<strong>-seq=&lt;FASTA sequence file&gt;</strong>)</p></li>
</ul>
<p>This flag is mandatory to provide the sequences. The sequences must be in FASTA and must not contain any sequences. Because these sequences are meant to be aligned with third party aligners that may not support the IUPAC extended alphabet, it is advisable to avoid non standard amino-acids symbols. It is also not advisable to provide gapped sequences.</p>
<ul class="simple">
<li><p><strong>-tree</strong> (usage:<strong>-tree=&lt;method or Newick File&gt;</strong>, default: <strong>mbed</strong> )</p></li>
</ul>
<p>This flag defines which method will be used to estimate the tree. The following methods are available</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Tree</span> <span class="n">Computation</span> <span class="n">Method</span><span class="p">:</span>
<span class="o">-</span> <span class="n">mbed</span>        <span class="p">:</span> <span class="n">use</span> <span class="n">mBed</span> <span class="n">mode</span> <span class="n">of</span> <span class="n">ClustalO</span> <span class="o">-</span> <span class="n">Default</span>
<span class="o">-</span> <span class="n">cwdnd</span>       <span class="p">:</span> <span class="n">use</span> <span class="n">the</span> <span class="n">quicktree</span> <span class="n">mode</span> <span class="n">of</span> <span class="n">ClustalW</span>
<span class="o">-</span> <span class="n">parttree</span>    <span class="p">:</span> <span class="n">parttree</span> <span class="n">method</span> <span class="n">of</span> <span class="n">MAFFT</span> <span class="o">-</span> <span class="n">fastest</span> <span class="n">option</span><span class="o">.</span> <span class="n">Does</span> <span class="ow">not</span> <span class="n">support</span> <span class="n">sequences</span> <span class="n">less</span> <span class="n">than</span> <span class="mi">6</span> <span class="n">AA</span> <span class="n">long</span>
<span class="o">-</span> <span class="n">dpparttree</span>  <span class="p">:</span> <span class="n">MAFFT</span> <span class="n">fast</span> <span class="n">clustering</span> <span class="n">method</span>
<span class="o">-</span> <span class="n">fastparttree</span><span class="p">:</span> <span class="n">MAFFT</span> <span class="n">fast</span> <span class="n">clustering</span> <span class="n">method</span>
<span class="o">-</span> <span class="n">mafftdnd</span>    <span class="p">:</span> <span class="n">default</span> <span class="n">MAFFT</span> <span class="n">NJ</span> <span class="n">tree</span> <span class="o">-</span> <span class="n">slower</span> <span class="n">than</span> <span class="n">the</span> <span class="n">parttree</span> <span class="n">modes</span>
<span class="o">-</span> <span class="n">fftns1dnd</span>   <span class="p">:</span> <span class="n">Tree</span> <span class="n">produced</span> <span class="n">after</span> <span class="n">the</span> <span class="n">first</span> <span class="n">iteration</span> <span class="n">MAFFT</span> <span class="n">fftns</span> <span class="n">mode</span>
<span class="o">-</span> <span class="n">fftns2dnd</span>   <span class="p">:</span> <span class="n">Tree</span> <span class="n">produced</span> <span class="n">after</span> <span class="n">the</span> <span class="n">second</span> <span class="n">iteration</span> <span class="n">MAFFT</span> <span class="n">fftns</span> <span class="n">mode</span>
<span class="o">-</span> <span class="n">upgma</span>       <span class="p">:</span> <span class="n">upgma</span> <span class="n">tree</span> <span class="o">-</span> <span class="n">warning</span> <span class="n">cubic</span> <span class="n">time</span> <span class="n">computation</span>
<span class="o">-</span> <span class="n">nj</span>          <span class="p">:</span> <span class="n">Neighbour</span> <span class="n">Joinning</span> <span class="n">tree</span>
<span class="o">-</span> <span class="n">famsadnd</span>    <span class="p">:</span> <span class="n">FAMSA</span> <span class="n">single</span> <span class="n">linkage</span> <span class="n">tree</span>
<span class="o">-</span> <span class="c1">#&lt;command&gt;  : Runs comamnd &lt;seq&gt; &gt; &lt;tree&gt;.</span>
<span class="o">-</span> <span class="n">filename</span>    <span class="p">:</span> <span class="n">Any</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">newick</span> <span class="nb">format</span><span class="o">.</span> <span class="n">The</span> <span class="n">seq</span> <span class="n">file</span> <span class="ow">and</span> <span class="n">the</span> <span class="n">tree</span> <span class="n">file</span> <span class="n">must</span> <span class="n">match</span>
</pre></div>
</div>
<ul class="simple">
<li><p><strong>-newtree</strong> (usage:<strong>-newtree=&lt;filename&gt;</strong> , default: &lt;infile&gt;.&lt;reg_tree&gt;)</p></li>
</ul>
<p>This flag defines the name of the newly computed ouput tree. Deafult will be filename.reg_tree</p>
<ul class="simple">
<li><p><strong>-child_tree</strong> (usage:<strong>-chile_tree=&lt;tree_method&gt;</strong> , default:None)</p></li>
</ul>
<p>This flag defines which method will be used to estimate the tree. Note that by default, each &lt;method&gt; will use its own default tree mode.</p>
<ul class="simple">
<li><p><strong>-outfile</strong> (usage:<strong>-outfile=&lt;filename&gt;</strong> , default: &lt;infile&gt;.aln)</p></li>
</ul>
<p>This flag defines the name of the output file containing the multiple sequence alignment</p>
<ul class="simple">
<li><p><strong>-nseq</strong> (usage:<strong>-nseq=N</strong> , default: 1000 for datasets larger than 10,000 and Nseq/10 for smaller datasets )</p></li>
</ul>
<p>Sets the maximum size of the subsequence alignments. The recommanded value is 1000. With slow/accurate aligners that do not scale in a linear way, this parameter can have an importnat impact on CPU requirement with small values resulting in faster computation.</p>
<ul class="simple">
<li><p><strong>-method</strong> (usage:<strong>-method=&lt;method or configuration file&gt;</strong> , default: clustalo_msa)</p></li>
</ul>
<p>This flag defines which method will be used to estimate the child MSA. In order to know which methods are available.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee
</pre></div>
</div>
<p>All methods the multiple sequence alignment methods xxx_msa are supported.</p>
<ul class="simple">
<li><p><strong>-thread</strong> (usage:<a href="#id1"><span class="problematic" id="id2">**</span></a>-thread=&lt;N&gt; , default: 1, 0 causes all available procs to be used)</p></li>
</ul>
<p>This flag defines how many procs will be used. Children MSAs are computed in parrallel</p>
<ul class="simple">
<li><p><strong>-dynamic</strong> (usage:<strong>-dynamic=&lt;Integer&gt;</strong> , default: 1)</p></li>
</ul>
<p>This flag defines the factor by which every Child reg_n is increased while going from root to leaf. By default all children contain the same maximum number of sequences, if dynamic&gt;1, this number is set to reg_nseq*(dynamic^NGeneration from root). If dynamic &lt;1, this number is set to: reg_nseq/(-dynamic^NGeneration from root). <em>Note that this mode has not bee validated</em></p>
<ul class="simple">
<li><p><strong>-dynamic_config</strong> (usage:<strong>-dynamic_config=&lt;file&gt;</strong> , default: none)</p></li>
</ul>
<p>This flag provides a file specifying which method will be used depending on Nseq in slaves when using dynamic_msa. The format is</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">method</span><span class="o">&gt;</span>      <span class="o">&lt;</span><span class="n">maxnseq</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>The default is</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">psicoffee_msa</span> <span class="mi">20</span>
<span class="n">famsa_msa</span>     <span class="mi">100000000</span>
</pre></div>
</div>
<p>All methods (<a href="#id3"><span class="problematic" id="id4">*</span></a>_msa) available in t_coffee are supported.</p>
<ul class="simple">
<li><p><strong>-thread</strong> (usage:<strong>-nseq=N</strong> , default: 1, 0 to use all available threads)</p></li>
</ul>
<p>Sets the maximum number of threads to be used by one instance. Note that if you have scrited your own aligner using a configuration file, you should make sure it does not run in a multi-threaded version as well.</p>
<ul class="simple">
<li><p><strong>-child_thread</strong> (usage:<a href="#id5"><span class="problematic" id="id6">**</span></a>-child_thread=&lt;N&gt; , default: 1, 0 causes all available procs to be used)</p></li>
</ul>
<p>This flag defines how many procs will be allocated to the computation of <em>each</em> child MSA. This makes sense when the children MSAs are very large</p>
<p>If you want to use an non-supported method, follow these <a class="reference external" href="https://tcoffee.readthedocs.io/en/latest/tcoffee_main_documentation.html#advanced-method-integration">guidelines</a>.</p>
</section>
</section>
<span id="document-tcoffee_quickstart_unistrap"></span><section id="quick-start-unistrap">
<h2>Quick Start Unistrap<a class="headerlink" href="#quick-start-unistrap" title="Permalink to this heading"></a></h2>
<section id="introduction">
<h3>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading"></a></h3>
<p>This document introduces the unsitsrap strategy that incorpates MSA instability into the estimation of the Felsentein Bootstrap replicates (please cite the <a class="reference external" href="https://academic.oup.com/sysbio/article/67/6/997/4948750">Systematic Biology original publication</a>).</p>
<p>The principke is very straightorward. It involves shuffling the input order of the sequences so as to generate MSA shuffle replicates, from which columns are then drawn with replacement so as to generate the Bootsrap replicates. As established in the paper, it is also possible to shuffle left and right chidren in the guide tree of any progressive methods. This procedure recapitulates two third of the instability measured when shuffling sequences. Whenever using a progressive algorithm, the tree shuffling procedure should be applied in order to by-pass any arbitrary stabilisation procedures (internal sorting for instance).</p>
<p>The procedure used for the original validation is available on <a class="reference external" href="https://github.com/cbcrg/unistrap">Github</a>). The content of this repository is not especially user friendly and its sole purpose is to allow reproducing the analysis provided in the original paper. For practical usage, we recommand using the re-implementation provided below that can be accessed using the T-Coffee package. This re-implementation supports all the T-Coffee supported aligners when shuffling input sequences (<a href="#id1"><span class="problematic" id="id2">**</span></a>t_coffee ** to get a list) and a subset of progressive aligners when using the tree shuffle strategy.</p>
<p>Aside from its improved accuracy, the main benefit of this protocol is to allow any third party multiple sequence aligner to be applied on the sub-groups (ClustalO, MAfft, etc) and any third party guide-tree protocol. The default T-Coffee supports a large number of <a class="reference external" href="https://tcoffee.readthedocs.io/en/latest/tcoffee_main_documentation.html#internal-external-methods">internal and external package</a> but if the one you need is not supported, note that it is relatively simple to create a configuration file allowing T-Coffee to interact with the package you need as docimented <a class="reference external" href="https://tcoffee.readthedocs.io/en/latest/tcoffee_main_documentation.html#advanced-method-integration">here</a>.</p>
<p>When deployed serialy, the regressive algorithm scales linearly with the number of sequences both in time and memory. The amount of memory it needs is roughly the amount of memory required to align N sequences with the selected alignment method. Given TOT sequences, the amount of time is roughly TOT/N*(amount of time required to align N Seq with the selected method). The algorithm implementation is multi-threaded and owing to its embarrasingly parralel nature, it benefits from a very efficient speedup when deployed this way.</p>
<p>In the following document, we list its main options and how these can be deployed from the T-Coffee algorithm.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>REG does not support ALL the T-Coffee options. It is especially limited with respect to input and output and will only allow FASTA.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">##: Get the latest stable version from http://www.tcoffee.org/Packages/Stable/Latest/</span>
<span class="c1">##: Or  the latest Beta   Version from http://www.tcoffee.org/Packages/Beta/Latest/</span>
<span class="c1">##: download the *.tar.gz file</span>
<span class="c1">##: tar -xvf T-COFFEE_distribution_Version_XXXXX.tar.gz</span>
<span class="c1">##: cd T-COFFFEE_distribution_Version_XXXXX</span>
<span class="c1">##: ./install all</span>
<span class="c1">##: add the instructions given at the bottom of the install output to your .profile or your .bashrc</span>
</pre></div>
</div>
</section>
<section id="examples">
<h3>Examples<a class="headerlink" href="#examples" title="Permalink to this heading"></a></h3>
<section id="produce-bootsrap-replicates-by-shuffling-sequences-and-guide-tree-sister-nodes">
<h4>Produce bootsrap replicates by shuffling sequences and guide tree sister nodes<a class="headerlink" href="#produce-bootsrap-replicates-by-shuffling-sequences-and-guide-tree-sister-nodes" title="Permalink to this heading"></a></h4>
<p>In the following example, the input order of the sequences will be shuffled 10 times so as to generate as many MSA replicates (-msa). Each time a guide tree will be generated using mbed (-tree), and the sister nodes of this tree will be randomly shuffled (i.e. left and right will be randoml?y reassigned to left or right) - note that this shuffling does not change the topology. For each shuffled replicated, an MSA willl be estimated with clustalo (-method) and each MSA this produced will be used to produce 10 replicates.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note: This mode will re-compute a guide tree for every sequence shuffle. The tree shuffle is not needed but it will increase the probability of each iteration delivering a different MSA. It is much more computationaly efficient to replace the sequence order shuffle with a tree shuffle thgat will generate a comparable amount of MSA diversity at a significantly lower computational cost.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee -other_pg unistrap -in sample_seq1.fasta -tree mbed -method clustalo -shuffle_tree -shuffle_seq -msa 10 -bootstrap 10 -outfile replicates.phylip
</pre></div>
</div>
</section>
<section id="produce-bootsrap-replicates-by-shuffling-the-guide-tree-sister-nodes">
<h4>Produce bootsrap replicates by shuffling the guide tree sister nodes<a class="headerlink" href="#produce-bootsrap-replicates-by-shuffling-the-guide-tree-sister-nodes" title="Permalink to this heading"></a></h4>
<p>In the following example, a guide tree will be generated once using mbed (-tree), and the sister nodes of this tree will be randomly shuffled (i.e. left and right will be randoml?y reassigned to left or right) 10 times. For each shuffled replicated, an MSA willl be estimated with clustalo (-method) and each MSA this produced will be used to produce 10 replicates.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee -other_pg unistrap -in sample_seq1.fasta -tree mbed -method clustalo -shuffle_tree -msa 10 -bootstrap 10 -outfile replicates.phylip
</pre></div>
</div>
</section>
<section id="get-list-of-supported-methods">
<h4>Get list of supported methods<a class="headerlink" href="#get-list-of-supported-methods" title="Permalink to this heading"></a></h4>
<p>The following command will list all the guide tree methods and multiple aligners supported by unistrap</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee -other_pg unistrap  -tree list -method list
</pre></div>
</div>
</section>
</section>
<section id="unistrap-flags">
<h3>unistrap flags<a class="headerlink" href="#unistrap-flags" title="Permalink to this heading"></a></h3>
<ul class="simple">
<li><p><strong>-in</strong> (usage:<strong>-seq=&lt;FASTA sequence file&gt;</strong>)</p></li>
</ul>
<p>This flag is mandatory to provide the sequences. The sequences must be in FASTA and must not contain any sequences. Because these sequences are meant to be aligned with third party aligners that may not support the IUPAC extended alphabet, it is advisable to avoid non standard amino-acids symbols. It is also not advisable to provide gapped sequences.</p>
<ul class="simple">
<li><p><strong>-shuffle_tree</strong> (usage:<strong>-shuffle_tree</strong>, default: <strong>on</strong> )</p></li>
</ul>
<p>This flag defines the shuffling of sister nodes for each MSA replicate. The guide tree does not need to be re-estimated</p>
<ul class="simple">
<li><p><strong>-shuffle_seq</strong> (usage:<strong>-shuffle_seq</strong>, default: <strong>off</strong> )</p></li>
</ul>
<p>This flag defines the shuffling of input sequences for each MSA replicate. The guide tree <em>must be re-estimated</em>.</p>
<ul class="simple">
<li><p><strong>-tree</strong> (usage:<strong>-tree=&lt;method,filename,list&gt;</strong> , default: mbed)</p></li>
</ul>
<p>This flag defines the method used to estimate the guide tree, it can be a method or an existing tree</p>
<ul class="simple">
<li><p><strong>-method</strong> (usage:<strong>-tree=&lt;method,list&gt;</strong> , default: clustalo)</p></li>
</ul>
<p>This flag defines the method used to estimate the MSA.</p>
<ul class="simple">
<li><p><strong>-msa</strong> (usage:<strong>-msa=&lt;integer&gt;</strong> , default: 10)</p></li>
</ul>
<p>This flag defines the number of MSA replicates</p>
<ul class="simple">
<li><p><strong>-bootstrap</strong> (usage:<strong>-bootstrap=&lt;integer&gt;</strong> , default: 10)</p></li>
</ul>
<p>This flag defines the number of Bootsrap replicates. Note that the final number of replicates will be msa* x bootstrap</p>
<ul class="simple">
<li><p><strong>-outfile</strong> (usage:<strong>-outfile=&lt;tree_method&gt;</strong> , default:stdout)</p></li>
</ul>
<p>This flag defines the outfile name</p>
</section>
</section>
<span id="document-tcoffee_quickstart"></span><section id="quick-start-t-coffee">
<h2>Quick Start T-Coffee<a class="headerlink" href="#quick-start-t-coffee" title="Permalink to this heading"></a></h2>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This chapter has been extensively updated in 11/2016. All T-Coffee modes/tools/commands should be valid for version 9.03 and above, but it is not guaranteed for lower versions of T-Coffee.</p>
</div>
<section id="basic-command-lines-or-modes">
<h3>Basic Command Lines (or modes)<a class="headerlink" href="#basic-command-lines-or-modes" title="Permalink to this heading"></a></h3>
<p>This chapter is a quick overview on how to run T-Coffee alignment using predefined procedures we call “modes”. All the files mentioned can be found <a class="reference external" href="https://github.com/cbcrg/tcoffee/tree/master/examples">here</a>. You can also use examples associated with their corresponding command lines from the subsection <strong>Tutorial (practical examples)</strong> published in Nature Protocols (2011). Refer to the section <strong>T-Coffee Manual</strong> for more technical details about T-Coffee usage and tools. Please, use the corresponding citation when using a specific mode or tools of T-Coffee (see <strong>References and Citations</strong>) otherwise cite T-Coffee.</p>
<section id="protein-sequences">
<h4>Protein sequences<a class="headerlink" href="#protein-sequences" title="Permalink to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>----------------------------------------------------------------------------
Default
----------------------------------------------------------------------------

$$: t_coffee sample_seq1.fasta

Citation: Notredame et al., JMB (2000)                      PMID:10964570
----------------------------------------------------------------------------
Fast
----------------------------------------------------------------------------

$$: t_coffee sample_seq1.fasta -mode quickaln

Citation: Notredame et al., JMB (2000)                      PMID:10964570
----------------------------------------------------------------------------
Consistent (M-Coffee combines the most common MSA packages)
----------------------------------------------------------------------------

$$: t_coffee sample_seq1.fasta -mode mcoffee

Citation: Wallace et al., Nucleic Acids Res. (2006)         PMID:16556910
----------------------------------------------------------------------------
Structure (Expresso finds structures homologous to your sequences)
----------------------------------------------------------------------------

$$: t_coffee sample_seq1.fasta -mode expresso

Citation: Armougom et al. Nucleic Acids Res. (2006)         PMID:16845081
----------------------------------------------------------------------------
Homology (PSI-Coffee enriches your dataset with homologous sequences)
----------------------------------------------------------------------------

$$: t_coffee sample_seq1.fasta -mode psicoffee

Citation: Chang et al., BMC Bioinformatics (2012)           PMID:22536955
----------------------------------------------------------------------------
Accurate (combines Structures and Homology)
----------------------------------------------------------------------------

$$: t_coffee sample_seq1.fasta -mode accurate

Citation: Notredame et al., JMB (2000)                      PMID:10964570
</pre></div>
</div>
</section>
<section id="dna-sequences">
<h4>DNA sequences<a class="headerlink" href="#dna-sequences" title="Permalink to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>----------------------------------------------------------------------------
Default
----------------------------------------------------------------------------

$$: t_coffee sample_dnaseq1.fasta

Citation: Notredame et al., JMB (2000)                      PMID:10964570
----------------------------------------------------------------------------
Functional (Pro-Coffee increases accuracy of functional DNA regions )
----------------------------------------------------------------------------

$$: t_coffee sample_dnaseq1.fasta -mode procoffee

Citation: Erb et al., Nucleic Acids Res. (2012)             PMID:22230796
</pre></div>
</div>
</section>
<section id="rna-sequences">
<h4>RNA sequences<a class="headerlink" href="#rna-sequences" title="Permalink to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>----------------------------------------------------------------------------
Default
----------------------------------------------------------------------------

$$: t_coffee sample_rnaseq1.fasta

Citation: Notredame et al., JMB (2000)                      PMID:10964570
----------------------------------------------------------------------------
Structure 2D (R-Coffee uses predicted secondary structures)
----------------------------------------------------------------------------

$$: t_coffee sample_rnaseq1.fasta -mode rcoffee

Citation: Wilm et al., Nucleic Acids Res. (2008)            PMID:18420654
----------------------------------------------------------------------------
Structure 3D (R-Coffee combined with Consan structural alignments)
----------------------------------------------------------------------------

$#: t_coffee sample_rnaseq1.fasta -mode rcoffee_consan

Citation: Wilm et al., Nucleic Acids Res. (2008)            PMID:18420654
----------------------------------------------------------------------------
Accurate (RM-Coffee use M-Coffee and secondary structure predictions)
----------------------------------------------------------------------------

$$: t_coffee sample_rnaseq1.fasta -mode rmcoffee

Citation: Wilm et al., Nucleic Acids Res. (2008)            PMID:18420654
</pre></div>
</div>
</section>
</section>
<section id="brief-overview-of-t-coffee-tools">
<h3>Brief Overview of T-Coffee Tools<a class="headerlink" href="#brief-overview-of-t-coffee-tools" title="Permalink to this heading"></a></h3>
<p>We only give you the very basics here, please go to the <strong>T-Coffee Main Documentation</strong> for a more detailed description. You can also try the <strong>T-Coffee tutorial</strong> for a practical training on T-Coffee alignment and other tools using applied examples on published research data.</p>
<section id="alignment-methods">
<h4>Alignment methods<a class="headerlink" href="#alignment-methods" title="Permalink to this heading"></a></h4>
<section id="t-coffee">
<h5>T-Coffee<a class="headerlink" href="#t-coffee" title="Permalink to this heading"></a></h5>
<p>Write or copy all your sequences (protein, DNA or RNA) in a given text file using one of the following format: Swiss-Prot, FASTA or PIR. Run T-Coffee with the following command line:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee sample_seq1.fasta
</pre></div>
</div>
<p>When aligning, T-Coffee will always at least generate three files:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">sample_seq1.aln</span></code>  : Multiple Sequence Alignment (ClustalW format by default)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sample_seq1.dnd</span></code>  : guide tree (Newick format)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sample_seq1.html</span></code> : colored MSA according to consistency (html format)</p></li>
</ul>
</div></blockquote>
<p>In principle, the type of the sequences is automatically detected and the default methods adapted accordingly. Sometimes, however, this may fail either because the sequences are too short or contain too many ambiguity codes. When this happens, you are advised to explicitly set the type of your sequences using the flag <strong>-type</strong>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee sample_dnaseq1.fasta -type=dna
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Please cite: Notredame, C., Higgins, D.G., Heringa, J. T-Coffee: a novel method for fast and accurate multiple sequence alignment. J. Mol. Biol., 302(1):205-217 (2000), PMID:10964570 and/or Magis, C., Taly, J.-F., Bussotti, G., Chang, J.M., Di Tommaso, P., Erb, I., Espinosa-Carrasco, J., Notredame, C. <strong>T-Coffee: tree-based consistency objective function for alignment evaluation</strong>. Methods Mol. Biol., 1079:117-129 (2014), PMID:24170398</p>
</div>
</section>
<section id="m-coffee">
<h5>M-Coffee<a class="headerlink" href="#m-coffee" title="Permalink to this heading"></a></h5>
<p>M-Coffee is a meta version of T-Coffee that combines the output of eight aligners (MUSCLE, ProbCons, POA, DIALIGN-T, MAFFT, ClustalW, PCMA and T-Coffee); when installing T-Coffee, all required packages are automatically installed on your computer. To use M-Coffee, write your sequences in a file (format: Swiss-Prot, FASTA or PIR) and run the following command 1. M-Coffee is a predefined combination of different types of aligners; there is a faster version called fm-Coffee (command 2) which combines the fastest aligners (Kalign, MUSCLE and MAFFT). Finally, the user can make its own combination of aligners included in T-Coffee by specifying the list of packages to be combined; here is an example of T-Coffee combining ClustalW, Kalign and ProbCons (command 3).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Command 1: running M-Coffee
$$: t_coffee sample_seq1.fasta -mode mcoffee

Command 2: running fm-Coffee
$$: t_coffee sample_seq1.fasta -mode fmcoffee

Command 3: user defined multiple methodes
$$: t_coffee sample_seq1.fasta -method clustalw_pair, kalign_pair, probcons_pair
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If the program starts complaining one package or the other is missing, this means you will have to go the hard way and install all these packages yourself…</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Please cite: Wallace, I.M., O’Sullivan, O., Higgins, D.G., Notredame, C. <strong>M-Coffee: combining multiple sequence alignment methods with T-Coffee</strong>. Nucleic Acids Res., 34(6):1692-1699 (2006), PMID:16556910</p>
</div>
</section>
<section id="expresso">
<h5>Expresso<a class="headerlink" href="#expresso" title="Permalink to this heading"></a></h5>
<p>The default installation of T-Coffee provides you with the EBI wublast.pl client required to run Expresso ) command 1). Using this, Expresso will BLAST your sequences against the PDB database, identify the best targets (by default X-RAY structures, minimum 35% identical to your sequences) and use them to align your proteins using a structural aligner. If all the required structural packages for Expresso are not installed or if you want to select another structural aligner, you can select the structural package you want to use, for instance, if can use TM-align rather than SAP (command 2).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Command 1:
$$: t_coffee sample_seq1.fasta -mode expresso

Command 2:
$$: t_coffee sample_seq1.fasta -template_file PDB -method TMalign_pair
</pre></div>
</div>
<p>This correspondence between sequences and structures (templates) is declared in a FASTA-like file we call template file. Expresso automatically generates the template file (<code class="docutils literal notranslate"><span class="pre">&lt;your</span> <span class="pre">file</span> <span class="pre">name&gt;_pdb1.template_list</span></code>) that can be reused for applications, but you can also provide your own with the following format. This template file should have the following format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">seq_name</span><span class="o">&gt;</span> <span class="n">_P_</span> <span class="o">&lt;</span><span class="n">PDB</span> <span class="n">structure</span> <span class="n">file</span> <span class="ow">or</span> <span class="n">name</span><span class="o">&gt;</span>

<span class="o">*******</span> <span class="n">sample_3Dseq1</span><span class="o">.</span><span class="n">template</span> <span class="o">*******</span>
<span class="o">&gt;</span><span class="n">TNFR10</span><span class="o">-</span><span class="mi">2</span>  <span class="n">_P_</span> <span class="mi">1</span><span class="n">D4V2</span><span class="o">.</span><span class="n">pdb</span>
<span class="o">&gt;</span><span class="n">TNFR10</span><span class="o">-</span><span class="mi">3</span>  <span class="n">_P_</span> <span class="mi">1</span><span class="n">D4V3</span><span class="o">.</span><span class="n">pdb</span>
<span class="o">...</span>
<span class="o">**************************************</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Please cite: Armougom, F., Moretti, S., Poirot, O., Audic, S., Dumas, P., Schaeli, B., Keduas, V., Notredame. C. <strong>Expresso: automatic incorporation of structural information in multiple sequence alignments using 3D-Coffee</strong>. Nucleic Acids Res., 34:W604-W608 (2006), PMID:16845081</p>
</div>
</section>
<section id="r-coffee">
<h5>R-Coffee<a class="headerlink" href="#r-coffee" title="Permalink to this heading"></a></h5>
<p>R-Coffee can be used to align RNA sequences, using their RNApfold predicted secondary structures (command 1). The best results are obtained by using the Consan pairwise method. If you have Consan installed (under maintenance…), you get access to one of the most accurate mode of R-Coffee (command 2). This will only work if your sequences are short enough (less than 200 nucleotides). A good alternative is the rmcoffee mode (command 3) that will run MUSCLE, ProbCons4RNA and MAFFT and then use the secondary structures predicted by RNApfold. Finally, you can also select yourself which methods should be combined by R-Coffee (command 4).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Command 1: R-Coffee
$$: t_coffee sample_rnaseq1.fasta -mode rcoffee

Command 2: R-Coffee + Consan
$#: t_coffee sample_rnaseq1.fasta -mode rcoffee_consan

Command 3: RM-Coffee
$$: t_coffee sample_rnaseq1.fasta -mode rmcoffee

Command 4: user defined R-Coffee
$$: t_coffee sample_rnaseq1.fasta -mode rcoffee -method lalign_id_pair,slow_pair
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Please cite: Wilm, A., Higgins, D.G., Notredame, C. <strong>R-Coffee: a method for multiple alignment of non-coding RNA</strong>. Nucleic Acids Res., 36(9):e52 (2008), PMID:18420654</p>
</div>
</section>
<section id="pro-coffee">
<h5>Pro-Coffee<a class="headerlink" href="#pro-coffee" title="Permalink to this heading"></a></h5>
<p>Pro-Coffee is a particular mode of T-Coffee designed to align specific functional DNA sequences, in particular regulatory regions. To run Pro-Coffee by default, just use command 1. In order to adjust the quality of the alignment, Pro-Coffee allows you to modify gap penalties (gap-opening and/or gap-extension) with specific flags (command 2).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Command 1: Pro-Coffee default
$$: t_coffee sample_dnaseq1.fasta -mode procoffee

Command 2: Pro-Coffee with modified parameters
$$: t_coffee sample_dnaseq1.fasta -method promo_pair@EP@GOP@-60@GEP@-1
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Please cite: Erb, I., González-Vallinas, J.R., Bussotti, G., Blanco, E., Eyras, E., Notredame, C. <strong>Use of ChIP-Seq data for the design of a multiple promoter-alignment method</strong>. Nucleic Acids Res., 40(7):e52 (2012), PMID:22230796.</p>
</div>
</section>
</section>
<section id="evaluation-tools">
<h4>Evaluation tools<a class="headerlink" href="#evaluation-tools" title="Permalink to this heading"></a></h4>
<section id="tcs-msa-evaluation-based-on-consistency">
<h5>TCS (MSA evaluation based on consistency)<a class="headerlink" href="#tcs-msa-evaluation-based-on-consistency" title="Permalink to this heading"></a></h5>
<p>Transitive Consistency Score (TCS) is an alignment evaluation score that makes it possible to identify the most correct positions in an MSA. It has been shown that these positions are the most likely to be structuraly correct and also the most informative when estimating phylogenetic trees. The TCS evaluation and filtering procedure is implemented in the T-Coffee package and can be used to evaluate and filter any third party MSA (including T-Coffee MSA of course!).</p>
<p>It’s usage is a bit tricky as it comes with a lot of different options, go to the <strong>T-Coffee Main Documentation</strong>, section <strong>Evaluating Your Alignment</strong> to have all the details about TCS.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Please cite: Chang, J.-M., Di Tommaso, P., Notredame, C. <strong>TCS: A new multiple sequence alignment reliability measure to estimate alignment accuracy and improve phylogenetic tree reconstruction</strong>. Mol. Biol. Evol., 31(6), 1625–1637 (2014), PMID:24694831 and/or Chang, J.-M., Di Tommaso, P., Lefort, V., Gascuel, O., Notredame, C. <strong>TCS: a web server for multiple sequence alignment evaluation and phylogenetic reconstruction</strong>. Nucleic Acids Res., 43(W1):W3-6 (2015), PMID:25855806</p>
</div>
</section>
<section id="irmsd-apdb-msa-structural-evaluation">
<h5>iRMSD/APDB (MSA structural evaluation)<a class="headerlink" href="#irmsd-apdb-msa-structural-evaluation" title="Permalink to this heading"></a></h5>
<p>iRMSD/APDB is not an alignment tool, it is an evalution tool of a given alignment using structural information. All you need is a file containing the alignment of sequences with a known structure (“template file”; see Expresso). If you don’t provide a template file, these sequences must be named according to their PDB ID, followed by the chain index (1aabA for example). In the first example (command 1) names are different therefore it won’t deliver any result. In that case, you should declare the correspondence between sequences and structures using your own template file (command 2). All the sequences do not need to have a known structure, but at least two is required otherwise it won’t deliver any result.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Command 1:
$$: t_coffee -other_pg irmsd sample_3Dseq1.aln

Command 2:
$$: t_coffee -other_pg irmsd sample_3Dseq1.aln -template_file sample_3Dseq1.template
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Please cite: Armougom, F., Moretti, S., Keduas, V., Notredame, C. <strong>The iRMSD: a local measure of sequence alignment accuracy using structural information</strong>. Bioinformatics, 22(14):e35-e39 (2006), PMID:16873492</p>
</div>
</section>
<section id="strike-single-structure-msa-evaluation">
<h5>STRIKE (single structure MSA evaluation)<a class="headerlink" href="#strike-single-structure-msa-evaluation" title="Permalink to this heading"></a></h5>
<p>Under maintenance on the webserver or the T-Coffee package…</p>
</section>
<section id="t-rmsd-structural-clustering">
<h5>T-RMSD (structural clustering)<a class="headerlink" href="#t-rmsd-structural-clustering" title="Permalink to this heading"></a></h5>
<p>T-RMSD is a structure based clustering method using the iRMSD to drive the structural clustering of your aligned sequences with an available structure. The T-RMSD supports all the parameters supported by iRMSD or APDB. To run T-RMSD, type:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee -other_pg trmsd sample_3Dseq1.aln -template_file sample_3Dseq1.template
</pre></div>
</div>
<dl class="simple">
<dt>The program then outputs a series of files:</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">sample_3Dseq1.struc_tree.list</span></code> : list of the trees associated with every position.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sample_3Dseq1.struc_tree.html</span></code> : colored columns supporting the tree.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sample_3Dseq1.struc_tree.consensus_output</span></code> : schematic display of the results.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sample_3Dseq1.struc_tree.consensus</span></code> : final consensus structural tree.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Please cite: Magis, C., Stricher, F., van der Sloot, A.M., Serrano, L., Notredame, C. <strong>T-RMSD: a fine-grained, structure based classification method and its application to the functional characterization of TNF receptors</strong>. J. Mol. Biol., 400(3):605-617 (2010), PMID:20471393 and/or Magis, C., van der Sloot, A.M., Serrano, L., Notredame, C. <strong>An improved understanding of TNFL/TNFR interactions using structure-based classifications</strong>. Trends Biochem. Sci., 37(9):353-363 (2012), PMID:22789664</p>
</div>
</section>
</section>
</section>
<section id="tutorial-practical-examples">
<h3>Tutorial (Practical Examples)<a class="headerlink" href="#tutorial-practical-examples" title="Permalink to this heading"></a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This documentation is merely a cheat-sheet that recapitulates the material and the command lines associated with the manual. This tutorial itself is adpated from the <a class="reference external" href="http://www.nature.com/nprot/journal/v6/n11/full/nprot.2011.393.html">T-Coffee Nature Protocols Article</a> that can be followed step by step on the following <a class="reference external" href="http://www.tcoffee.org/Projects/tcoffee/workshops/tcoffeetutorials/index.html">website</a></p>
</div>
<section id="introduction">
<h4>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading"></a></h4>
<p>T-Coffee is a versatile Multiple Sequence Alignment method suitable for aligning most types of biological sequences. The series of protocols presented here show how the package can be used to multiply align proteins, DNA and RNA sequences. The package is an open source freeware available from <a class="reference external" href="http://www.tcoffee.org">our website</a>.</p>
<p>There are several parts: 1) the protein section presents controlled cases for PSI-Coffee the homology extended mode suitable for remote homologues, Expresso the structure based multiple aligner and M-Coffee, a meta version able to combine several third party aligners into one, 2) we then show how the T-RMSD option can be used to produce a functionally informative structure based clustering, 3) RNA alignment procedures are shown for R-Coffee a mode that produces secondary structure based MSAs, 4) DNA alignments are illustrated with Pro-Coffee, a multiple aligner specific of promoter regions, 5) finally, the last section presents some of the many reformatting utilities bundled with T-Coffee.</p>
</section>
<section id="materials">
<h4>Materials<a class="headerlink" href="#materials" title="Permalink to this heading"></a></h4>
<p>The list of files (input and output) required by this protocol is available from <a class="reference external" href="http://www.tcoffee.org/Packages/NatureProtocols/NatureProtocolDataset.tar.gz">here</a>. They can be automatically retrieved using the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee -other_pg nature_protocol.pl
</pre></div>
</div>
<p>This will create 4 repertories containing the input sequences necessary for the protocols we report in this section. For each part, all command lines have been collected into the file README.sh.</p>
</section>
<section id="procedures">
<h4>Procedures<a class="headerlink" href="#procedures" title="Permalink to this heading"></a></h4>
<ul class="simple">
<li><p><a class="reference external" href="http://www.tcoffee.org/Projects/tcoffee/workshops/tcoffeetutorials/index.html">Full Tutorial</a></p></li>
<li><p><a class="reference external" href="http://www.tcoffee.org/Projects/tcoffee/workshops/tcoffeetutorials/installation.html">Installation</a></p></li>
<li><p><a class="reference external" href="http://www.tcoffee.org/Projects/tcoffee/workshops/tcoffeetutorials/protein-alignment.html">Protein Multiple Sequence Alignments</a></p></li>
<li><p><a class="reference external" href="http://www.tcoffee.org/Projects/tcoffee/workshops/tcoffeetutorials/rna-alignment.html">RNA Multiple Sequence Alignments</a></p></li>
<li><p><a class="reference external" href="http://www.tcoffee.org/Projects/tcoffee/workshops/tcoffeetutorials/promoter-alignment.html">Promoter alignments</a></p></li>
<li><p><a class="reference external" href="http://www.tcoffee.org/Projects/tcoffee/workshops/tcoffeetutorials/reformating.html">Reformat alignments</a></p></li>
</ul>
</section>
</section>
</section>
<span id="document-tcoffee_main_documentation"></span><section id="t-coffee-main-documentation">
<h2>T-Coffee Main Documentation<a class="headerlink" href="#t-coffee-main-documentation" title="Permalink to this heading"></a></h2>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This chapter has been extensively updated in 11/2016. We improved its readibility and incorporate all the latest development of the past years (PSI/TM-Coffee for homology extension based MSAs, Pro-Coffee for functional DNA, R-Coffee/SARA-Coffee for RNA, TCS and STRIKE for evaluating MSAs, T-RMSD for structural clustering). If you have any suggestion or correction, don’t hesitate to contact us.</p>
</div>
<section id="before-you-start">
<h3>Before You Start…<a class="headerlink" href="#before-you-start" title="Permalink to this heading"></a></h3>
<section id="foreword">
<h4>Foreword<a class="headerlink" href="#foreword" title="Permalink to this heading"></a></h4>
<p>Most of the work presented here emanates from two summer schools that were tentatively called the ‘Prosite Workshops’ and were held in Marseille, in 2001 and 2002. These workshops were mostly an excuse to go rambling and swimming in the creeks of Cassis (Calanques). Yet, when we got tired of lazing in the sun, we eventually did a bit of work to chill out. Most of our experiments were revolving around the development of sequence analysis tools. Many of the most advanced ideas in T-Coffee were launched during these fruitful sessions. Participants included Phillip Bucher, Laurent Falquet, Marco Pagni, Alexandre Gattiker, Nicolas Hulo, Christian Siegfried, Anne-Lise Veuthey, Virginie Leseau, Lorenzo Ceruti and Cedric Notredame.</p>
</section>
<section id="prerequisite-for-using-t-coffee">
<h4>Prerequisite for using T-Coffee<a class="headerlink" href="#prerequisite-for-using-t-coffee" title="Permalink to this heading"></a></h4>
<p>This documentation relies on the assumption that you have installed T-Coffee, version 9.03 or higher (preferably the latest stable version). T-Coffee is a freeware open source running on all Unix-like platforms including Mac OS X, woever, it cannot run on Windows except by using Cygwin, a freeware open source allowing to run a Unix-like command line on Windows (<a class="reference external" href="https://www.cygwin.com/">download</a>). A better option for Windows users would be to install a Unix-like virtualbox on your computer. All the relevant information for installing T-Coffee is contained in the previous chapter <strong>T-Coffee Installation</strong>.</p>
</section>
<section id="let-s-have-a-try">
<h4>Let’s have a try…<a class="headerlink" href="#let-s-have-a-try" title="Permalink to this heading"></a></h4>
<p>This manual is made to help you discover (nearly) all subtleties of T-Coffee, from default applications to sophisticated ones. All along this documentation, we expect you to use Unix-like shell commands running on prepared example files we have created. For now you can find all these files on our github repository for now: <a class="reference external" href="https://github.com/cbcrg/tcoffee/tree/master/examples">example files</a>; however in the future they will be included in the T-Coffee distribution (~/tcoffee/Version…/examples/). All T-Coffee commands indicated with a tag “$$:” are currently up and running; just copy/paste these commands from the documentation (without the tag “$$:”) to your terminal provided you previously downloaded the example files. We encourage you to try all these examples which are controlled cases, and also to try these commands with your own data files. All T-Coffee commands indicated with a tag “$#:” are currently under maintenance. Also, be aware that all the values/results given in this manual were obtained with different versions of T-Coffee; depending on the version of T-Coffee you are using, these results may slightly differ.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Using T-Coffee package via “command lines” is the best/only way  <strong>if you need to do something sophisticated and/or highly reproducible</strong>, but if you don’t want to bother with command line you can use our <a class="reference external" href="http://tcoffee.crg.cat/apps/tcoffee/index.html">web server</a> or different links on the <a class="reference external" href="http://www.tcoffee.org">Cedric Notredame’s lab homepage</a>. We have tried to put as many of T-Coffee functionalities on the webserver and we plan to incorporate even more in the future, but for now some options are not available or limited.</p>
</div>
</section>
</section>
<section id="what-is-t-coffee">
<h3>What is  T-Coffee ?<a class="headerlink" href="#what-is-t-coffee" title="Permalink to this heading"></a></h3>
<section id="id1">
<h4>What is T-Coffee?<a class="headerlink" href="#id1" title="Permalink to this heading"></a></h4>
<p>T-Coffee stands for <strong>“Tree based Consistency Objective Function For alignment Evaluation”</strong>. It is mainly/primarily a Multiple Sequence Alignment (MSA) method but it also provides a collection of useful/powerful tools presented in this manual. Before going deep into the core of the matter, here are a few words to briefly explain the things T-Coffee can do !!!</p>
<section id="what-does-it-do">
<h5>What does it do?<a class="headerlink" href="#what-does-it-do" title="Permalink to this heading"></a></h5>
<dl class="simple">
<dt>T-Coffee has two components allowing you to perform different tasks:</dt><dd><ul class="simple">
<li><p>mainly it is a Multiple Sequence Alignment method. Given a dataset of sequences previously gathered using database search programs (like BLAST, Ensembl, etc…), T-Coffee will produce a Multiple Sequence Alignment (MSA) (refer to the section <strong>Building Your Multiple Sequence Alignments</strong> for more details).</p></li>
<li><p>also it is a collection of tools (usually called with the flag <strong>-other_pg “tools”</strong>) and third party software (cf. section <strong>Integrating External Methods in T-Coffee</strong>) able to perform a wide range of operations such as aligning accurately, reformatting data, evaluating results, comparing methods and many more…</p></li>
</ul>
</dd>
</dl>
</section>
<section id="what-can-it-align">
<h5>What can it align?<a class="headerlink" href="#what-can-it-align" title="Permalink to this heading"></a></h5>
<p>T-Coffee will align nucleic acid (DNA and RNA) and protein sequences alike. T-Coffee is also able to use other type of information such as secondary/tertiary structure information (for protein or RNA sequences with a known/predicted structure), sequence profiles, trees…</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>To have a rough idea, on an average computer, T-Coffee can easily align up to a 200 sequences, about 1000 amino acid long in about ~20min. It is better to avoid aligning more than 1000 sequences without using a cluster or T-Coffee fast modes !!!</p>
</div>
</section>
<section id="how-can-i-use-it">
<h5>How can I use it?<a class="headerlink" href="#how-can-i-use-it" title="Permalink to this heading"></a></h5>
<p>T-Coffee is not an interactive program. It runs from your Unix or Linux command line and you must provide it with the correct parameters and syntax. If you do not like typing commands, you can still use the latest T-Coffee webserver <a class="reference external" href="http://tcoffee.crg.cat/apps/tcoffee/index.html">here</a>.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Installing and using T-Coffee requires a minimum acquaintance with the Linux/Unix operating system. If you feel this is beyond your computer skills, we suggest you use one of the available online servers.</p>
</div>
</section>
<section id="is-there-an-online-webserver">
<h5>Is there an online webserver?<a class="headerlink" href="#is-there-an-online-webserver" title="Permalink to this heading"></a></h5>
<p>Yes, at <a class="reference external" href="http://www.tcoffee.org">Cedric Notredame’s lab homepage</a> which contains all the necessary links to our latest  <a class="reference external" href="http://tcoffee.crg.cat/apps/tcoffee/index.html">webserver</a> !</p>
</section>
<section id="is-t-coffee-different-from-clustalw">
<h5>Is T-Coffee different from ClustalW?<a class="headerlink" href="#is-t-coffee-different-from-clustalw" title="Permalink to this heading"></a></h5>
<p>According to several benchmarks, T-Coffee is on overall much more accurate than ClustalW, but this increase in accuracy comes at a price: <strong>T-Coffee (default mode) is slower than ClustalW</strong> (about N times for N Sequences). Still, if you want to align closely related sequences, <strong>T-Coffee can be used in a fast mode, much faster and about as accurate than ClustalW</strong> (cf. section <strong>Building Multiple Sequence Alignment</strong>). If you are familiar with ClustalW or if you run a ClustalW server, you will find that we have made some efforts to ensure as much compatibility as possible between ClustalW and T-Coffee. Whenever it was relevant, we have kept the flag names and the flag syntax of ClustalW. Yet, you will find that T-Coffee also has many extra possibilities…</p>
</section>
<section id="is-t-coffee-very-accurate">
<h5>Is T-Coffee very accurate?<a class="headerlink" href="#is-t-coffee-very-accurate" title="Permalink to this heading"></a></h5>
<p>T-Coffee belongs to the category of consistency based aligners which currently corresponds to the most accurate algorithms available (e.g. ProbCons, MSAprobs…). In addition, T-Coffee can combine (many) methods and therefore be as accurate (and hopefully more) as the methods it combines. For instance, the “accurate” mode of T-Coffee is very slow but also very accurate; on average this mode was shown to be 10 % more accurate than normal aligners on sequences less than 30% similar. If you need a very accurate alignment go to section <strong>Building Multiple Sequence Alignment</strong>.</p>
</section>
</section>
<section id="what-t-coffee-can-and-cannot-do-for-you">
<h4>What T-Coffee can and cannot do for you …<a class="headerlink" href="#what-t-coffee-can-and-cannot-do-for-you" title="Permalink to this heading"></a></h4>
<section id="what-t-coffee-can-t-do">
<h5>What T-Coffee can’t do<a class="headerlink" href="#what-t-coffee-can-t-do" title="Permalink to this heading"></a></h5>
<p>To be honest, a short answer will be that there is only one thing T-Coffee cannot do for you: <strong>T-Coffee can NOT fetch sequences for you</strong>. You must select the sequences you want to align beforehand and prepare your own dataset. We suggest you use any BLAST server and format your sequences in FASTA so that T-Coffee can use them easily. The  <a class="reference external" href="http://www.expasy.ch">ExPASy BLAST server</a> provides a nice interface for integrating database searches.</p>
</section>
<section id="what-t-coffee-can-do">
<h5>What T-Coffee can do<a class="headerlink" href="#what-t-coffee-can-do" title="Permalink to this heading"></a></h5>
<p>T-Coffee is not only just an aligner program, it comes with multiple tools and third party software increasing the range of its possibilities; here is a non exhaustive list of tasks T-Coffee can perform:</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>T-Coffee can compute (or at least try to compute!) accurate Multiple Sequence Alignments of DNA, RNA or Protein sequences</strong>. Several modes and options are available and will be presented all along this manual. The default T-Coffee accepts any kind of sequence, although some modes are specific to a given type of sequence.</p></li>
<li><p><strong>T-Coffee can help you to reformat, trim, clean, cut, color your input (sequences, structures…) or output (alignments, trees…) data</strong>; meaning that once you have your data and/or results ready, you can always modify them at will.</p></li>
<li><p><strong>T-Coffee allows you to combine results obtained with several alignment methods</strong> (see the section <strong>FAQ for T-Coffee</strong> and <strong>Building Multiple Sequence Alignment</strong> for more details). T-Coffee can virtually combine all these MSAs you have to produce a new Multiple Sequence Alignment having the best agreement with all these methods you tried.</p></li>
<li><p><strong>One of the most important improvement of T-Coffee is to let you combine sequences and structures</strong>, so that your alignments are of higher quality. You need to have the SAP package installed to fully benefit of this facility (or to use another structural alignment method).</p></li>
<li><p><strong>T-Coffee allows you to extract a collection of repeats from a single sequence or a set of sequences</strong> using MOCCA. In other words, if you know the coordinates of one copy of a repeat, you can extract all the other occurrences. MOCCA needs some time to compute a library and then prompt you with an interactive menu. You just have to follow the instructions.</p></li>
<li><p><strong>T-Coffee can be used to measure the reliability of your Multiple Sequence Alignment</strong>. If you want to find out about that, read the section <strong>FAQ for T-Coffee</strong> or the <strong>Technical Documentation</strong> (-output flag). More details will be given anyway in this manual in the section <strong>How Good Is Your Alignment?</strong>.</p></li>
<li><p><strong>T-Coffee can be used to compare alternative alignment</strong>; in case you generate several alignments of the same sequences, you can compare these alignments using the most common scores (Sum-of-Pairs or Column Score). In case you have reference alignments, you can directly benchmark your method by comparing your MSAs to your references.</p></li>
</ul>
</div></blockquote>
<p>And probably many more options we will discover together all along this manual !</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Some options are carried out using the function “wget”. If “wget” is not installed on your system, you can get it for free from <a class="reference external" href="http://www.wget.org">wget download</a>. Just type <strong>wget</strong> to be sure it is installed.</p>
</div>
</section>
</section>
<section id="how-does-t-coffee-alignment-works">
<h4>How does T-Coffee alignment works?<a class="headerlink" href="#how-does-t-coffee-alignment-works" title="Permalink to this heading"></a></h4>
<p>If you only want to make a standard Multiple Sequence Alignment, you may skip these explanations. But if you want to do more sophisticated things, these few indications may help before you start reading the documentation and the different articles.</p>
<p>When you run T-Coffee, the first thing it does is to compute a library. The library is a list of pairs of residues that could be aligned…it is like a christmas list: you can ask anything you fancy, it doesn’t imply you will get it. Given a standard library, it is nearly impossible to have all the residues aligned at the same time because all the lines of the library may not agree. For instance:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Line</span> <span class="mi">1</span> <span class="n">says</span><span class="p">:</span>
<span class="n">Residue</span> <span class="mi">1</span> <span class="n">of</span> <span class="n">seq</span> <span class="n">A</span> <span class="k">with</span> <span class="n">Residue</span> <span class="mi">5</span> <span class="n">of</span> <span class="n">seq</span> <span class="n">B</span><span class="p">,</span>
<span class="o">...</span>
<span class="n">Line</span> <span class="mi">100</span> <span class="n">says</span><span class="p">:</span>
<span class="n">Residue</span> <span class="mi">1</span> <span class="n">of</span> <span class="n">seq</span> <span class="n">A</span> <span class="k">with</span> <span class="n">Residue</span> <span class="mi">29</span> <span class="n">of</span> <span class="n">seq</span> <span class="n">B</span><span class="p">,</span>
</pre></div>
</div>
<p>Each of these constraints comes with a weight and in the end, the T-Coffee algorithm tries to generate the multiple alignment that contains constraints whose sum of weights yields the highest score. In other words, it tries to make happy as many constraints as possible (replace the word constraint with, friends, relatives, collaborators… and you will know exactly what we mean). You can generate this list of constraints the way you like. You may even provide it yourself, forcing important residues to be aligned by giving them high weights (see <strong>FAQ for T-Coffee</strong>). For your convenience, T-Coffee can generate (by default) its own list by making all the possible global pairwise alignments, and the 10 best local alignments associated with each pair of sequences. Each pair of residues observed aligned in these pairwise alignments becomes a line in the library.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Be aware that nothing forces you to use a given library and that you could build it using other methods. In protein language, <strong>T-Coffee is synonymous for freedom, the freedom of being aligned however you fancy</strong> (I was probably a Tryptophan in some previous life).</p>
</div>
</section>
</section>
<section id="preparing-your-data">
<h3>Preparing Your Data<a class="headerlink" href="#preparing-your-data" title="Permalink to this heading"></a></h3>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>About the syntax of T-Coffee command lines, just for you to know that it is quite flexible, for instance you can use any kind of separator you want (i.e. , ; &lt;space&gt; =). The syntax used in this document is meant to be consistent with that of ClustalW. However, in order to take advantage of the automatic filename completion provided by many shells, you can replace ‘=’ and ‘,’ with a space. Also, T-Coffee tools/modes are called using different flags to specify input/output files, parameters, modifiers, etc…Some flags are not always mandatory, however, if you use a correct/strict flag usage T-Coffee will always work fine; you just have some degrees of freedom ;-).</p>
</div>
<section id="the-reformatting-utility-seq-reformat">
<h4>The reformatting utility: seq_reformat<a class="headerlink" href="#the-reformatting-utility-seq-reformat" title="Permalink to this heading"></a></h4>
<section id="general-introduction">
<h5>General introduction<a class="headerlink" href="#general-introduction" title="Permalink to this heading"></a></h5>
<p>Nothing is more frustrating than downloading important data and realizing you need to format it before using it. In general, you should avoid manual reformatting: it is by essence inconsistent and will get you into trouble. It will also get you depressed when you realize that you have spent the whole day adding carriage return to each line in your files. T-Coffee comes with several tools to reformat/trim/clean/select your input data but also your output results, especially a very powerful reformatting utility named <strong>seq_reformat</strong>. You can use <strong>seq_reformat</strong> by invoking the t_coffee shell:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee -other_pg seq_reformat
</pre></div>
</div>
<p>This will output the online flag usage of seq_reformat meaning a complete list of things seq_reformat can do for you. The seq_reformat is a reformatting utility so it recognizes automatically the most common formats (FASTA, Swiss-Prot,ClustalW, MSF, Phylip…). It reads the input file(s) via the <strong>“-in”</strong> and <strong>“-in2”</strong> flags and outputs in whatever specified format via the <strong>“-output”</strong> flag. In the meantime, you can use the flag <strong>“-action”</strong> to perform a wide range of modification on your data. In this section we give you quite a lot of different examples of you can do with <strong>“-other_pg seq_reformat”</strong>.</p>
<div class="admonition danger">
<p class="admonition-title">Danger</p>
<p>After the flag <strong>-other_pg</strong>, the common T-Coffee flags are not recognized anymore; it is like if you were using a different program.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>When using T-Coffee seq_reformat, command line may become quite long…a practical way to handle this is to create in your .bashrc an alias to call directly seq_reformat. For example, write in your .bashrc: <strong>alias reformat=’t_coffee -other_pg seq_reformat’</strong>. You can now call seq_reformat by tiping <strong>reformat</strong>.</p>
</div>
</section>
<section id="modification-options">
<h5>Modification options<a class="headerlink" href="#modification-options" title="Permalink to this heading"></a></h5>
<p>In order to perform different modifications on your data (residues/sequences/columns…), the <strong>seq_reformat</strong> utility can be followed by the flag <strong>-action</strong> and one or several modifiers listed here (this list is not exhaustive):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Options</span><span class="p">:</span>
<span class="o">-</span> <span class="o">+</span><span class="n">upper</span>              <span class="p">:</span> <span class="n">to</span> <span class="n">uppercase</span> <span class="n">your</span> <span class="n">residues</span>
<span class="o">-</span> <span class="o">+</span><span class="n">lower</span>              <span class="p">:</span> <span class="n">to</span> <span class="n">lowercase</span> <span class="n">your</span> <span class="n">residues</span>
<span class="o">-</span> <span class="o">+</span><span class="n">switchcase</span>         <span class="p">:</span> <span class="n">to</span> <span class="n">selectively</span> <span class="n">toggle</span> <span class="n">the</span> <span class="n">case</span> <span class="n">of</span> <span class="n">your</span> <span class="n">residues</span>
<span class="o">-</span> <span class="o">+</span><span class="n">keep</span>               <span class="p">:</span> <span class="n">to</span> <span class="n">only</span> <span class="n">keep</span> <span class="n">the</span> <span class="n">residues</span> <span class="n">within</span> <span class="n">the</span> <span class="nb">range</span>
<span class="o">-</span> <span class="o">+</span><span class="n">use_cons</span> <span class="o">+</span><span class="n">keep</span>     <span class="p">:</span> <span class="n">to</span> <span class="n">only</span> <span class="n">keep</span> <span class="n">the</span> <span class="n">columns</span> <span class="n">within</span> <span class="n">the</span> <span class="nb">range</span>
<span class="o">-</span> <span class="o">+</span><span class="n">remove</span>             <span class="p">:</span> <span class="n">to</span> <span class="n">remove</span> <span class="n">the</span> <span class="n">residues</span> <span class="n">within</span> <span class="n">the</span> <span class="nb">range</span>
<span class="o">-</span> <span class="o">+</span><span class="n">convert</span>            <span class="p">:</span> <span class="n">to</span> <span class="n">only</span> <span class="n">convert</span> <span class="n">the</span> <span class="n">residues</span> <span class="n">within</span> <span class="n">the</span> <span class="nb">range</span>
<span class="o">-</span> <span class="o">+</span><span class="n">grep</span>               <span class="p">:</span> <span class="n">to</span> <span class="n">select</span> <span class="n">a</span> <span class="n">given</span> <span class="n">string</span> <span class="n">of</span> <span class="n">character</span>
<span class="o">-</span> <span class="o">+</span><span class="n">rm_gap</span>             <span class="p">:</span> <span class="n">to</span> <span class="n">remove</span> <span class="n">columns</span> <span class="n">containing</span> <span class="n">gaps</span>
<span class="o">-</span> <span class="n">etc</span><span class="o">...</span>
</pre></div>
</div>
</section>
<section id="using-a-cache-file">
<h5>Using a “cache” file<a class="headerlink" href="#using-a-cache-file" title="Permalink to this heading"></a></h5>
<section id="what-is-a-cache-in-t-coffee">
<h6>What is a cache in T-Coffee?<a class="headerlink" href="#what-is-a-cache-in-t-coffee" title="Permalink to this heading"></a></h6>
<p>Several options can be performed easily by using what we call a cache (or cache file). In T-Coffee, a cache is a file containing an alternate version of your alignment where each position of the alignment is replaced by an alternative coding scheme. For instance each residue can be replaced by a score previously evaluated: this score can be the T-Coffee CORE index (cf. section <strong>Evaluating Your Alignment</strong>) or a matrix based evalution (blosum62mt or identity matrix). Then, when performing any modification or reformatting of your alignments, you can just specify the range of positions to be modified according to their respective scores within the cache. We will see some example especially regarding the modification of format of a given alignment; it is not mandatory to use a cache but it is quite practical. To generate a cache before any reformatting using a given evaluation score, you can use one of the following possible option:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Evaluating the T-Coffee CORE index during the alignment procedure:
$$: t_coffee sample_seq1.fasta -output=score_ascii

Evaluating the T-Coffee CORE index of a given alignment (-infile is mandatory):
$$: t_coffee -infile sample_seq1.aln -mode evaluate

Using an identity matrix:
$$: t_coffee -other_pg seq_reformat -in sample_seq1.aln -action +evaluate \
    idmat -output=score_ascii

Using a substitution matrix:
$$: t_coffee -other_pg seq_reformat -in sample_seq1.aln -action +evaluate \
    blosum62mt -output=score_ascii
</pre></div>
</div>
</section>
<section id="preparing-a-sequence-alignment-cache">
<h6>Preparing a sequence/alignment cache<a class="headerlink" href="#preparing-a-sequence-alignment-cache" title="Permalink to this heading"></a></h6>
<p>The following command will convert your alignment according to the given parameters: all A/a will be turned into 1, the gaps “-” will be conserved and all the other symbols (#) will be turned into 0. The flag <strong>-action +convert</strong> indicates the actions that must be carried out on the alignment before it is output into cache.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>1) Initial alignment:
CLUSTAL FORMAT
A CTCCGTgTCTAGGagt-TTACGTggAGT
B CTGAGA----AGCCGCCTGAGGTCG---
D CTTCGT----AGTCGT-TTAAGAca---
C -TTAAGGTCC---AGATTGCGGAGC---


2) Command line:
$$: t_coffee -other_pg seq_reformat -in=sample_dnaseq3.aln -output=clustalw_aln -out=cache.aln \
    -action +convert &#39;Aa1&#39; &#39;.-&#39; &#39;#0&#39;

3) Cache generated:
CLUSTAL W (1.83) multiple sequence alignment
A 0000000000100100-00100000100
B 000101----100000000100000---
D 000000----100000-00110101---
C -001100000---101000000100---
</pre></div>
</div>
<p>Other alternative are possible, for instance generating a cache for unaligned sequences (<strong>-in</strong> can refer to an alignment or unaligned sequences):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>1) Command line:
$$: t_coffee -other_pg seq_reformat -in=sample_dnaseq3.aln -output=fasta_seq -out=cache.seq \
    -action +convert &#39;Aa1&#39; &#39;.-&#39; &#39;#0&#39;

2) Generate the file cache.seq:
&gt;A
0000000000100100000100000100
&gt;B
0001010000100000000100000000
&gt;D
0000000000100000000110101000
&gt;C
0001100000000101000000100000
</pre></div>
</div>
</section>
<section id="preparing-a-library-cache">
<h6>Preparing a library cache<a class="headerlink" href="#preparing-a-library-cache" title="Permalink to this heading"></a></h6>
<p>The library is a special format used by T-Coffee to declare relationships between pairs of residues. The cache library format can also be used to declare for instance the color of specific residues in an alignment. For instance, the following file
<code class="docutils literal notranslate"><span class="pre">sample_dnaseq3.tc_lib</span></code> declares which residue of which sequence will receive which color. Note that the sequence number and the residue index are duplicated, owing to the recycling of this format from its original usage. It is also possible to use the BLOCK operator when defining the library (see <strong>Technical Documentation</strong>). The number right after BLOCK indicates the block length (10). The two next numbers (1 1) indicate the position of the first element in the block. The last value is the color.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>! TC_LIB_FORMAT_01
4
A 27 CTCCGTgTCTAGGagtTTACGTggAGT
B 21 CTGAGAAGCCGCCTGAGGTCG
C 21 TTAAGGTCCAGATTGCGGAGC
D 20 CTTCGTAGTCGTTTAAGAca
#1 1
 +BLOCK+ 10 1 1 3
 +BLOCK+ 5 15 15 5
#3 3
 6 6 1
 9 9 4
! CPU 240
! SEQ_1_TO_N
</pre></div>
</div>
</section>
</section>
</section>
<section id="modifying-the-format-of-your-data">
<h4>Modifying the format of your data<a class="headerlink" href="#modifying-the-format-of-your-data" title="Permalink to this heading"></a></h4>
<section id="keeping-protecting-your-sequence-names">
<h5>Keeping/Protecting your sequence names<a class="headerlink" href="#keeping-protecting-your-sequence-names" title="Permalink to this heading"></a></h5>
<p>Only few programs support long sequence names, and sometimes, when going through some pipeline the names of your sequences can be truncated or modified. To avoid this, <strong>seq_reformat</strong> contains a utility that can automatically rename your sequences into a form that will be machine-friendly, while making it easy to return to the human-friendly form.</p>
<ol class="arabic simple">
<li><p><strong>Create a code list</strong>: The first thing to do is to generate a list of names that will be used in place of the long original name of the sequences:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee -other_pg seq_reformat -in proteases_large.fasta -output \
    code_name &gt; proteases_large.code_name
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p><strong>Code your data</strong>: This will create a file where each original name is associated with a coded name (Cxxx). You can then use this file to either code your dataset using the following command:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee -other_pg seq_reformat -code proteases_large.code_name -in \
    proteases_large.fasta &gt; proteases_large.coded.fasta
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p><strong>Decode your data</strong>: Then you can work with the file sproteases_large.coded.fasta and when you are done, you can decode the names of your sequences with the following command line:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee -other_pg seq_reformat -decode proteases_large.code_name -in \
    proteases_large.coded.fasta
</pre></div>
</div>
</section>
<section id="changing-the-sequence-format">
<h5>Changing the sequence format<a class="headerlink" href="#changing-the-sequence-format" title="Permalink to this heading"></a></h5>
<p>Sometimes it may be necessary to change from one format to another, for instance when using another software which recognize only a given format. T-Coffee recognizes most common alignment formats and you can find the list of all input or output format recognized by simply typing <strong>t_coffee -other_pg seq_reformat</strong> without any input file(s). It is possible to reformat unaligned or aligned sequences alike although changing the alignment format is probably more interesting in order to use other applications; unaligned sequences format flags are generally preceded by the suffix <strong>“_seq”</strong> and aligned sequences flags by the suffix <strong>“_aln”</strong>. This also allows you to transform any alignment into unaligned sequences by removing the gaps. Here are some examples on how to change the format of your data:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>For unaligned sequences (e.g. FASTA to PIR):
$$: t_coffee -other_pg seq_reformat -in proteases_small.fasta -output pir_seq &gt; \
    proteases_small.pir_seq

For alignements (e.g. ClustalW to MSF):
$$: t_coffee -other_pg seq_reformat -in proteases_small.aln -output fasta_aln &gt; \
    proteases_small.fasta_aln

From aligned to unaligned sequences:
$$: t_coffee -other_pg seq_reformat -in proteases_small.aln -output fasta_seq &gt; \
    proteases_small.fasta
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Format recognition is not 100% full proof; occasionally you will have to inform the program about the nature of the file you are trying to reformat with <strong>-input msf_aln -output fasta_aln</strong> for instance.</p>
</div>
</section>
<section id="changing-the-case">
<h5>Changing the case<a class="headerlink" href="#changing-the-case" title="Permalink to this heading"></a></h5>
<section id="changing-the-case-of-your-sequences">
<h6>Changing the case of your sequences<a class="headerlink" href="#changing-the-case-of-your-sequences" title="Permalink to this heading"></a></h6>
<p>If you need to change the case of your sequences, you can use different modifiers embedded in <strong>seq_reformat</strong>. They are accessed via the <strong>-action</strong> flag. For instance, to write your sequences in lower case:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee -other_pg seq_reformat -in proteases_small.aln -action +lower \
    -output clustalw
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>No prize for guessing that <strong>+upper</strong> will do exactly the opposite…</p>
</div>
</section>
<section id="changing-the-case-of-specific-residues">
<h6>Changing the case of specific residues<a class="headerlink" href="#changing-the-case-of-specific-residues" title="Permalink to this heading"></a></h6>
<p>If you want to change the case of a specific residue, you can use the flag: <strong>+edit_residue &lt;sequence&gt; &lt;residue #&gt; &lt;lower|upper|symbol&gt;</strong>. If you have more than one residue to modify, write all the coordinates in a text file (one coordinate per line) as spans are not yet supported; then give the file to T-Coffee</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee -other_pg seq_reformat -in sample_seq1.aln -action +upper \
    +edit_residue hmgb_chite 10 lower


$$: t_coffee -other_pg seq_reformat -in sample_seq1.aln -action +upper \
    +edit_residue sample_seq1.list
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If you give a list of coordinates, it has to be a Unix text file (not a word document).</p>
</div>
</section>
<section id="changing-the-case-with-a-cache">
<h6>Changing the case with a cache<a class="headerlink" href="#changing-the-case-with-a-cache" title="Permalink to this heading"></a></h6>
<p>If you want to change the case depending on the score, you must either evaluate your alignment, or provide a cache. For example, this command line will upper the case of all residue then lower the case of every residue more than 50% identical to other residues in the same column:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Using a cache on the fly:
$$: t_coffee -other_pg seq_reformat -in sample_dnaseq2.aln -action +upper \
    +evaluate idmat +lower &#39;[5-9]&#39;

Using a cache file previously computed (2 steps):
$$: t_coffee -other_pg seq_reformat -in sample_dnaseq2.aln -action +evaluate \
    idmat -output=score_ascii &gt; sample_dnaseq2.cache

$$: t_coffee -other_pg seq_reformat -in sample_dnaseq2.aln -struc_in sample_dnaseq2.cache \
   -struc_in_f number_aln -action +lower &#39;[5-9]&#39;
</pre></div>
</div>
</section>
</section>
<section id="coloring-editing-residues-in-an-alignment">
<h5>Coloring/Editing residues in an alignment<a class="headerlink" href="#coloring-editing-residues-in-an-alignment" title="Permalink to this heading"></a></h5>
<section id="changing-the-default-colors">
<h6>Changing the default colors<a class="headerlink" href="#changing-the-default-colors" title="Permalink to this heading"></a></h6>
<p>Colors are hard coded in the program, but if you wish, you can change them by simply creating a file named <code class="docutils literal notranslate"><span class="pre">seq_reformat.color</span></code> that is used to declare the color values. The name of the file (<code class="docutils literal notranslate"><span class="pre">seq_reformat.color</span></code>) is defined in <code class="docutils literal notranslate"><span class="pre">programmes_define.h</span></code>, COLOR_FILE and can be changed before compilation. By default, the file is searched in the current directory. For example, the following line written in <code class="docutils literal notranslate"><span class="pre">seq_reformat.color</span></code> indicates that the value 0 in the cache corresponds now to #FFAA00 in html, and in RGB 1, 0.2 and 0.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Format</span> <span class="k">for</span> <span class="n">hard</span> <span class="n">coded</span> <span class="n">colors</span> <span class="ow">in</span> <span class="n">T</span><span class="o">-</span><span class="n">Coffee</span><span class="p">:</span>
<span class="mi">0</span> <span class="c1">#FFAA00 1 0.2 0</span>
</pre></div>
</div>
</section>
<section id="coloring-specific-types-of-residues-nucleic-acids">
<h6>Coloring specific types of residues/nucleic acids<a class="headerlink" href="#coloring-specific-types-of-residues-nucleic-acids" title="Permalink to this heading"></a></h6>
<p>You can color all the residues of your sequences on the fly; for instance, the following command line will color all the a’s in color 0 (blue):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee -other_pg seq_reformat -in sample_seq1.aln -action +3convert a0 \
    -output color_html &gt; sample_seq1_color.html
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This option is case sensitive so the case of the residues or nucleotides should be the same in the command line (in this command line, only a lower case will be colored).</p>
</div>
</section>
<section id="coloring-a-specific-residue-of-a-specific-sequence">
<h6>Coloring a specific residue of a specific sequence<a class="headerlink" href="#coloring-a-specific-residue-of-a-specific-sequence" title="Permalink to this heading"></a></h6>
<p>If you want to color a specific residue/nucleotide, you can use the flag <strong>+color_residue &lt;sequence&gt; &lt;residue #&gt; &lt;color #&gt;</strong>. If you have more than one residue to color, you can put all the coordinates in a file, (one coordinate per line). Spans are not yet supported.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee -other_pg seq_reformat -in sample_seq1.aln -action +color_residue \
    hmgb_chite 10 1 -output color_html &gt; sample_seq1_single.html


$$: t_coffee -other_pg seq_reformat -in sample_seq1.aln -action +color_residue \
    sample_seq1_color.list -output color_html &gt; sample_seq1_all.html
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If you give a list of coordinates, it has to be a Unix text file (not a word document).</p>
</div>
</section>
<section id="coloring-according-to-the-conservation">
<h6>Coloring according to the conservation<a class="headerlink" href="#coloring-according-to-the-conservation" title="Permalink to this heading"></a></h6>
<p>Use the +evaluate flag if you want to color your alignment according to its conservation level or using the boxshade scoring scheme:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Conservation color scheme:
$$: t_coffee -other_pg seq_reformat -in sample_seq1.aln -action +3evaluate pam250mt \
    -output color_html &gt; color_cons.html

Boxshade color scheme:
$$: t_coffee -other_pg seq_reformat -in sample_aln1.aln -action +3evaluate boxshade \
    -output color_html &gt; color_cons_box.html
</pre></div>
</div>
</section>
<section id="coloring-an-alignment-using-a-cache">
<h6>Coloring an alignment using a cache<a class="headerlink" href="#coloring-an-alignment-using-a-cache" title="Permalink to this heading"></a></h6>
<p>If you have a cache alignment or a cache library, you can use it to color your alignment and either make a post script, html or PDF output. For instance, if you use the file cache.seq:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> Produces a html file:
 $$: t_coffee -other_pg seq_reformat -in=sample_dnaseq3.aln -struc_in=sample_dnaseq3.cache \
     -struc_in_f number_fasta -output=color_html -out=color_dnaseq3.html

Produces a pdf file:
 $*: t_coffee -other_pg seq_reformat -in=sample_dnaseq3.aln -struc_in=sample_dnaseq3.cache \
     -struc_in_f number_fasta -output=color_pdf -out=color_dnaseq3.pdf

Produces an output using a library:
$$: t_coffee -other_pg seq_reformat -in=sample_dnaseq3.aln -struc_in=sample_dnaseq3.tc_lib \
    -output=color_html -out=color_dnaseq3_lib.html
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The script <strong>ps2pdf</strong> must be installed on your system for the pdf options.</p>
</div>
</section>
</section>
</section>
<section id="modifying-the-data-itself">
<h4>Modifying the data itself…<a class="headerlink" href="#modifying-the-data-itself" title="Permalink to this heading"></a></h4>
<section id="modifiying-sequences-in-your-dataset">
<h5>Modifiying sequences in your dataset<a class="headerlink" href="#modifiying-sequences-in-your-dataset" title="Permalink to this heading"></a></h5>
<section id="converting-residues">
<h6>Converting residues<a class="headerlink" href="#converting-residues" title="Permalink to this heading"></a></h6>
<p>It is possible for instance to selectively convert all given characters in a sequence (residues or nucleic acids alike) into another one, for example all G’s having a score between 5 and 9 by using the command line:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee -other_pg seq_reformat -in sample_dnaseq2.aln -struc_in sample_dnaseq2.cache \
    -struc_in_f number_aln -action +convert &#39;[5-9]&#39; GX
</pre></div>
</div>
</section>
<section id="extracting-sequences-according-to-a-pattern">
<h6>Extracting sequences according to a pattern<a class="headerlink" href="#extracting-sequences-according-to-a-pattern" title="Permalink to this heading"></a></h6>
<p>You can extract any sequence by requesting a specific pattern to be found either in the name (NAME), the comment (COMMENT) or the sequence (SEQ) using the modifier is ‘+grep’. For instance, if you want to extract all the sequences whose name contain the word HUMAN, the flag NAME/COMMENT/SEQ indicates that the modification is made according to the sequences names, the comment section or the sequence itself, and the flag KEEP/REMOVE means that you will keep/remove all the sequences containing the string HUMAN. Here are some examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>To keep sequences containing HUMAN in the name:
$$: t_coffee -other_pg seq_reformat -in proteases_large.aln -action +grep NAME \
    KEEP HUMAN -output clustalw

To remove sequences containing HUMAN in the name:
$$: t_coffee -other_pg seq_reformat -in proteases_large.aln -action +grep NAME \
    REMOVE HUMAN -output clustalw

To keep sequence which contain sapiens in the comment:
$$: t_coffee -other_pg seq_reformat -in proteases_large.fasta -action +grep COMMENT \
    KEEP sapiens -output clustalw

To remove sequences containing the pattern [ILM]K:
$$: t_coffee -other_pg seq_reformat -in proteases_large.aln -action +grep SEQ \
    REMOVE &#39;[ILM]K&#39; -output clustalw
</pre></div>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>You should know that the pattern can be any perl legal regular expression, you can visit this  <a class="reference external" href="http://www.comp.leeds.ac.uk/Perl/matching.html">page</a> for some background on regular expressions.</p>
</div>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>This option is case sensitive (Human, HUMAN and hUman will not yield the same results). Be careful !!!</p>
</div>
</section>
<section id="extracting-removing-specific-sequences-by-names">
<h6>Extracting/Removing specific sequences by names<a class="headerlink" href="#extracting-removing-specific-sequences-by-names" title="Permalink to this heading"></a></h6>
<p>If you want to extract (command 1) or remove (command 2) several sequences in order to make a subset, you can specify a list of sequences by their full name:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Command 1: keep sequences
$$: t_coffee -other_pg seq_reformat -in proteases_small.fasta -action +extract_seq_list \
    &#39;sp|P29786|TRY3_AEDAE&#39; &#39;sp|P35037|TRY3_ANOGA&#39;

Command 2: remove sequences
$$: t_coffee -other_pg seq_reformat -in proteases_small.fasta -action +remove_seq \
    &#39;sp|P29786|TRY3_AEDAE&#39; &#39;sp|P35037|TRY3_ANOGA&#39;
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note the single quotes (’) are mandatory as they are meant to protect the name of your sequence and prevent the Unix shell to interpret it like an instruction.</p>
</div>
<p>Once sequences are extracted or removed, some columns may remain containing only gaps, but it is possible to simply remove empty columns from the resulting dataset (command 3), and even extract specific blocks for the selected sequences either keeping the exact same name (command 4) or the name of the specific blocks extracted (command 5):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Command 3: removing empty columns
$$: t_coffee -other_pg seq_reformat -in proteases_small.aln -action +extract_seq_list \
    &#39;sp|P29786|TRY3_AEDAE&#39; &#39;sp|P35037|TRY3_ANOGA&#39; +rm_gap

Command 4: keeping the initial name after extracting specific blocks and removing empty columns
$$: t_coffee -other_pg seq_reformat -in proteases_small.aln -action +keep_name \
    +extract_seq &#39;sp|P29786|TRY3_AEDAE&#39; 20 200 &#39;sp|P35037|TRY3_ANOGA&#39; 10 150 +rm_gap

Command 5: renaming sequences according to the extracted blocks and removing empty columns
$$: t_coffee -other_pg seq_reformat -in proteases_small.aln -action +extract_seq \
    &#39;sp|P29786|TRY3_AEDAE&#39; 20 200 &#39;sp|P35037|TRY3_ANOGA&#39; 10 150 +rm_gap
</pre></div>
</div>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>The tag <strong>+keep_name</strong> must come BEFORE the tag <strong>+extract_seq</strong>.</p>
</div>
</section>
<section id="extracting-the-most-informative-sequences">
<h6>Extracting the most informative sequences<a class="headerlink" href="#extracting-the-most-informative-sequences" title="Permalink to this heading"></a></h6>
<p>Large datasets are problematic because they can be difficult to align and analyze, MSA programs tend to become very slow and inaccurate. In short, the best size for an MSA dataset would be between 20 to 40 sequences to have enough sequences to see the effect of evolution, but in the same time small enough so that you can visualize your alignment and recompute it as many times as needed. More important than its size, a good dataset have to be informative, when each sequence contains information the others do not have. The most informative sequences are the sequences that are as different as possible to one another, within your dataset. You can extract the most informative sequences using flag <strong>+trim</strong> followed by the number of sequences you wish to keep (“n” for a number and “N” for a perrcentage). The following commands will extract the 10 most informative sequences (command 1) or the 20% of most informative sequences (command 2):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Command 1:
$$: t_coffee -other_pg seq_reformat -in proteases_large.fasta -action +trim _seq_n10 \
    -output fasta_seq
Command 2:
$$: t_coffee -other_pg seq_reformat -in proteases_large.fasta -action +trim _seq_N20 \
    -output fasta_seq
</pre></div>
</div>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>The argument to trim include <strong>_seq_</strong>, it means your sequences are provided unaligned. If your sequences are already aligned, you do not need to provide this parameter. It is generally more accurate to use unaligned sequences.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For very large dataset, <strong>seq_reformat</strong> will compute the similarity matrix between your sequences once only. It will then store it in its cache to be reused any time you run on the same dataset. In short this means that it will take much longer to run the first time, but be much faster if you need to rerun it.</p>
</div>
</section>
<section id="extracting-removing-sequences-with-the-identity">
<h6>Extracting/Removing sequences with the % identity<a class="headerlink" href="#extracting-removing-sequences-with-the-identity" title="Permalink to this heading"></a></h6>
<p><strong>Removing too identical sequences (redundant)</strong></p>
<p>Removing the most similar sequences is often what people have in mind when they talk about removing redundancy. You can do so using the <strong>+trim</strong> option. For instance, you can generate a dataset where no pair of sequences has more than 50% identity either from a dataset of unaligned sequences (command 1) or from any given alignment (command 2). If you start from unaligned sequences, the removal of redundancy can be slow. If your sequences have already been aligned using a fast method, you can take advantage of this by replacing the <strong>“_seq_”</strong> with <strong>“_aln_”</strong>. Just run the following command lines to see the difference un runtime:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Command 1: unaligned sequences
$$: t_coffee -other_pg seq_reformat -in proteases_large.fasta -action +trim _seq_%%50_

Command 2: aligned sequences
$$: t_coffee -other_pg seq_reformat -in proteases_large.fasta -action +trim _aln_%%50_
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Using aligned sequences results in a fastest trimming, however, it also means that you rely on a more approximate estimation of sequence similarity.</p>
</div>
<p><strong>Removing too different sequences (outliers)</strong></p>
<p>Sequences that are too distantly related from the rest of the set (called outliers) may have very negative effects on the overall alignment; to prevent this, it is advisable not to use them. The next command line will lead to the removal of all the sequences where no pair of sequences has less than 30% average accuracy with all the other sequences in the dataset (the symbol “_O” stands for Outliers) and more than 80% identity:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee -other_pg seq_reformat -in proteases_large.fasta -action +trim _seq_%%80_O30
</pre></div>
</div>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>This particular option is quite powerful as it allows you to decide both inferior and superior tresholds for trimming your dataset based on pairwise identity score, and therefore you can dissect your dataset according to different ranges of identity values. Be careful not to remove too many sequences ;-)</p>
</div>
<p><strong>Forcing specific sequences to be kept</strong></p>
<p>Sometimes you want to trim based on identity while making sure specific/important sequences remain in your dataset. You can do so by providing a pattern (<strong>“_f”</strong> for field) : it will keep all the sequences whose name contains the given string (<strong>“_fNAME”</strong>, <strong>“_fCOMMENT”</strong> or <strong>“_fSEQ”</strong>). Here are some examples corresponding to the different protected fields while removing all sequences above 50% identity:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Keep all HUMAN sequences
$$: t_coffee -other_pg seq_reformat -in proteases_large.fasta -action +trim \
    _seq_%%50_fNAME HUMAN

Keep all sequences containing &quot;.apiens&quot;
$$: t_coffee -other_pg seq_reformat -in proteases_large.fasta -action +trim \
    _seq_%%50_fCOMMENT &#39;.apiens&#39;

Keep all sequences containing residues
$$: t_coffee -other_pg seq_reformat -in proteases_large.fasta -action +trim \
    _seq_%%50_fSEQ &#39;[MLV][RK]&#39;
</pre></div>
</div>
<p>You can also specify the sequences you want to keep by giving another fasta file containing the name of these sequences via the flag <strong>-in2</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee -other_pg seq_reformat -in proteases_large.fasta -in2 proteases_small.fasta \
    -action +trim _seq_%%40
</pre></div>
</div>
</section>
<section id="chaining-important-sequences">
<h6>Chaining important sequences<a class="headerlink" href="#chaining-important-sequences" title="Permalink to this heading"></a></h6>
<p>In order to align two distantly related sequences, most multiple sequence alignment packages perform better when provided with many intermediate sequences that make it possible to ‘bridge’ your two sequences. The modifier <strong>+chain</strong> makes it possible to extract from a dataset a subset of intermediate sequences that chain the sequences you are interested in. For instance, let us consider the two sequences “sp|P21844|MCPT5_MOUSE” and “sp|P29786|TRY3_AEDAE” having 26% identity. This is high enough to make a case for a homology relationship between them, but this is too low to blindly trust any pairwise alignment. With the names of the two sequences written in the file sproteases_pair.fasta, run the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee -other_pg seq_reformat -in proteases_large.fasta -in2 proteases_pair.fasta \
    -action +chain &gt; proteases_chain.fasta
</pre></div>
</div>
<p>This will generate a dataset of 21 sequences, with the following chain of similarity between your two sequences. This is probably the best way to generate a high quality alignment of your two sequences when using a progressive method like ClustalW, T-Coffee, MUSCLE or MAFFT.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">N</span><span class="p">:</span> <span class="mi">21</span> <span class="n">Lower</span><span class="p">:</span> <span class="mi">40</span> <span class="n">Sim</span><span class="p">:</span> <span class="mi">25</span> <span class="n">DELTA</span><span class="p">:</span> <span class="mi">15</span>
<span class="c1">#sp|P21844|MCPT5_MOUSE --&gt;93 --&gt;sp|P50339|MCPT3_RAT --&gt;85 --&gt;sp|P50341|MCPT2_M\</span>
<span class="n">ERUN</span> <span class="o">--&gt;</span><span class="mi">72</span> <span class="o">--&gt;</span><span class="n">sp</span><span class="o">|</span><span class="n">P52195</span><span class="o">|</span><span class="n">MCPT1_PAPHA</span> <span class="o">--&gt;</span><span class="mi">98</span> <span class="o">--&gt;</span><span class="n">sp</span><span class="o">|</span><span class="n">P56435</span><span class="o">|</span><span class="n">MCPT1_MACFA</span> <span class="o">--&gt;</span><span class="mi">97</span> <span class="o">--&gt;</span><span class="n">sp</span>\
<span class="o">|</span><span class="n">P23946</span><span class="o">|</span><span class="n">MCPT1_HUMAN</span> <span class="o">--&gt;</span><span class="mi">81</span> <span class="o">--&gt;</span><span class="n">sp</span><span class="o">|</span><span class="n">P21842</span><span class="o">|</span><span class="n">MCPT1_CANFA</span> <span class="o">--&gt;</span><span class="mi">77</span> <span class="o">--&gt;</span><span class="n">sp</span><span class="o">|</span><span class="n">P79204</span><span class="o">|</span><span class="n">MCPT2_SH</span>\
<span class="n">EEP</span> <span class="o">--&gt;</span><span class="mi">60</span> <span class="o">--&gt;</span><span class="n">sp</span><span class="o">|</span><span class="n">P21812</span><span class="o">|</span><span class="n">MCPT4_MOUSE</span> <span class="o">--&gt;</span><span class="mi">90</span> <span class="o">--&gt;</span><span class="n">sp</span><span class="o">|</span><span class="n">P09650</span><span class="o">|</span><span class="n">MCPT1_RAT</span> <span class="o">--&gt;</span><span class="mi">83</span> <span class="o">--&gt;</span><span class="n">sp</span><span class="o">|</span><span class="n">P5</span>\
<span class="mi">0340</span><span class="o">|</span><span class="n">MCPT1_MERUN</span> <span class="o">--&gt;</span><span class="mi">73</span> <span class="o">--&gt;</span><span class="n">sp</span><span class="o">|</span><span class="n">P11034</span><span class="o">|</span><span class="n">MCPT1_MOUSE</span><span class="o">--&gt;</span><span class="mi">76</span> <span class="o">--&gt;</span><span class="n">sp</span><span class="o">|</span><span class="n">P00770</span><span class="o">|</span><span class="n">MCPT2_RAT</span> <span class="o">--</span>\
<span class="o">&gt;</span><span class="mi">71</span> <span class="o">--&gt;</span><span class="n">sp</span><span class="o">|</span><span class="n">P97592</span><span class="o">|</span><span class="n">MCPT4_RAT</span> <span class="o">--&gt;</span><span class="mi">66</span> <span class="o">--&gt;</span><span class="n">sp</span><span class="o">|</span><span class="n">Q00356</span><span class="o">|</span><span class="n">MCPTX_MOUSE</span> <span class="o">--&gt;</span><span class="mi">97</span> <span class="o">--&gt;</span><span class="n">sp</span><span class="o">|</span><span class="n">O35164</span><span class="o">|</span><span class="n">M</span>\
<span class="n">CPT9_MOUSE</span> <span class="o">--&gt;</span><span class="mi">61</span> <span class="o">--&gt;</span><span class="n">sp</span><span class="o">|</span><span class="n">P15119</span><span class="o">|</span><span class="n">MCPT2_MOUSE</span> <span class="o">--&gt;</span><span class="mi">50</span> <span class="o">--&gt;</span><span class="n">sp</span><span class="o">|</span><span class="n">Q06606</span><span class="o">|</span><span class="n">GRZ2_RAT</span> <span class="o">--&gt;</span><span class="mi">54</span> <span class="o">--</span>\
<span class="o">&gt;</span><span class="n">sp</span><span class="o">|</span><span class="n">P80931</span><span class="o">|</span><span class="n">MCT1A_SHEEP</span> <span class="o">--&gt;</span><span class="mi">40</span> <span class="o">--&gt;</span><span class="n">sp</span><span class="o">|</span><span class="n">Q90629</span><span class="o">|</span><span class="n">TRY3_CHICK</span> <span class="o">--&gt;</span><span class="mi">41</span> <span class="o">--&gt;</span><span class="n">sp</span><span class="o">|</span><span class="n">P29786</span><span class="o">|</span><span class="n">TRY3_A</span>\
<span class="n">EDAE</span>
</pre></div>
</div>
</section>
</section>
<section id="modifying-columns-blocks-in-your-dataset">
<h5>Modifying columns/blocks in your dataset<a class="headerlink" href="#modifying-columns-blocks-in-your-dataset" title="Permalink to this heading"></a></h5>
<section id="removing-gapped-columns">
<h6>Removing gapped columns<a class="headerlink" href="#removing-gapped-columns" title="Permalink to this heading"></a></h6>
<p>You can also remove all the columns containing a given proportion of gaps; for instance the following command will delete all the residues occurring in a column that contains 50% or more gaps (use 1 to delete residues from columns having 1 gap or more):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee -other_pg seq_reformat -in sample_dnaseq3.aln -action +rm_gap 50
</pre></div>
</div>
</section>
<section id="extracting-specific-columns">
<h6>Extracting specific columns<a class="headerlink" href="#extracting-specific-columns" title="Permalink to this heading"></a></h6>
<p>Extracting portions of a dataset is something very frequently needed. You may need to extract all the sequences that contain the word human in their name, or you may want all the sequences containing a simple motif. We show you here how to do a couple of these things. To do this, you need an evaluation file that may have been generated with T-Coffee, either running a <em>de novo</em> alignment (command 1) or evaluating a preexisting alignment (command 2):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Command 1:
$$: t_coffee sample_seq1.fasta -output score_ascii, aln

Command 2:
$$: t_coffee -other_pg seq_reformat -in sample_seq1.aln -action +evaluate \
    blosum62mt -output score_ascii &gt; sample_seq1_blosum62.score_ascii
</pre></div>
</div>
<p>This generates a score_ascii file that you can then use to filter out the bad bits in your alignment considering the individual score of each residue to trigger the filtering (command 3), or according to the whole column score by simply add the <strong>+use_cons</strong> flag (command 4). This last command can also be run on the fly with command 5. The commands 3/4/5 will keep only residues and/or columns having a score between 6 and 9.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Command 3:
$$: t_coffee -other_pg seq_reformat -in sample_seq1.aln -struc_in sample_seq1.score_ascii \
    -struc_in_f number_aln -action +keep &#39;[6-9]&#39;

Command 4:
$$: t_coffee -other_pg seq_reformat -in sample_seq1.aln -struc_in sample_seq1.score_ascii \
    -struc_in_f number_aln -action +use_cons +keep &#39;[6-9]&#39;

Command 5
$$: t_coffee -other_pg seq_reformat -in sample_aln1.aln -action +evaluate blosum62mt \
     +use_cons +keep &#39;[6-9]&#39;
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Don’t forget the simple quotes (‘), it’s mandatory !!!</p>
</div>
</section>
<section id="extracting-entire-blocks">
<h6>Extracting entire blocks<a class="headerlink" href="#extracting-entire-blocks" title="Permalink to this heading"></a></h6>
<p>In case you want to extract a specific block of your alignment, for instance to remove poorly resolved regions, delimit your alignments boundaries or to extract domains, you can do so with the option <strong>+extract_block</strong>. In command 1, the option <strong>cons</strong> indicates that you are counting the positions according to the consensus of the alignment (i.e. the positions correspond to the columns # of the alignment). If you want to extract your block relatively to a specific sequence, you should replace cons with this sequence name (command 2).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Command 1: extract block from MSA
$$: t_coffee -other_pg seq_reformat -in proteases_small.aln -action +extract_block \
    cons 150 200

Command 2: extract_block relative to a give sequence of the MSA
$$: t_coffee -other_pg seq_reformat -in proteases_small.aln -action +extract_block \
    &#39;sp|Q03238|GRAM_RAT&#39; 10 200
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>It may be sometimes difficult to know where starts the blocks you are interested in except by counting manually the number of column. You can also make some tries by modifying the boundaries until you get the block you want and then redirect the result into the output file name of your choice.</p>
</div>
</section>
<section id="concatenating-blocks-or-msas">
<h6>Concatenating blocks or MSAs<a class="headerlink" href="#concatenating-blocks-or-msas" title="Permalink to this heading"></a></h6>
<p>If you have extracted several blocks generated using the previous command and you want to glue them together, you can use the <strong>+cat_aln</strong> modifier:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee -other_pg seq_reformat -in proteases_small.aln -action +extract_block \
    cons 100 120 &gt; block1.aln

$$: t_coffee -other_pg seq_reformat -in proteases_small.aln -action +extract_block \
    cons 150 200 &gt; block2.aln

$$: t_coffee -other_pg seq_reformat -in block1.aln -in2 block2.aln -action +cat_aln
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The alignments do not need to have the same number of sequences and the sequences do not need to come in the same order.</p>
</div>
</section>
</section>
</section>
<section id="manipulating-dna-sequences">
<h4>Manipulating DNA sequences<a class="headerlink" href="#manipulating-dna-sequences" title="Permalink to this heading"></a></h4>
<section id="translating-dna-sequences-into-protein-sequences">
<h5>Translating DNA sequences into protein sequences<a class="headerlink" href="#translating-dna-sequences-into-protein-sequences" title="Permalink to this heading"></a></h5>
<p>If your sequences are DNA coding sequences, it is often safer and more accurate to align them as proteins (as protein sequences are more conserved than their corresponding DNA sequence). The <strong>seq_reformat</strong> options make it easy for you to translate your sequences:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee -other_pg seq_reformat -in proteases_small_dna.fasta -action \
    +translate -output fasta_seq
</pre></div>
</div>
</section>
<section id="back-translation-with-the-bona-fide-dna-sequences">
<h5>Back-translation with the <em>bona fide</em> DNA sequences<a class="headerlink" href="#back-translation-with-the-bona-fide-dna-sequences" title="Permalink to this heading"></a></h5>
<p>Once your sequences have been aligned, you may want to turn your protein alignment back into a DNA alignment, either to do phylogeny, or maybe in order to design PCR probes. To do so, use the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee -other_pg seq_reformat -in proteases_small_dna.fasta -in2 \
    proteases_small.aln -action +thread_dna_on_prot_aln -output clustalw
</pre></div>
</div>
</section>
<section id="finding-the-bona-fide-sequences-for-the-back-translation">
<h5>Finding the <em>bona fide</em> sequences for the back-translation<a class="headerlink" href="#finding-the-bona-fide-sequences-for-the-back-translation" title="Permalink to this heading"></a></h5>
<p>Use the online server <a class="reference external" href="http://tcoffee.vital-it.ch/apps/tcoffee/do:protogene">ProtoGen</a>.</p>
</section>
</section>
<section id="manipulating-rna-sequences">
<h4>Manipulating RNA Sequences<a class="headerlink" href="#manipulating-rna-sequences" title="Permalink to this heading"></a></h4>
<section id="producing-a-stockholm-output-adding-predicted-secondary-structures">
<h5>Producing a Stockholm output: adding predicted secondary structures<a class="headerlink" href="#producing-a-stockholm-output-adding-predicted-secondary-structures" title="Permalink to this heading"></a></h5>
<section id="producing-adding-a-consensus-structure">
<h6>Producing/Adding a consensus structure<a class="headerlink" href="#producing-adding-a-consensus-structure" title="Permalink to this heading"></a></h6>
<p>Given an RNA multiple sequence alignment, it is possible to compute (command 1) or add (command 2) the alifold (Vienna package) consensus secondary structure and output in stockholm:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Command 1:
$$: t_coffee -other_pg seq_reformat -in sample_rnaseq2.aln -action +aln2alifold \
    -output stockholm_aln

Command 2:
$$: t_coffee -other_pg seq_reformat -in sample_rnaseq2.aln -action +add_alifold \
    -output stockholm_aln
</pre></div>
</div>
</section>
<section id="adding-a-precomputed-consensus-structure-to-an-alignment">
<h6>Adding a precomputed consensus structure to an alignment<a class="headerlink" href="#adding-a-precomputed-consensus-structure-to-an-alignment" title="Permalink to this heading"></a></h6>
<p>The file sample_rnaseq2.alifold contains the raw output of the alifold program produced via the RNAalifold <a class="reference external" href="http://rna.tbi.univie.ac.at/cgi-bin/RNAalifold.cgi">webserver</a> or captured with the command “RNAalifold &lt;sample_rnaseq2.aln &gt; sample_rnaseq2.alifold”. It is possible to add this secondary structure to an alignment (command 1) and to stack Stockholm formatted secondary structures (command 2):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Command 1:
$$: t_coffee -other_pg seq_reformat -in sample_rnaseq2.aln -in2 sample_rnaseq2.alifold \
    -input2 alifold -action +add_alifold -output stockholm_aln

Command 2:
$$: t_coffee -other_pg seq_reformat -in sample_rnaseq2.aln -in2 sample_rnaseq2.cons.stk \
    -action +add_alifold -output stockholm_aln
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The alifold structure and the alignment MUST be compatible. The function makes no attempt to thread or align the structure, it merely stacks it below the MSA.</p>
</div>
</section>
</section>
<section id="analyzing-a-rnaalifold-secondary-structure-prediction">
<h5>Analyzing a RNAalifold secondary structure prediction<a class="headerlink" href="#analyzing-a-rnaalifold-secondary-structure-prediction" title="Permalink to this heading"></a></h5>
<p>The following commands can either be applied on a Stockholm or a standard MSA. In the second case (standard MSA) the secondary structure will be automatically recomputed by alifold.</p>
<section id="visualizing-compensatory-mutations">
<h6>Visualizing compensatory mutations<a class="headerlink" href="#visualizing-compensatory-mutations" title="Permalink to this heading"></a></h6>
<p>The following command will output a color coded version of your alignment with matching columns indicated as follows:</p>
<blockquote>
<div><ul class="simple">
<li><p>I: incompatible pair (i.e. at least one pair is not WC)</p></li>
<li><p>N: pairs are Gus or WC</p></li>
<li><p>W: all pairs are Watson</p></li>
<li><p>c: compensatory mutations</p></li>
<li><p>C: WC compensatory mutations</p></li>
</ul>
</div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Standard alignment:
$$: t_coffee -other_pg seq_reformat -in sample_rnaseq2.aln -action +alifold2analyze aln

Color coded alignment:
$$: t_coffee -other_pg seq_reformat -in sample_rnaseq2.aln -action +alifold2analyze color_html
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Handling gapped columns: by default gapped column are ignored but they can be included by adding the tag <strong>-usegap</strong>.</p>
</div>
</section>
<section id="analyzing-matching-columns">
<h6>Analyzing matching columns<a class="headerlink" href="#analyzing-matching-columns" title="Permalink to this heading"></a></h6>
<p>The option <strong>+alifold2analyze</strong> will estimate the number of pairs of columns that are perfect Watson and Crick pairings, those that are neutral (including a GU) and those that include correlated mutations (command 1). The WCcomp are the compensated mutations maintaining WC base pairing. Other arguments can given, to display the list of paired positions and their status (compensated, Watson, etc…) use command 2:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Command 1:
$$: t_coffee -other_pg seq_reformat -in sample_rnaseq2.stk -action +alifold2analyze stat

Command 2:
$$: t_coffee -other_pg seq_reformat -in sample_rnaseq2.stk -action +alifold2analyze list
</pre></div>
</div>
</section>
</section>
<section id="comparing-alternative-folds">
<h5>Comparing alternative folds<a class="headerlink" href="#comparing-alternative-folds" title="Permalink to this heading"></a></h5>
<p>The folds associated with alternative alignments can be compared. This comparison involves counting how many identical pairs of residues are predicted on each sequence in one fold and in the other. The top of the output (&#64;&#64;lines) summarizes the results that are displayed on the input alignment; if the provided alignment do not have a fold, this fold will be estimated with alifold. The folds can be provided as Stockholm alignments:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee -other_pg seq_reformat -in sample_rnaseq2.cw.stk -in2 sample_rnaseq2.tcoffee.stk \
    -action +RNAfold_cmp
</pre></div>
</div>
</section>
</section>
<section id="phylogenetic-trees-manipulation">
<h4>Phylogenetic Trees Manipulation<a class="headerlink" href="#phylogenetic-trees-manipulation" title="Permalink to this heading"></a></h4>
<section id="producing-phylogenetic-trees">
<h5>Producing phylogenetic trees<a class="headerlink" href="#producing-phylogenetic-trees" title="Permalink to this heading"></a></h5>
<p>The seq_reformat is NOT a phylogeny package, yet over the time it has accumulated a few functions that make it possible to compute simple phylogenetic trees, or similar types of clustering. Given a multiple sequence alignment, it is possible to compute either a UPGMA or an NJ tree. The following commands use an identity matrix to compare your sequences and will output an unrooted NJ tree in Newick format (command 1) or a rooted UPGMA tree (command 2):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Command 1:
$$: t_coffee -other_pg seq_reformat -in sample_seq1.aln -action +aln2tree -output newick \
    -out sample_seq1_tree_nj.nwk

Command 2:
$$: t_coffee -other_pg seq_reformat -in sample_seq1.aln -action +aln2tree _TMODE_upgma  \
    -output newick -out sample_seq1_tree_upgma.nwk
</pre></div>
</div>
<p>If your data is not data sequence, but a matrix of 1 and Os (i.e. SAR matrix for instance), you can use a different matrix to compute the pairwise distances (command 3), and all these parameters can be concatenated (command 4):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Command 3:
$#: t_coffee -other_pg seq_reformat -in sample_seq1.aln -action +aln2tree \
    _MATRIX_sarmat -output newick

Command 4:
$#: t_coffee -other_pg seq_reformat -in sample_seq1.aln -action +aln2tree \
    _TMODE_upgma_MATRIX_sarmat -output newick
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Bootstrap facilities will also be added at some point…We recommend you to use <a class="reference external" href="http://evolution.genetics.washington.edu/phylip.html">Phylip</a> or any other specific phylogenetic software (PhyML, RAxML, MrBayes, etc…) if you need some serious phylogeny !</p>
</div>
</section>
<section id="comparing-two-phylogenetic-trees">
<h5>Comparing two phylogenetic trees<a class="headerlink" href="#comparing-two-phylogenetic-trees" title="Permalink to this heading"></a></h5>
<p>A real interesting option is the ability to compare two trees (unrooted) returning some ofthe most common scores used for this including Robinson-Foulds</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee -other_pg seq_reformat -in sample_tree1.dnd -in2 sample_tree2.dnd -action \
    +tree_cmp -output newick

#tree_cmp|T: 33 W: 20.00 L: 14.88 RF: 2 N: 9 S: 5
#tree_cmp_def|T: ratio of identical nodes
#tree_cmp_def|W: ratio of identical nodes weighted with the min Nseq below node
#tree_cmp_def|L: average branch length similarity
#tree_cmp_def|RF: Robinson and Foulds
#tree_cmp_def|N: number of Nodes in T1 [unrooted]
#tree_cmp_def|S: number of Sequences in T1
</pre></div>
</div>
<p>About the output scores in more details:</p>
<blockquote>
<div><ul class="simple">
<li><p>T: Fraction of the branches conserved between the two trees. This is obtained by considering the split induced by each branch and by checking whether that split is found in both trees.</p></li>
<li><p>W: Fraction of the branches conserved between the two trees. Each branch is weighted with MIN, the minimum number of leaf on its left or right.</p></li>
<li><p>L: Fraction of branch length difference between the two considered trees.</p></li>
<li><p>RF: is the standard Robinson-Foulds value when comparing trees.</p></li>
</ul>
</div></blockquote>
<p>The last line contains a tree where distances have been replaced by the number of leaf under the considered node:</p>
<blockquote>
<div><ul class="simple">
<li><p>Positive values indicate a node common to both trees and correspond to MIN.</p></li>
<li><p>Negative values indicate a node found in tree1 but not in tree2.</p></li>
<li><p>The higher this value, the deeper the node.</p></li>
</ul>
</div></blockquote>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>You can extract this tree for further usage by typing <strong>cat outfile | grep -v ‘tree_cmp’</strong></p>
</div>
</section>
<section id="scanning-phylogenetic-trees">
<h5>Scanning phylogenetic trees<a class="headerlink" href="#scanning-phylogenetic-trees" title="Permalink to this heading"></a></h5>
<p>It is possible to scan an alignment and locally measure the similarity between an estimated local tree and some reference tree provided from an external source (or computed on the fly) using the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$# : t_coffee -other_pg seq_reformat -in sample_seq1.aln -in2 sample_seq1_tree.nwk -action \
     +tree_scan _MODE_scan__W_10_ &gt; ph_tree_scan.txt
</pre></div>
</div>
<p>For each position of the alignment, W*2 blocks of size 2*1+1 up to W*2+1 will be extracted, for each of these block a tree will be estimated and the similarity of that tree with the reference tree will be estimated with cmp_tree. For each position, the tree giving the best fit will be reported, along with the size of the block leading to that tree:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">P</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">position</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">block</span> <span class="n">start</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">block_end</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">block</span> <span class="n">score</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">block</span> <span class="n">Length</span><span class="o">&gt;</span>
</pre></div>
</div>
</section>
<section id="pruning-phylogenetic-trees">
<h5>Pruning phylogenetic trees<a class="headerlink" href="#pruning-phylogenetic-trees" title="Permalink to this heading"></a></h5>
<p>Pruning removes leaves from an existing tree and recomputes distances so that no information is lost. To do this with T-Coffee you need two input files: a tree file in the Newick format and a FASTA-like file where sequences can be omitted, but you can also leave them, at your entire convenience. The second file is merely a list of the sequences to be kept when pruning the tree. The resulting tree will contain only the sequences specified in the list.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Tree file: &quot;sample_3Dseq1.tree&quot;
((((TNFR10-2:0.04546,TNFR16-2:0.06640)...,TNFR4-2:0.05255) 45:0.00848); \

FASTA-like file: &quot;sample_3Dseq1.fake&quot;
&gt;TNFR2-2
&gt;TNFR4-4
...

Pruning the tree:
$$: t_coffee -other_pg seq_reformat -in sample_3Dseq1.tree -in2 sample_3Dseq1.fasta -action \
    +tree_prune -output newick
</pre></div>
</div>
</section>
<section id="tree-reformatting-for-mafft">
<h5>Tree Reformatting for MAFFT<a class="headerlink" href="#tree-reformatting-for-mafft" title="Permalink to this heading"></a></h5>
<p>The most common format for phylogenetic trees is newick, but some alternatives exist, including the one used by MAFFT for very large trees, in which the sequence names are replaced by their original index (1..N) in the sequence file. Seq_reformat can be used to cross convert these two formats:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee -other_pg seq_reformat -in sample_3Dseq1.tree -in2 sample_3Dseq1.fasta -action +newick2mafftnewick
</pre></div>
</div>
<p>And the reverse operation when processing a mafft guide tree</p>
<dl class="simple">
<dt>::</dt><dd><p>$$: t_coffee -other_pg seq_reformat -in sample_3Dseq1.mafftnewick -in2 sample_3Dseq1.fasta -action +mafftnewick2newick</p>
</dd>
</dl>
</section>
</section>
<section id="manipulating-structure-files-pdb">
<h4>Manipulating structure files (PDB)<a class="headerlink" href="#manipulating-structure-files-pdb" title="Permalink to this heading"></a></h4>
<section id="extracting-a-structure">
<h5>Extracting a structure<a class="headerlink" href="#extracting-a-structure" title="Permalink to this heading"></a></h5>
<p>There are many reasons why you may need a structure. T-Coffee contains a powerful utility named <strong>extract_from_pdb</strong> that makes it possible to fetch the PDB coordinates of a structure or its FASTA sequence without requiring a local installation. By default, the option <strong>extract_from_pdb will</strong> start looking for the structure in the current directory; it will then look it up locally (PDB_DIR) and eventually try to fetch it from the web (via a wget to the <a class="reference external" href="http://www.rcsb.org">PDB</a>). All these settings can be customized using environment variables (see next paragraph). For instance if you want to fetch the chain E of the PDB structure 1PPG and/or its sequence in FASTA format, you can use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Fetch the structure:
$$: t_coffee -other_pg extract_from_pdb -infile 1PPGE

Fetch the correpsonding sequence:
$$: t_coffee -other_pg extract_from_pdb -infile 1PPGE -fasta
</pre></div>
</div>
</section>
<section id="adapting-extract-from-pdb-to-your-own-environment">
<h5>Adapting extract_from_pdb to your own environment<a class="headerlink" href="#adapting-extract-from-pdb-to-your-own-environment" title="Permalink to this heading"></a></h5>
<p>If you have the PDB installed locally, simply set the variable PDB_DIR to the absolute location of the directory in which the PDB is installed. The PDB can either be installed in its divided form or in its full form. If the file you are looking for is neither in the current directory nor in the local PDB version, extract_from_pdb will try to fetch it from rcsb. If you do not want this to happen, you should either set the environment variable NO_REMOTE_PDB_DIR to 1 or use the <strong>-no_remote_pdb_dir</strong> flag:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Setting up the environment:
##: export NO_REMOTE_PDB_FILE=1

Running PDB extract:
$$: t_coffee -other_pg extract_from_pdb -infile 1PPGE -fasta -no_remote_pdb_file
</pre></div>
</div>
<p>By default, T-Coffee also requires two important PDB files declared using the two following variables. These variables do not need to be set if the considered files are in the cache directory (default behavior):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">##: export PDB_ENTRY_TYPE_FILE=&lt;location of the file pdb_entry_type.txt&gt;</span>
<span class="p">(</span><span class="n">Found</span> <span class="n">at</span><span class="p">:</span> <span class="n">ftp</span><span class="p">:</span><span class="o">//</span><span class="n">ftp</span><span class="o">.</span><span class="n">wwpdb</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">pub</span><span class="o">/</span><span class="n">pdb</span><span class="o">/</span><span class="n">derived_data</span><span class="o">/</span><span class="n">pdb_entry_type</span><span class="o">.</span><span class="n">txt</span><span class="p">)</span>
<span class="ow">and</span>
<span class="c1">##: export PDB_UNREALEASED_FILE=&lt;location of the file unrealeased.xml&gt;</span>
<span class="p">(</span><span class="n">Found</span> <span class="n">at</span><span class="p">:</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">rcsb</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">pdb</span><span class="o">/</span><span class="n">rest</span><span class="o">/</span><span class="n">getUnreleased</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Since the file <code class="docutils literal notranslate"><span class="pre">unreleased.xml</span></code> is not part of the PDB distribution, T-Coffee will make an attempt to obtain it even when using the NO_REMOTE_PDB_DIR=1 mode. You must therefore make sure that the file PDB_UNREALEASED_FILE is pointing to is read and write.</p>
</div>
</section>
</section>
</section>
<section id="aligning-your-sequences">
<h3>Aligning Your Sequences<a class="headerlink" href="#aligning-your-sequences" title="Permalink to this heading"></a></h3>
<section id="general-comments-on-alignments-and-aligners">
<h4>General comments on alignments and aligners<a class="headerlink" href="#general-comments-on-alignments-and-aligners" title="Permalink to this heading"></a></h4>
<section id="what-is-a-good-alignment">
<h5>What is a good alignment?<a class="headerlink" href="#what-is-a-good-alignment" title="Permalink to this heading"></a></h5>
<p>This is a tricky question, a good answer would be  <strong>“a good alignment is an alignment that makes it possible to do good biology”</strong>. In practice, the alignment community has become used to measuring the accuracy of alignment methods using structures. Structures are relatively easy to align correctly, even when the sequences have diverged quite a lot. The most common usage is therefore to compare structure based alignments with their sequence based counterpart and to evaluate the accuracy of the method using these criterions. Unfortunately it is not easy to establish structure based standards of truth. Several of these exist and they do not necessarily agree. To summarize, the situation is as roughly as follows:</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>Above 40% identity</strong>, all the reference collections do agree with one another and all the established methods give roughly the same results. These alignments can be trusted blindly.</p></li>
<li><p><strong>Below 40% identity</strong>, all the reference collections stop agreeing and the methods do not give consistent results. In this area of similarity it is not necessarily easy to determine who is right and who is wrong, although most studies indicate that consistency based methods (T-Coffee, ProbCons, MAFFT-slow or MSAProbs) have an edge over traditional methods.</p></li>
</ul>
</div></blockquote>
<p>When dealing with distantly related sequences, the only way to produce reliable alignments is to use structural information. T-Coffee provides many facilities to do so in a seamless fashion. Several important factors need to be taken into account when selecting an alignment method:</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>The best methods are not always the best</strong>. Given a difficult dataset, the best method is only more likely to deliver the best alignment, but there is no guaranty it will do so. It is very much like betting on the horse with the best odds.</p></li>
<li><p><strong>The difference in accuracy between all the available methods is not incredibly high</strong> (as measured on reference datasets). It is unclear whether this is an artifact caused by the use of ‘easy’ reference alignments, or whether this is a reality. The only thing that can change dramatically the accuracy of the alignment is the use of structural information.</p></li>
<li><p><strong>Keep in mind that these methods have only been evaluated by comparison with reference alignments (benchmarks)</strong>. This is merely one criterion among many. In theory, these methods should be evaluated for their ability to produce alignments that lead to accurate trees, good profiles or good models. Unfortunately, these evaluation procedures do not yet exist.</p></li>
</ul>
</div></blockquote>
</section>
<section id="the-main-methods-and-their-scope">
<h5>The main methods and their scope<a class="headerlink" href="#the-main-methods-and-their-scope" title="Permalink to this heading"></a></h5>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There are many MSA packages around, the most common ones being ClustalW, MUSCLE, MAFFT, T-Coffee and ProbCons; amongst the latest ones, you can find phylogeny aware aligners (PRANK and SATé) and modifed/improved consistency based aligners (MSAProbs). You can almost forget about the other packages, as there is virtually nothing you could do with them that you will not be able to do with these packages. All these packages offer a complex trade-off between speed, accuracy and versatility.</p>
</div>
<section id="clustalw-is-really-everywhere">
<h6>ClustalW is really everywhere…<a class="headerlink" href="#clustalw-is-really-everywhere" title="Permalink to this heading"></a></h6>
<p>ClustalW is still the most widely used Multiple Sequence Alignment package. Yet things are changing fast and different tests have consistently shown that ClustalW is neither the most accurate nor the fastest package around. This being said, ClustalW is everywhere and if your sequences are similar enough, it should deliver a fairly reasonable alignment.</p>
</section>
<section id="mafft-muscle-to-align-big-datasets">
<h6>MAFFT/MUSCLE to align big datasets<a class="headerlink" href="#mafft-muscle-to-align-big-datasets" title="Permalink to this heading"></a></h6>
<p>If you have many sequences to align MUSCLE or MAFFT are the obvious choice. MAFFT is often described as the fastest and the most efficient. This is not entirely true, in its fast mode (FFT-NS-1), MAFFT is similar to MUSCLE and although it is fairly accurate, about 5 points less accurate than the consistency based packages (ProbCons and T-Coffee). In its most accurate mode (L-INS-i) MAFFT uses local alignments and consistency, however, it becomes much more accurate but also slower, and more sensitive to the number of sequences. More recently, we have seen growing the number of <strong>(ultra) large scale</strong> aligners such as Clustal Omega, PASTA, UPP, and we hope soon the large scale version of T-Coffee (called MEGA-Coffee).</p>
<dl class="simple">
<dt><strong>Suitable for</strong>:</dt><dd><ul class="simple">
<li><p>Distance-based phylogenetic reconstruction (NJ trees)</p></li>
<li><p>Secondary structure prediction</p></li>
</ul>
</dd>
<dt><strong>Not suitable for</strong>:</dt><dd><ul class="simple">
<li><p>Profile construction</p></li>
<li><p>Structure modeling</p></li>
<li><p>3D prediction</p></li>
<li><p>Function analysis</p></li>
</ul>
</dd>
</dl>
</section>
<section id="t-coffee-probcons-slow-but-accurate">
<h6>T-Coffee/ProbCons, slow but accurate !!!<a class="headerlink" href="#t-coffee-probcons-slow-but-accurate" title="Permalink to this heading"></a></h6>
<p>T-Coffee works by first assembling a library and then by turning this library into an alignment. The library is a list of potential pairs of residues. All of them are not compatible and the job of the algorithm is to make sure that as many possible constraints as possible find their way into the final alignment: it is very much like trying to choose a meeting date, and each one says something like ‘I need my Monday morning’, ‘I can’t come on Thursday afternoon’, and so on. In the end you want a schedule that makes everybody happy, if possible. The nice thing about the library is that it can be used as a media to combine as many methods as one wishes. It is just a matter of generating the right constraints with the right method and compile them into the library. ProbCons and MAFFT (L-INS-i) uses a similar algorithm, but with a Bayesian twist in the case of ProbCons. In practice, however, ProbCons and T-Coffee give very similar results and have similar running time. MAFFT is significantly faster.</p>
<dl class="simple">
<dt><strong>Suited for</strong>:</dt><dd><ul class="simple">
<li><p>Profile reconstruction</p></li>
<li><p>Structure modeling</p></li>
<li><p>Function analysis</p></li>
<li><p>3D prediction</p></li>
</ul>
</dd>
</dl>
</section>
</section>
<section id="choosing-the-right-package-without-flipping-a-coin">
<h5>Choosing the right package (without flipping a coin !)<a class="headerlink" href="#choosing-the-right-package-without-flipping-a-coin" title="Permalink to this heading"></a></h5>
<p>Each available package has something to go for it, it is just a matter of knowing what you want to do !! T-Coffee is probably the most versatile, but it comes at a price, its default aligner being currently slower than many alternative packages. In the rest of this tutorial we give some hints on how to carry out each of these applications within the T-Coffee framework.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Packages</p></th>
<th class="head"><p>MUSCLE</p></th>
<th class="head"><p>MAFFT</p></th>
<th class="head"><p>ProbCons</p></th>
<th class="head"><p>T-Coffee</p></th>
<th class="head"><p>ClustalW</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Accuracy</p></td>
<td><p>++</p></td>
<td><p>+++</p></td>
<td><p>+++</p></td>
<td><p>+++</p></td>
<td><p>+</p></td>
</tr>
<tr class="row-odd"><td><p>&lt;100 Seq.</p></td>
<td><p>++</p></td>
<td><p>++</p></td>
<td><p>+++</p></td>
<td><p>+++</p></td>
<td><p>+</p></td>
</tr>
<tr class="row-even"><td><p>&gt;100 Seq.</p></td>
<td><p>+++</p></td>
<td><p>+++</p></td>
<td><p>-</p></td>
<td><p>+</p></td>
<td><p>+</p></td>
</tr>
<tr class="row-odd"><td><p>Remote Homologues</p></td>
<td><p>++</p></td>
<td><p>+++</p></td>
<td><p>+++</p></td>
<td><p>+++</p></td>
<td><p>+</p></td>
</tr>
<tr class="row-even"><td><p>MSA vs Seq.</p></td>
<td><p>-</p></td>
<td><p>-</p></td>
<td><p>+++</p></td>
<td><p>+++</p></td>
<td><p>+++</p></td>
</tr>
<tr class="row-odd"><td><p>MSA vs MSA</p></td>
<td><p>-</p></td>
<td><p>-</p></td>
<td><p>-</p></td>
<td><p>+++</p></td>
<td><p>+++</p></td>
</tr>
<tr class="row-even"><td><p>&gt;2 MSAs</p></td>
<td><p>-</p></td>
<td><p>-</p></td>
<td><p>-</p></td>
<td><p>+++</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Seq. vs Struc.</p></td>
<td><p>-</p></td>
<td><p>-</p></td>
<td><p>-</p></td>
<td><p>+++</p></td>
<td><p>+</p></td>
</tr>
<tr class="row-even"><td><p>Splicing Var.</p></td>
<td><p>-</p></td>
<td><p>+++</p></td>
<td><p>-</p></td>
<td><p>+++</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p>Reformat</p></td>
<td><p>-</p></td>
<td><p>-</p></td>
<td><p>-</p></td>
<td><p>+++</p></td>
<td><p>++</p></td>
</tr>
<tr class="row-even"><td><p>Phylogeny</p></td>
<td><p>-</p></td>
<td><p>-</p></td>
<td><p>-</p></td>
<td><p>+</p></td>
<td><p>++</p></td>
</tr>
<tr class="row-odd"><td><p>Evaluation</p></td>
<td><p>-</p></td>
<td><p>-</p></td>
<td><p>+</p></td>
<td><p>+++</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p>Speed</p></td>
<td><p>+++</p></td>
<td><p>+++</p></td>
<td><p>+</p></td>
<td><p>+</p></td>
<td><p>++</p></td>
</tr>
</tbody>
</table>
<p>Table 1. Relative possibilities associated with the main packages. In any of the situations corresponding to each table line, (+++) indicates that the method is the best suited, (++) indicates that the method is not optimal but behaves reasonably well, (+) indicates that it is possible but not recommended (-) indicates that the option is not available.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Packages</p></th>
<th class="head"><p>MUSCLE</p></th>
<th class="head"><p>MAFFT</p></th>
<th class="head"><p>ProbCons</p></th>
<th class="head"><p>T-Coffee</p></th>
<th class="head"><p>ClustalW</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Dist Based Phylogeny</p></td>
<td><p>+++</p></td>
<td><p>+++</p></td>
<td><p>++</p></td>
<td><p>++</p></td>
<td><p>++</p></td>
</tr>
<tr class="row-odd"><td><p>ML or MP Phylogeny</p></td>
<td><p>++</p></td>
<td><p>+++</p></td>
<td><p>+++</p></td>
<td><p>+++</p></td>
<td><p>++</p></td>
</tr>
<tr class="row-even"><td><p>Profile Construction</p></td>
<td><p>++</p></td>
<td><p>+++</p></td>
<td><p>+++</p></td>
<td><p>+++</p></td>
<td><p>++</p></td>
</tr>
<tr class="row-odd"><td><p>3D Modeling</p></td>
<td><p>++</p></td>
<td><p>++</p></td>
<td><p>++</p></td>
<td><p>+++</p></td>
<td><p>+</p></td>
</tr>
<tr class="row-even"><td><p>2D Predictions</p></td>
<td><p>+++</p></td>
<td><p>+++</p></td>
<td><p>++</p></td>
<td><p>++</p></td>
<td><p>++</p></td>
</tr>
</tbody>
</table>
<p>Table 2. Most Suitable Appplications of each package. In any of the situations corresponding to each table line, (+++) indicates that the method is the best suited, (++) indicates that the method is not optimal but behaves reasonably well, (+) indicates that it is possible but not recommended (-) indicates that the option is not available.</p>
</section>
</section>
<section id="protein-sequences">
<h4>Protein Sequences<a class="headerlink" href="#protein-sequences" title="Permalink to this heading"></a></h4>
<section id="general-considerations">
<h5>General considerations<a class="headerlink" href="#general-considerations" title="Permalink to this heading"></a></h5>
<p>T-Coffee aligner is by default parallelized, meaning that it can use multiple cores when running on a cluster or a computer. By default, T-Coffee will use all available processors to run, but you can parallelize the differents steps and allocate the number of cores you want with the flag <strong>-multi_core</strong> or <strong>n_core</strong>. For more details, refer to the chapter <strong>T-Coffee Technical Documentation</strong>, subsection <strong>CPU control</strong>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Using a single core:
$$: t_coffee -in sample_seq1.fasta -multi_core=msa

Using 12 cores:
$$: t_coffee -in sample_seq1.fasta -n_core=12
</pre></div>
</div>
<p>Also when running T-Coffee, it displays a lot of information directly on screening while running from general information, options, results, warnings…if you want, you can reduce the display using <strong>-no_warning</strong> to remove all the warnings, or even more strict using <strong>-quiet</strong> removing any display while running T-Coffee.</p>
</section>
<section id="computing-a-simple-msa-default-t-coffee">
<h5>Computing a simple MSA (default T-Coffee)<a class="headerlink" href="#computing-a-simple-msa-default-t-coffee" title="Permalink to this heading"></a></h5>
<p>T-Coffee default mode will simply compute a Multiple Sequence Alignment of the sequences you provided in input (command 1). It will display the final MSA on the screen and in several files according to the format you asked with command 2 (by default, the MSA is stored in a file .aln in ClustalW format). The headline of the alignment file contains important information such as the version of T-Coffee used, the CPU time, the overall consistency score (normalized to 100 or 1000 depending on the version of T-Coffee) and the total length of the MSA: it is quite practical to have a quick glance at the result.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Command 1: default MSA
$$: t_coffee proteases_small.fasta

Command 2: default MSA, multiple output files
$$: t_coffee proteases_small.fasta -output=clustalw,fasta_aln,msf
</pre></div>
</div>
<p>Each time you run T-Coffee, 3 files are always generated:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">proteases_small.aln</span></code>: the alignment in ClustalW format</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">proteases_small.dnd</span></code>: the guide tree in Newick format</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">proteases_small.html</span></code>: the colored MSA in html format</p></li>
</ul>
</div></blockquote>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The guide tree is not a phylogenetic tree, it is used in the alignment process for clustering the sequences.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>You can visualize the colored html file with any browser/software you prefer. The display of the sequences should be aligned and formatted; if not, use another browser, it works quite well with Firefox, Safari, etc… If you need to do more sophisticated modifications on your MSA, we recommend to use <a class="reference external" href="http://www.jalview.org/">Jalview</a> which incorporate the T-Coffee color scheme.</p>
</div>
</section>
<section id="aligning-multiple-datasets-combining-multiple-msas">
<h5>Aligning multiple datasets/Combining multiple MSAs<a class="headerlink" href="#aligning-multiple-datasets-combining-multiple-msas" title="Permalink to this heading"></a></h5>
<p>If your sequences are spread across several datasets, you can give all the files you want (the limit is 200) via the flag <strong>-seq</strong>, and in any format you want. Just know that 1) if you give an alignment, the gaps will be reset and your alignment will only provide sequences, 2) sequences with the same name between two files are assumed to be the same sequence, 3) ff their sequences differ, they will be aligned and replaced by the consensus of that alignment (process known as sequence reconciliation). To align multiple datasets:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee -seq=proteases1_small.fasta,proteases2_small.aln -output=clustalw,fasta_aln,msf
</pre></div>
</div>
<p>You may also have a bunch of alignments (with the same sequences) that you have either precomputed, assembled manually or received from a colleague. You can also combine these alignments. For instance, let us imagine we generated 4 alignments with ClustalW using different gap penalties. To combine them into ONE single alignment, use the <strong>-aln</strong> flag. The final score indicates a high level of consistency (91%) between all these MSAs, meaning that the final MSA is probably correct.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Your 4 different MSAs:
##: clustalw -infile=proteases_small.fasta -gapopen=0 -outfile=g0.aln
##: clustalw -infile=proteases_small.fasta -gapopen=-5 -outfile=g5.aln
##: clustalw -infile=proteases_small.fasta -gapopen=-10 -outfile=g10.aln
##: clustalw -infile=proteases_small.fasta -gapopen=-15 -outfile=g15.aln

Combining multiple MSAs:
$$: t_coffee proteases_small.fasta -aln g0.aln g5.aln g10.aln g15.aln -output=clustalw,html
</pre></div>
</div>
</section>
<section id="estimating-the-diversity-in-your-alignment">
<h5>Estimating the diversity in your alignment<a class="headerlink" href="#estimating-the-diversity-in-your-alignment" title="Permalink to this heading"></a></h5>
<p>It is easy to measure the level of diversity within your MSA with the <strong>-output</strong> option of <strong>seq_reformat</strong>, it will output all the pairwise identities, as well as the average level of identity between each sequence and the others. There are two possibilities given that your input are unaligned sequences or not: <strong>-output sim_idscore</strong> realign your sequences pairwise so it can accept unaligned or aligned sequences alike; <strong>-output sim</strong> computes the identity using the sequences as they are in your input file so it is only suited for MSAs. You can after redirect, sort and grep the output in order to select the sequences you are interested in.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee -other_pg seq_reformat -in sample_seq1.aln -output sim
</pre></div>
</div>
</section>
<section id="comparing-alternative-alignments">
<h5>Comparing alternative alignments<a class="headerlink" href="#comparing-alternative-alignments" title="Permalink to this heading"></a></h5>
<p>If you change the parameters, you will end up with alternative alignments. It can be interesting to compare them quantitatively. T-Coffee comes along with an alignment comparison module named <strong>aln_compare</strong>. You can use it to estimate the amount of difference between your two alignments either using the Sum-of-Pair score or the column score using the flag <strong>-compare_mode</strong> (sp or column). By default aln_compare returns the SoP score:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee -other_pg aln_compare -al1 b80.aln -al2 b30.aln -compare_mode sp
</pre></div>
</div>
<p>This comparison will return the following result:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">*****************************************************</span>
<span class="n">seq1</span>       <span class="n">seq2</span>          <span class="n">Sim</span>   <span class="p">[</span><span class="n">ALL</span><span class="p">]</span>           <span class="n">Tot</span>
<span class="n">b80</span>           <span class="mi">19</span>         <span class="mf">33.6</span>    <span class="mf">94.2</span> <span class="p">[</span><span class="mf">100.0</span><span class="p">]</span>   <span class="p">[</span><span class="mi">79686</span><span class="p">]</span>
</pre></div>
</div>
<p>The interpretation of this output is as follow: b80 is the reference MSA, it contains 19 sequences with an average identity of 33.6%, and is 94.2% identical to the second MSA b30.aln (79686 pairs to be precise). Of course, this does not tell you where are the good bits, but you can get this information for instance residues that have lost more than 50% of their pairing partner between the two alignments are in lower case (command 1) or converted in any character you want (command 2).
The sp score is defined as the number of aligned residue pairs (i.e. not gaps) that are common between the reference (-al1) and the test (-al2) divided by the total numbers of pairs in the reference, while excluding gaps.</p>
<p>Other modes of comparison are available including the TC score</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee -other_pg aln_compare -al1 b80.aln -al2 b30.aln -compare_mode tc
</pre></div>
</div>
<p>The tc score is defined as the number of columns in the test MSA (-al2)  that are common between the reference and the test, divided by the total number of columns in the reference. This measure, originally reported in Balibase can be problematic as it treats equaly highly and sparcely populated columns. For this reason the</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee -other_pg aln_compare -al1 b80.aln -al2 b30.aln -compare_mode column
</pre></div>
</div>
<p>The column score is defined as the total number pairs occuring in columns entirely identical between the reference (-al1) and the test (-al2) divided by the total number of pairs in the reference (excluding gaps). This makes the column score the equivalent of a weighted TC score.</p>
<p>It is also possible to print out the conserved positions between MSAs using the following commands.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Command 1:
$$: t_coffee -other_pg aln_compare -al1 b30.aln -al2 p350.aln -output_aln \
    -output_aln_threshold 50

Command 2:
$$: t_coffee -other_pg aln_compare -al1 b30.aln -al2 p350.aln -output_aln \
    -output_aln_threshold 50 -output_aln_modif x
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is important to take into account that the comparison between -al1 and -al2 is not symetrical. It returns the fraction of -al1 residues pairs - by index - that are recovered in -al2. If -al1 is the reference alignment, this number is more or less the equivalent of a sensistivity measure (i.e. how much True positives are recovered). If -al1 is the tartget alignment, this measure becomes the equivalent of a specificity measure (i.e. what is the fraction of residue pairs in the target that are part of the reference).</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>aln_compare is particularly interesting if you are modifying the default parameters of T-Coffee and want to monitor the effects of your modifications.</p>
</div>
</section>
<section id="comparing-subsets-of-alternative-alignments">
<h5>Comparing subsets of alternative alignments<a class="headerlink" href="#comparing-subsets-of-alternative-alignments" title="Permalink to this heading"></a></h5>
<p>It is also possible to restrict the comparison to a specific subset of residues within the target alignment (for instance the core residues if using a structural reference, or the catalytic residues if using functional annotation alignment). This requires a cache in which residues are annotated as being part of the core or not. The cache is a plain text ascii file that can be produced in any way convenient to you. We show below how to produce a cache based on the consistency score and how to use this cache for further comparisons.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee b11.fa -output aln score_ascii
</pre></div>
</div>
<p>This command generates two output files</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">b11.aln</span></code>: the alignment in ClustalW format</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">b11.score_ascii</span></code>: a local reliability score with every residue having a score between 0 and 9</p></li>
</ul>
</div></blockquote>
<p>The target file must then be reformatted so as to decide which residues will be part of the evaluation (c=&gt; core) and which ones will be ignored. In this example we will set the threshild at 7 which means that the comparison will ignore all residues that do not have 70% or more support from the T-Coffee library:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee -other_pg seq_reformat -in b11.score_ascii -input number_aln -action +convert 0123456i 789c -output fasta_seq &gt; b11.cache
</pre></div>
</div>
<p>One can then produce a target file with another method</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee b11.fa -method mafft_pair -outfile b11.tcmafft
</pre></div>
</div>
<p>With the cache, it is then possible to compare the original alignment (b11.aln) while only considering pairs of core residues</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee -other_pg aln_compare -al1 b11.aln -al2 b11.tcmafft -st b11.cache pep -io_cat &#39;[c][c]=[core]&#39;
</pre></div>
</div>
<p>This comparison will return the following result:</p>
<dl class="simple">
<dt>::</dt><dd><p>seq1       seq2          Sim   [core]          Tot
b11           11         32.8    99.5 [ 63.6]   [26044]</p>
</dd>
</dl>
<p>The output can be interpreted as follows: the core residues - defined as c-c pairs constitute 63.6% of the -al1 alignment. 93.5% of these pairs are recovered in the -al2 alignment. Note that the -io_cat makes it possible to declare as many categories and combinations of categories as one wishes to have. For instance:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee -other_pg aln_compare -al1 b11.aln -al2 b11.tcmafft -st b11.cache pep\
     -io_cat &#39;[c][c]=[core];[c][i]=[mixed];[ci][ci]=[all1];[*][*]=[all2]&#39;
</pre></div>
</div>
</section>
<section id="modifying-the-default-parameters-of-t-coffee">
<h5>Modifying the default parameters of T-Coffee<a class="headerlink" href="#modifying-the-default-parameters-of-t-coffee" title="Permalink to this heading"></a></h5>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The main parameters of T-Coffee are similar to those of ClustalW, including a substitution matrix and some gap penalties. In general, T-Coffee’s default is adequate. If, however, you are not satisfied with the default parameters, we encourage you to change the following parameters. Interestingly, most of what we say here holds reasonably well for ClustalW.</p>
</div>
<section id="can-you-guess-the-optimal-parameters">
<h6>Can you guess the optimal parameters?<a class="headerlink" href="#can-you-guess-the-optimal-parameters" title="Permalink to this heading"></a></h6>
<p>Here is another tricky question…and the general answer is NO. The matrix and the gap penalties are simplistic attempts at modeling evolution. While the matrices do a reasonable job, the penalties are simply inappropriate: they should have a value that depends on the structure of the protein and a uniform value cannot be good enough. Yet, since we do not have better we must use them…In practice, this means that parameter optimality is a very <em>ad hoc</em> business. It will change from one dataset to the next and there is no simple way to predict which matrix and which penalty will do better. The problem is also that even after your alignment has been computed, it is not always easy to tell whether your new parameters have improved or degraded your MSA.</p>
<p>There is no systematic way to evaluate an MSA. In general, people visually evaluate the alignment, count the number of identical columns and consider that one more conserved column is good news. If you are lucky you may know a few functional features that you expect to see aligned. If you are very lucky, you will have one structure and you can check the gaps fall in the loops. If you are extremely lucky, you will have two structures and you can assess the quality of your MSA. An advantage of T-Coffee is the fact that the overall score of the alignment (i.e. the consistency with the library) is correlated with the overall accuracy. In other words, if you alignment score increases, its accuracy probably increases also. All this being said, consistency is merely an empirical way of estimating the change of parameters and it does not have the predictive power of a BLAST E-Value.</p>
</section>
<section id="changing-the-substitution-matrix">
<h6>Changing the substitution matrix<a class="headerlink" href="#changing-the-substitution-matrix" title="Permalink to this heading"></a></h6>
<p>T-Coffee only uses the substitution matrix to make the pairwise alignments that go into the library. These are all the global alignments of every possible pair of sequences, and the ten best local alignments associated with every pair of sequences.</p>
<blockquote>
<div><ul class="simple">
<li><p>By default, these alignments are computed using a Blosum62 matrix, but you can use any matrix you fancy instead, including: pam120mt, pam160mt, pam250mt, pam350mt, blosum30mt, blosum40mt, blosum45mt, blosum50mt, blosum55mt, blosum62mt, blosum80mt, or even user-provided matrices in the BLAST format (see <strong>T-Coffee Technical Documentation</strong>).</p></li>
<li><p>PAM matrices: These matrices are allegedly less accurate than the Blosum. The index is correlated to the evolutionary distances, you should therefore use the pam350mt to align very distantly related sequences.</p></li>
<li><p>Blosum matrices: These matrices are allegedly the most accurate. The index is correlated to the maximum percent identity within the sequences used to estimate the matrix. you should therefore use the blosum30mt to align very distantly related sequences. Blosum matrices are biased toward protein core regions, explaining why these matrices tend to give better alignments, since by design, they can capture the most evolutionary resilient signal contained in proteins.</p></li>
</ul>
</div></blockquote>
<p>Unless you have some structural information available, the only way to tell whether your alignment has improved or not is to look at the score. For instance, if you compute the two following alignments:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee proteases_small.fasta -matrix=blosum30mt -outfile=b30.aln
$$: t_coffee proteases_small.fasta -matrix=blosum80mt -outfile=b80.aln
</pre></div>
</div>
<p>You will get two alignments that have roughly the same score but are slightly different. You can still use these two alternative alignments by comparing them to identify regions that have been aligned identically by the two matrices. These regions are usually more trustworthy.</p>
</section>
<section id="changing-gap-penalties">
<h6>Changing gap penalties<a class="headerlink" href="#changing-gap-penalties" title="Permalink to this heading"></a></h6>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Gap penalties are the core of the matter when it comes to MSAs. An interesting feature of T-Coffee is that it does not really need such penalties when assembling the MSA, because in theory the penalties have already been applied when computing the library. This is the theory, as in practice penalties can help improve the quality of the alignment.</p>
</div>
<p>The penalties can be changed via the flags <strong>-gapopen</strong> for the gap opening penalty and via <strong>-gapext</strong> for the gap extension penalty. The range for gapopen are [-500,-5000], the range for the extension should rather be [-1,-10]. These values do not refer to a substitution matrix, but rather to the values range of the consistency estimation (i.e. ratio) normalized to 10000 for a maximum consistency. The default values are <strong>-gapopen=-50, -gapext=0</strong>. The reasons for these very low values are that they are meant to be cosmetic only, since a trademark of T-Coffee (inherited from Dialign) is not to need explicit penalties. Yet, we know for a fact that alignments with higher gap penalties often look nicer (for publications) and are sometimes more accurate. For instance, you can try:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee proteases_small.fasta -gapopen -100 -gapext -5
</pre></div>
</div>
<p>This gap penalty is only applied at the alignment level (i.e. after the library was computed). If you want to change the gap penalties of the methods used to build the library, you will need to go deeper…Two methods are used by default to build the library (command 1). One does global pairwise alignments and is named slow_pair, the other is named lalign_id_pair and produces local alignments. These methods are specified via the <strong>-method</strong> flag. Usually you do not need to write it because it is the default, but if you want to change the default parameters of the constituting methods (command 2), you will need to do so explicitly (the default parameters are for lalign_id_pair <strong>GOP=-10, GEP=-4, MATRIX=blosum50mt</strong> and for slow_pair <strong>GOP=-10, GEP=-1 and MATRIX=blosum62mt</strong>. Using the command 2, the library is now computed using the Blosum62mt with lalign, rather than the Blosum50mt; the good news is that when using this matrix, the score of our alignment increases from 48 to 50. We assume this new alignment is therefore more accurate than the previous one.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Command 1: default T-Coffee
$$: t_coffee proteases_small.fasta -method=lalign_id_pair,slow_pair

Command 2: modifiying the parameters
$$: t_coffee proteases_small.fasta -method lalign_id_pair@EP@MATRIX@blosum62mt, \
    slow_pair -outfile proteases_small.b62_aln
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>It only makes sense to compare the consistency score of alternative alignments when these alignments have been computed using the same methods (lalign_id_pair and slow_pair for instance).</p>
</div>
</section>
<section id="aligning-very-large-datasets">
<h6>Aligning (very) large datasets<a class="headerlink" href="#aligning-very-large-datasets" title="Permalink to this heading"></a></h6>
<p>The consistency based default method is not really suited for more that 200 sequences. Above this number, it is recommanded to use the <a class="reference external" href="http://www.tcoffee.org/Projects/tcoffee/documentation/index.html#document-tcoffee_quickstart_regressive">regressive agorithm implemented in T-Coffee</a>.</p>
</section>
</section>
</section>
<section id="protein-sequences-using-2d-and-or-3d-information">
<h4>Protein sequences using 2D and/or 3D information<a class="headerlink" href="#protein-sequences-using-2d-and-or-3d-information" title="Permalink to this heading"></a></h4>
<p>Using structural information when aligning sequences is very useful. The reason is that structures diverge slower than sequences. As a consequence, one may still find a discernable homology between two sequences that have been diverging for a long time beyond recognition using their corresponding structure. Yet, when assembling a structure based MSA, you will realize that these sequences contain key conserved residues that a simple alignment procedure was unable to reveal. We show you in this section how to make the best of T-Coffee tools to incorporate structural information in your alignment.</p>
<section id="using-3d-structures-expresso-3d-coffee">
<h5>Using 3D structures: Expresso/3D-Coffee<a class="headerlink" href="#using-3d-structures-expresso-3d-coffee" title="Permalink to this heading"></a></h5>
<section id="requirements-to-run-expresso-3d-coffee">
<h6>Requirements to run Expresso/3D-Coffee<a class="headerlink" href="#requirements-to-run-expresso-3d-coffee" title="Permalink to this heading"></a></h6>
<p>Expresso needs BLAST you provide with the tag <strong>-blast</strong> and it also requires the PDB database you can specify via the flag <strong>-pdb_db</strong>. The good news is that it is not mandatory to have BLAST or the PDB installed locally as T-Coffee can automatically fetch the structures directly from RCSB (the home of PDB) using EBI BLAST web service.</p>
</section>
<section id="how-does-expresso-3d-coffee-work">
<h6>How does Expresso/3D-Coffee work?<a class="headerlink" href="#how-does-expresso-3d-coffee-work" title="Permalink to this heading"></a></h6>
<p>Expresso/3D-Coffee is probably one of the most important improvement of T-Coffee. The principle is simple: 1) it first runs a BLAST for every sequence in your dataset against the PDB and finds (or not) a structure similar in sequence (35% identity by default) to be used as a template for structurally aligning your sequence, 2) the correspondence between the query sequences and the templates are stored in a template file which is automatically generated by Expresso. Here lies the difference between 3D-Coffee and Expresso: when running Expresso, fetching structures and creating the template file are automated (so you can reuse it for other applications) while using 3D-Coffee is a bit more tricky as it requires the name of the sequences to correspond to the structure file name (and it does not fetch or create anything for you). Of course, you can create and use your own template with the tag <strong>-template_file</strong> with the same format presented here. At the end, whenever there are enough templates (minimum of two obviously), it will align sequences using the structural information, otherwise sequences will be aligned using the standard T-Coffee aligner.  Of course, if your dataset only contains structures, your alignment becomes a structural alignment.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span><span class="n">sp</span><span class="o">|</span><span class="n">P08246</span><span class="o">|</span><span class="n">ELNE_HUMAN</span>  <span class="n">_P_</span> <span class="mi">1</span><span class="n">PPGE</span>
<span class="o">&gt;</span><span class="n">sp</span><span class="o">|</span><span class="n">P20160</span><span class="o">|</span><span class="n">CAP7_HUMAN</span>  <span class="n">_P_</span> <span class="mi">1</span><span class="n">AE5</span>
<span class="o">...</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The PDB files used as a template should be in the current directory, otherwise you have to declare in the template file the whole path to find your templates.</p>
</div>
</section>
<section id="running-expresso-3d-coffee">
<h6>Running Expresso/3D-Coffee<a class="headerlink" href="#running-expresso-3d-coffee" title="Permalink to this heading"></a></h6>
<p>Both Expresso (command 1) and 3D-Coffee (command 2) are modes of T-Coffee you can call with the flag <strong>-mode</strong>; the correspond to a preestablished configuration with default parameters. The template selection is indicated with the flag <strong>-template_file</strong> followed by either <strong>PDB</strong> (means BLAST will run remotely on the PDB) or <strong>_SELF_P_</strong> (means that the PDB identifier is the name of the sequence so there is no need to run BLAST) or a template file of your choice. As you can see in commands 1 and2, SAP (sap_pair) is the default structural aligner but you can choose alternative aligner(s) installed. You can give any combination of methods with the flag <strong>-method</strong>, but at least one has to be a structural aligner (command 3). You can also specify local installations of BLAST and PDB (command 4) <strong>which is highly recommended if you want reproducible results</strong>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Command 1: two ways of running Expresso
$$: t_coffee three_pdb_two_seq.fasta -mode expresso
$$: t_coffee three_pdb_two_seq.fasta -method sap_pair,slow_pair -template_file PDB

Command 2: two ways of running 3D-Coffee
$$: t_coffee three_pdb.fasta -mode 3dcoffee
$$: t_coffee three_pdb.fasta -method sap_pair,slow_pair -template_file _SELF_P_

Command 3: Choosing your own templates and methods
$$: t_coffee three_pdb_two_seq.fasta -method mustang_pair,slow_pair -template_file \
    three_pdb_two_seq_pdb1.template_list

Command 4: Running Expresso using a local BLAST/PDB
##: t_coffee three_pdb_two_seq.fasta -mode expresso -blast=LOCAL -pdb_db=&lt;PDB&gt; \
    -pdb_type d -pdb_min_sim 95 -pdb_min cov 90 -cache $PWD
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>By default, structures and structural pairwise alignments are stored in your local ~/.t_coffee/cache/ allowing Expresso to run faster if you reuse similar structures; you can choose to have all these files directly in your working directory by using <strong>-cache=$PWD</strong>. Don’t forget to empty your cache directory from time to time otherwise your folder is just getting bigger and bigger (similar comment can be done for any template based mode of T-Coffee).</p>
</div>
</section>
<section id="template-search-paramaters">
<h6>Template search paramaters<a class="headerlink" href="#template-search-paramaters" title="Permalink to this heading"></a></h6>
<p>To use Expresso, you have different option from an entirely automated procedure to tailored procedure, by selecting either your own structures or by defining different criteria for the template selection. You can have an exhaustive list in the <strong>T-Coffee Technical Documentation</strong> (subsection <strong>Template based T-Coffee modes</strong>) yet the most important parameters for the template selection are the following:</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>-pdb_type</strong>    : type of structure (“d” for diffraction/XRAY or “n” NMR structures or “e” EM structures)</p></li>
<li><p><strong>-pdb_min_cov</strong> : minimum coverage between query sequence and template (from 0-100%)</p></li>
<li><p><strong>-pdb_min_sim</strong> : minimum identity between query sequence and template (from 0-100%)</p></li>
</ul>
</div></blockquote>
</section>
</section>
<section id="aligning-sequences-and-structures">
<h5>Aligning sequences and structures<a class="headerlink" href="#aligning-sequences-and-structures" title="Permalink to this heading"></a></h5>
<section id="mixing-sequence-profile-and-structure-templates">
<h6>Mixing sequence profile and structure templates<a class="headerlink" href="#mixing-sequence-profile-and-structure-templates" title="Permalink to this heading"></a></h6>
<p>If you want to go further, and be even slower, you can use the accurate mode that will combine profile and structural information. If no structure is available, the template will be a profile (similar to PSI-Coffee, see subsection <strong>Aligning Profiles</strong>). It is probably one of the most accurate way of aligning sequences currently available as it tries to get as much information as possible.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee sample_seq1.fasta -mode accurate
</pre></div>
</div>
</section>
<section id="aligning-profile-using-structural-information">
<h6>Aligning profile using structural information<a class="headerlink" href="#aligning-profile-using-structural-information" title="Permalink to this heading"></a></h6>
<p>If you have two profiles to align, an ideal situation is when your profiles each contain one or more structures. These structures will guide the alignment of the profiles, even if they contain very distally related sequences. All you need is a template file that declares which sequences have a known structure. If you only want to align sequences, you can try:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee -profile=profile1_pdb1.aln, profile2_pdb2.aln -method sap_pair \
    -profile_template_file two_profiles.template_file
</pre></div>
</div>
</section>
</section>
<section id="using-secondary-structure-predictions">
<h5>Using secondary structure predictions<a class="headerlink" href="#using-secondary-structure-predictions" title="Permalink to this heading"></a></h5>
<p>T-Coffee can be used to predict secondary structures and transmembrane domains. For secondary structure predictions, the current implementation is only able to run GOR on either single sequences or on a bunch of homologues found by BLAST.</p>
<section id="single-sequence-prediction">
<h6>Single sequence prediction<a class="headerlink" href="#single-sequence-prediction" title="Permalink to this heading"></a></h6>
<p>To make a secondary structure prediction T-Coffee used the GOR software. In the command line <strong>-template_file=SSP</strong> is a hard coded mode which prompts the computation of predicted secondary structures. Used this way, the method will produce for each sequence a secondary prediction file (<code class="docutils literal notranslate"><span class="pre">&lt;sequence_name&gt;.ssp</span></code>). GOR run on single sequences with a relatively low accuracy, which can be increased by coupling it with BLAST (command 2). When doing so, the predictions for each sequence are obtained by averaging the GOR predictions on every homologue as reported by a BLAST against nr. By default the BLAST is done remotely at the NCBI using the BLASTPGP web service of the EBI. Transmembrane structures can also be carried out simply, or following the same previous strategy (command 3 and 4).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Command 1:
$#: t_coffee sample_seq1.fasta -template_file SSP

Command 2:
$#: t_coffee sample_seq1.fasta -template_file PSISSP

Command 3:
$$: t_coffee sample_seq1.fasta -template_file TM

Command 4:
$$: t_coffee sample_seq1.fasta -template_file PSITM
</pre></div>
</div>
</section>
<section id="incorporation-of-the-prediction-in-the-alignment">
<h6>Incorporation of the prediction in the alignment<a class="headerlink" href="#incorporation-of-the-prediction-in-the-alignment" title="Permalink to this heading"></a></h6>
<p>It is possible to use the secondary prediction (command 1) or the transmembrane domains prediction (command 2) in order to reward the alignment of similar elements:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Command 1:
$#: t_coffee sample_seq1.fasta -template_file PSISSP -method_evaluate_mode ssp -method \
    lalign_id_pair

Command 2:
$$: t_coffee sample_seq1.fasta -template_file PSITM -method_evaluate_mode tm -method \
    lalign_id_pair
</pre></div>
</div>
<p>The overall effect is very crude and can go up to overweighting by 30% the score obtained when matching two residues in a similar secondary structure state. The net consequence is that residues in similar predicted states tend to be aligned more easily.</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>In that case, the flag <strong>-method</strong> can only accept one single method</p>
</div>
</section>
<section id="using-other-secondary-structure-predictions">
<h6>Using other secondary structure predictions<a class="headerlink" href="#using-other-secondary-structure-predictions" title="Permalink to this heading"></a></h6>
<p>If you have your own predictions, you can use them to run T-Coffee providing you give your own template file, where the file containing the secondary structure prediction is declared along with the sequence (with _E_).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Command:
$#: t_coffee sample_seq1.fasta -template_file sample_seq1_ssp.template -method_evaluate_mode \
    ssp -method lalign_id_pair

Format of the template file:
&gt;hmgl_wheat _E_ hmgl_wheat.ssp
&gt;hmgb_chite _E_ hmgb_chite.ssp
&gt;hmgl_trybr3 _E_ hmgl_trybr3.ssp
...

Format of the prediction file:
&gt;hmgl_wheat
CCCCCCCCCCCCHHHHHHHCCCCCCCCCHHHHHHHHHHHHHHHCCCCHHHHHHHHHHHHHHHCE
</pre></div>
</div>
</section>
<section id="output-of-the-prediction">
<h6>Output of the prediction<a class="headerlink" href="#output-of-the-prediction" title="Permalink to this heading"></a></h6>
<p>You can output a color coded version of your alignment using the secondary predicted structure or transmembrane regions predictions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Secondary structure prediction:
$#: t_coffee sample_seq1.fasta -template_file PSISSP -output sec_html

Transmembrane regions prediction:
$$: t_coffee sample_seq1.fasta -template_file PSITM -output tm_html
</pre></div>
</div>
</section>
</section>
</section>
<section id="rna-sequences-using-2d-and-3d-structure">
<h4>RNA sequences using 2D and 3D Structure<a class="headerlink" href="#rna-sequences-using-2d-and-3d-structure" title="Permalink to this heading"></a></h4>
<p>The main property of RNA sequences is to have a secondary structure that can be used to guide the alignment. While the default T-Coffee has no special RNA alignment method incorporated in, we have developped specific modes and tools for RNA alignment and analysis (see subsection <strong>Manipulating RNA Sequences</strong> for more details).</p>
<section id="rna-sequences-using-2d-structure-r-coffee">
<h5>RNA sequences using 2D structure (R-Coffee)<a class="headerlink" href="#rna-sequences-using-2d-structure-r-coffee" title="Permalink to this heading"></a></h5>
<section id="introduction">
<h6>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading"></a></h6>
<p>R-Coffee is the special mode of T-Coffee developped to handle specifically RNA sequences. It has been proven far more accurate than T-Coffee default because of its specific design. It can be run as a standalone aligner (using secondary structure prediction) or using third party software.</p>
</section>
<section id="r-coffee-aligning-rna-sequences-using-secondary-structures">
<h6>R-Coffee: aligning RNA sequences using secondary structures<a class="headerlink" href="#r-coffee-aligning-rna-sequences-using-secondary-structures" title="Permalink to this heading"></a></h6>
<p>R-Coffee uses predicted secondary structures via the software RNApfold, in order to improve RNA alignments. Running R-Coffee by default is rather simple (command 1) but as for T-Coffee, you can also specify the methods you prefer (command 2):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Command 1: R-Coffee default
$$: t_coffee sample_rnaseq1.fasta -mode rcoffee

Command 2: R-Coffee selected methods
$$: t_coffee sample_rnaseq1.fasta -mode rcoffee -method lalign_id_pair,slow_pair
</pre></div>
</div>
</section>
<section id="improving-r-coffee">
<h6>Improving R-Coffee<a class="headerlink" href="#improving-r-coffee" title="Permalink to this heading"></a></h6>
<p>There are two modes we proposed to improve R-Coffee alignments: 1) using the best method for RNA sequences (namely Consan), 2) combining many methods to achieve a better reliability (RM-Coffee).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Using Consan (best):
$#: t_coffee sample_rnaseq1.fasta -mode rcoffee_consan


Using multiple methods:
$$: t_coffee sample_rnaseq1.fasta -mode rmcoffee
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>In order to know if a RNA alignment is better than another one, the best is to visualize the compensatory mutations of the secondary structure: look at the subsection <strong>Manipulating RNA Sequences</strong>.</p>
</div>
</section>
</section>
<section id="rna-sequences-using-2d-and-3d-structures-sara-coffee-and-rsap-coffee">
<h5>RNA Sequences using 2D and 3D structures (SARA-Coffee and RSAP-Coffee)<a class="headerlink" href="#rna-sequences-using-2d-and-3d-structures-sara-coffee-and-rsap-coffee" title="Permalink to this heading"></a></h5>
<p>SARA-Coffee is a structure based multiple RNA aligner. This is a new algorithm that joins the pairwise RNA structure alignments performed by SARA with the multiple sequence T-Coffee framework. Since setting up the SARA-Coffee dependencies (T-Coffee, <a class="reference external" href="http://structure.biofold.org/sara/">SARA</a>, <a class="reference external" href="http://x3dna.org/">X3DNA</a>, <a class="reference external" href="http://www.numpy.org/">Numpy</a>, <a class="reference external" href="http://biopython.org/">Biopython</a>, Perl, Python 2.7) can be tricky we provide a self-contained Vagrant VM, which downloads and configures all the required pieces of software for you. This procedure can be complex, and if you cannot install SARA, we recommand using RSAP-Coffee instead (cf next paragraph).</p>
<p>RSAP-Coffee is a an an alternative experimental mode of SARA-Coffee using protein structral aligners. It processes RNA PDB files so that the C3’ Carbons are treated as C-alpha in a protein chain. This procedure is suitable for any protein structural aligner that only considers alpha carbons in the main chain. By default, rsapcoffee uses  the sap_aligner that ships with T-Coffee default distribution.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>SARA-Coffee and RSAP-Coffee use very similar command line. In practice, the only difference is the use of the method sa_pair instead of the sara_pair methiod when buolding the T-Coffee library.</p>
</div>
<section id="running-sara-rsap-coffee">
<h6>Running SARA/RSAP-Coffee<a class="headerlink" href="#running-sara-rsap-coffee" title="Permalink to this heading"></a></h6>
<p>The procedure is similar to Expresso/3Dcoffee and requires providing a template file in the PDB files are matched with the corresponding sequences</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&lt;</span><span class="n">RNA</span> <span class="n">Seq</span> <span class="n">Identifier</span><span class="o">&gt;</span>  <span class="n">_P_</span> <span class="o">&lt;</span><span class="n">PDB</span><span class="o">&gt;</span>
<span class="o">&gt;&lt;</span><span class="n">RNA</span> <span class="n">Seq</span> <span class="n">Identifier</span><span class="o">&gt;</span>  <span class="n">_P_</span> <span class="o">&lt;</span><span class="n">PDB</span><span class="o">&gt;</span>
<span class="o">...</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>PBD can be either a file PDB identifier or a PDB file. The file can be either in your homew dir or on a location specified by the environement variable <strong>PBD_DIR</strong>. If you use an identifier T-Coffee will be able to download the file from RCSB.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If in your PDB the SEQRES and the ATOM yield a different sequence, T-Coffee will use a sequence estimated from ATOM. If tghis sequence does not match your FASTA, they will be reconciliated using an alignment procedure to establish residues equivalencies.</p>
</div>
<p>You then need to run</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee t_coffee -seq rna3D.fa -mode rsapcoffee -template_file rna3D.template
</pre></div>
</div>
<dl class="simple">
<dt>Or</dt><dd><p>$$: t_coffee t_coffee -seq rna3D.fa -mode saracoffee -template_file rna3D.template</p>
</dd>
</dl>
<p>By Default, RSAP-Coffee only runs sap, but you can also run other structural methods supported by T-Cofee. like Mustang or TM-Align</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$#: t_coffee &lt;yourseq.fasta&gt; -mode rsapcoffee -method sap_pair, mustang_pair, TMalign_pair -template_file &lt;template file&gt;
</pre></div>
</div>
<p>The default procedure is meant to handle a muxture of PDB files and sequences. All possble PDB sequences pairs are aligned using strucure based methods (structural library) and all possibl�e sequence pairs (including PDB sequences) sequences are then aligned using the R-Coffee mode (secondary library). In the secondary library, the PDB sequences are aligned using their experimentallyerived secondary structures, as estimated by X3DNA. Note that id you aonly have structures, you may use the folloing command lines to carry out a strict structure based sequence alignment:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee -seq rna3D.fa -method sap_pair -template_file rna3D.template
</pre></div>
</div>
<p>In that case the PDB Sequences are aligned using the experimental</p>
</section>
<section id="estimating-the-accuracy-of-an-rna-structure-based-alignment">
<h6>Estimating the accuracy of an RNA structure based alignment<a class="headerlink" href="#estimating-the-accuracy-of-an-rna-structure-based-alignment" title="Permalink to this heading"></a></h6>
<p>It is possible to use the irmsd procedure to estimate d-RMSD of your sutcure based sequence alignmnent</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee -other_pg irmsd -aln rna3D_msa2.aln -template_file rna3D.template
</pre></div>
</div>
</section>
<section id="installing-sara-coffee-vm">
<h6>Installing SARA-Coffee VM<a class="headerlink" href="#installing-sara-coffee-vm" title="Permalink to this heading"></a></h6>
<p>Follow the procedure:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span><span class="p">)</span> <span class="n">Install</span> <span class="ow">or</span> <span class="n">update</span> <span class="n">virtual</span> <span class="n">box</span> <span class="kn">from</span> <span class="nn">https</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">virtualbox</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">wiki</span><span class="o">/</span><span class="n">Downloads</span>

<span class="mi">2</span><span class="p">)</span> <span class="n">Install</span> <span class="ow">or</span> <span class="n">update</span> <span class="n">vagrant</span> <span class="n">from</span><span class="p">:</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">vagrantup</span><span class="o">.</span><span class="n">com</span>

<span class="mi">3</span><span class="p">)</span> <span class="n">Clone</span> <span class="n">the</span> <span class="n">sara</span><span class="o">-</span><span class="n">coffee</span> <span class="n">virtual</span> <span class="n">machine</span> <span class="p">(</span><span class="n">this</span> <span class="n">project</span><span class="p">)</span> <span class="ow">in</span> <span class="n">a</span> <span class="n">convenient</span> <span class="n">location</span>
   <span class="c1">##: git clone https://github.com/cbcrg/sara-coffee-vm.git</span>

<span class="mi">4</span><span class="p">)</span> <span class="n">Enter</span> <span class="n">the</span> <span class="n">sara</span><span class="o">-</span><span class="n">coffee</span><span class="o">-</span><span class="n">vm</span> <span class="n">folder</span> <span class="ow">and</span> <span class="n">launch</span> <span class="n">vagrant</span>
   <span class="c1">##: cd sara-coffee-vm/</span>
   <span class="c1">##: vagrant up</span>
</pre></div>
</div>
<p>The first time you run it, it will automatically download the virtual machine and all the packages required by SARA-Coffee. It may take some minutes to complete, so be patient. When it boots up and the configuration steps are terminated, login into the VM instance:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span><span class="p">)</span> <span class="n">Login</span> <span class="ow">in</span> <span class="n">VM</span><span class="p">:</span>
   <span class="c1">##: vagrant ssh</span>

<span class="mi">2</span><span class="p">)</span> <span class="n">Go</span> <span class="n">to</span> <span class="n">SARA</span><span class="o">-</span><span class="n">Coffee</span><span class="p">:</span>
   <span class="c1">##: cd sara_coffee_package/</span>

<span class="mi">3</span><span class="p">)</span> <span class="n">Run</span> <span class="n">SARA</span><span class="o">-</span><span class="n">Coffee</span><span class="p">:</span>
   <span class="c1">##: ./sara_coffee.sh &lt;input file&gt; &lt;output file&gt;</span>
</pre></div>
</div>
<p>The folder ‘/vagrant/’ is shared between the Sara-Coffee virtual and your local machine. On your local machine, this folder is the one in which you started vagrant (i.e. sara-coffee-vm). When finished, stop the VM using the command <strong>vagrant halt</strong> or <strong>vagrant destroy</strong>, depending if you want to temporary stop the execution or delete permanently the VM with all its files.</p>
</section>
<section id="docker-image-for-sara-coffee">
<h6>Docker image for SARA-Coffee<a class="headerlink" href="#docker-image-for-sara-coffee" title="Permalink to this heading"></a></h6>
<p>SARA-Coffee is also distributed as a Docker container. This will allow you to run it without having to install and configure each single dependency packages. If you have Docker installed simply pull the SARA-Coffee container by using the command 1 and run SARA-Coffee using the command 2:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Command</span> <span class="mi">1</span><span class="p">:</span> <span class="n">Pull</span> <span class="n">SARA</span><span class="o">-</span><span class="n">Coffee</span> <span class="n">container</span>
<span class="c1">##: docker pull cbcrg/saracoffee**.</span>

<span class="n">Command</span> <span class="mi">2</span><span class="p">:</span> <span class="n">Run</span> <span class="n">SARA</span><span class="o">-</span><span class="n">Coffee</span>
<span class="c1">##: docker run -v $PWD:$PWD -w $PWD cbcrg/saracoffee &lt;input&gt; &lt;output&gt;**</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>this command assumes your input file is located in the working directory. If this is not the case, you will need to mount the input file path accordingly.</p>
</div>
</section>
</section>
</section>
<section id="aligning-dna-sequences">
<h4>Aligning DNA sequences<a class="headerlink" href="#aligning-dna-sequences" title="Permalink to this heading"></a></h4>
<section id="id4">
<h5>Aligning DNA sequences<a class="headerlink" href="#id4" title="Permalink to this heading"></a></h5>
<p>MSA methods are not at their best when aligning DNA sequences. Whenever you can, try using a local MSA package like the Gibbs sampler; yet if you believe your DNA sequence are homologous over their entire length, you can use T-Coffee. In theory, the program automatically recognizes DNA sequences and uses appropriate methods, yet adding the <strong>-type=dna flag</strong> cannot do any harm…</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee sample_dnaseq1.fasta -type=dna
</pre></div>
</div>
<p>The type declaration (or its automatic detection) triggers the use of the appropriate substitution matrix in most of the methods. However, if you would rather use your own matrix, use the following command where you should replace <strong>idmat</strong> with your own matrix in BLAST format.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee sample_dnaseq1.fasta -in Mcdna_fast_pair@EP@MATRIX@idmat
</pre></div>
</div>
</section>
<section id="pro-coffee-aligning-functional-dna-regions">
<h5>Pro-Coffee: Aligning functional DNA regions<a class="headerlink" href="#pro-coffee-aligning-functional-dna-regions" title="Permalink to this heading"></a></h5>
<p>Pro-Coffee is a MSA method specifically designed for promoter regions or other orthologous DNA regions containing functional elements (enchancers for instance). Pro-Coffee takes nearest-neighbour nucleotide correlations into account when aligning DNA sequence. For this it first translates sequences into a dinucleotide alphabet and then does the alignment using a specifically designed dinucleotide substitution matrix. This matrix was constructed from binding sites alignments from the Transfac database. A benchmark on multispecies ChIP-seq data shows that validated binding sites will be better aligned than when using off-the-shelf methods. To run Pro-Coffee is easy by defaults (command 1), however the user can change empirically all gap parameters in order to improve the MSA (command 2). By default, parameters were optimized on benchmarks (GOP=-60/GEP=-1) but as every dataset is different you may want to see for yourself. Once your alignment is done, you can always use reformatting options in order to extract the regions of interest (command 3).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Command 1: Pro-Coffee default
$$: t_coffee -seq c18orf19.fa -mode procoffee

Command 2: Pro-Coffee parameters
$$: t_coffee -seq c18orf19.fa -method promo_pair@EP@GOP@-60@GEP@-1

Command 3: Extracting regions
$$: t_coffee -other_pg seq_reformat -in c18orf19.aln -action +extract_block \
    &#39;ENSG00000177150&#39; 1852 1983 &gt; c18orf19_chipseq.aln
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you want more details, we suggest you follow the subsection <strong>Quick Start, Tutorial (Practical Examples)</strong> published in Nature Protocols (2011) or refer to the original article.</p>
</div>
</section>
<section id="splice-variants">
<h5>Splice variants<a class="headerlink" href="#splice-variants" title="Permalink to this heading"></a></h5>
<p>Splice variants are especially challenging for most MSA programs, because the splicing variants need very long gaps to be inserted, and most programs attempt to match as many symbols as possible. Standard programs like ClustalW or MUSCLE are not good at dealing with this situation and in our experience, the only programs that can do something with splice variants are those using local information like some flavors of MAFFT and T-Coffee. For instance, if you try muscle on the following dataset with the command 1, you will quickly realize your alignment is not very good and does not show where the alternative splicing co-occurs. On the other hand, if you use T-Coffee (command 2), things become much clearer. The reason why T-Coffee does better than other packages is mostly because it uses local information (lalign_id_pair) and is therefore less sensitive to long gaps. If the default mode does not work for your dataset, you can try to be a bit more aggressive and only use local information to compute your library (command 3). Of course, the most distantly related your sequences, the harder the alignment of splice variants.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Command 1: using MUSCLE
##: muscle -in sv.fasta -clw -out sv_muscle.aln

Command 2: using T-Coffee
$$: t_coffee sv.fasta

Command 3: using only local information
$$: t_coffee sv.fasta -method lalign_id_pair
</pre></div>
</div>
</section>
<section id="noisy-coding-dna-sequences">
<h5>Noisy coding DNA sequences…<a class="headerlink" href="#noisy-coding-dna-sequences" title="Permalink to this heading"></a></h5>
<p>When dealing with coding DNA, the right thing to do is to translate your DNA sequence and thread the DNA onto the protein alignment if you really need some DNA. However, sometimes, your cDNA may not be so clean that you can easily translate it (frameshifts and so on). Whenever this happens, try (no warranty) the following special method. The test case in three_dna_seq.fasta contains the DNA sequences of three proteases with a couple of frameshifts here and there. If you make a regular alignment of these sequences (command 1) you see that many gaps have sizes that are not multiple of 3 (codon size). When using an appropriate alignment method that takes into account all the frames at the same time, we get something much more meaningful (command 2). At the end, you can even recover the corrected protein sequence (command 3) using a special option <strong>+clean cdna</strong>, a small HMM that loops through each sequence and select the frame in order to maximize the similarity within the alignment (part of the <strong>seq_reformat</strong> utility).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Command 1: Default alignment
$$: t_coffee three_cdna.fasta

Command 2: Special mode for cDNA
$$: t_coffee three_cdna.fasta -method cdna_fast_pair

Command 3: Recovering your protein sequences
$$: t_coffee -other_pg seq_reformat -in three_cdna.aln -action +clean_cdna +translate
</pre></div>
</div>
</section>
</section>
<section id="using-many-msa-methods-at-once">
<h4>Using many MSA methods at once<a class="headerlink" href="#using-many-msa-methods-at-once" title="Permalink to this heading"></a></h4>
<p>One of the most common situation when building MSAs is to have several alignments produced by different alternative methods, and not knowing which one to choose. In this section, we show you how to use M-Coffee to combine many alignments into one single alignment, or how you can specify only the methods you want. M-Coffee is not always the best method, but extensive benchmarks on BAliBASE, PREFAB and HOMSTRAD have shown that it delivers the best alignment 2 times out of 3. If you do not want to use the methods provided by M-Coffee, you can also combine precomputed alignments.</p>
<section id="using-third-party-aligner-via-t-coffee">
<h5>Using third party aligner via T-Coffee<a class="headerlink" href="#using-third-party-aligner-via-t-coffee" title="Permalink to this heading"></a></h5>
<p>T-Coffee is installed along with many aligners necessary to run M-Coffee for instance, and many more. If you type <strong>t_coffee</strong>, it will display on the screen the different t_coffee options and all the methods included. If you look carefully, you will see that most of the methods exist under two denominations: 1) <strong>&lt;method&gt;_msa</strong> or 2) <strong>&lt;method&gt;_pair</strong>. In the first case, it means that T-Coffee will use the specified method to run your MSA, so you can easily have a ClustalW or a MAFFT alignment using T-Coffee. In the second case, you ask T-Coffee to align every pair of sequence with the specified methods, the final MSA will be computed using the T-Coffee consistency between all the pairs. Go to the <strong>Integrating External Methods in T-Coffee</strong> if you want more information.</p>
</section>
<section id="using-all-the-methods-at-the-same-time-m-coffee">
<h5>Using all the methods at the same time: M-Coffee<a class="headerlink" href="#using-all-the-methods-at-the-same-time-m-coffee" title="Permalink to this heading"></a></h5>
<p>To use M-Coffee (M stands for Meta aligner), you will need several packages to be installed (see <strong>T-Coffee Installation</strong> and section <strong>Integrating External Methods in T-Coffee</strong>). If you did a default installation, all the software you need should be there. M-Coffee is a special mode of T-Coffee that you can call using the flag <strong>-mode mcoffee</strong>. It will align your sequence using 8 different aligners: ClustalW, POA, MUSCLE, ProbCons, MAFFT, Dialing-T, PCMA and T-Coffee:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee proteases_small.fasta -mode mcoffee -output clustalw, html
</pre></div>
</div>
<p>The final MSA is a combination of all methods. The alignment is colored with the T-Coffee consistency color scheme, but in this case the colors will reflect the consistency between methods: 1) regions in red have a high consistency, so all the methods agree and you can expect them to be fairly accurate, 2) regions in green/blue have the lowest consistency, meaning that all the methods deliver different alignment in these regions and you should not trust them. Overall this alignment has a score of 951 (1000 being the max), which means that it is roughly 95% consistent with the entire collection; this is a fairly high index meaning that you can trust your alignment.</p>
</section>
<section id="using-selected-methods-to-compute-your-msa">
<h5>Using selected methods to compute your MSA<a class="headerlink" href="#using-selected-methods-to-compute-your-msa" title="Permalink to this heading"></a></h5>
<p>Using the 8 methods predefined in M-Coffee can sometimes be a bit heavy, if you only want to use a subset of your favorite methods, you should know that each of these methods is available via the <strong>-method</strong> flag. You can make all the combination you want !!! For instance, to combine MAFFT, MUSCLE, T-Coffee and ProbCons, you can use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee proteases_small.fasta -method=t_coffee_msa,mafft_msa,probcons_msa, \
    muscle_msa -output=html
</pre></div>
</div>
</section>
</section>
<section id="aligning-profiles">
<h4>Aligning profiles<a class="headerlink" href="#aligning-profiles" title="Permalink to this heading"></a></h4>
<p>Sometimes, it is better to prealign a subset of your sequences, and then to use this small alignment as a master for adding sequences (sequence to profile alignment) or even to align several profiles together if your protein family contains distantly related groups. T-Coffee contains most of the facilities available in ClustalW to deal with profiles, and the strategy we outline here can be used to deal with large datasets.</p>
<section id="aligning-sequence-s-to-profile-s">
<h5>Aligning sequence(s) to profile(s)<a class="headerlink" href="#aligning-sequence-s-to-profile-s" title="Permalink to this heading"></a></h5>
<p>Assuming you have multiple alignment(s) (sproteases_small.aln) or profile(s) here is a simple strategy to align sequence(s) to your profile(s). It can align a variable number of sequences from 1 to N, with a variable number of profiles from 1 ot N: you can mix sequences and profiles in any proportion you like.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Adding one sequence to your MSA:
$$: t_coffee proteases_oneseq.fasta -profile proteases_small.aln

Adding many sequences to many profiles:
$$: t_coffee -profile=prf1.aln,prf2.aln,prf3.aln -outfile=combined_profiles.aln
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>You can also use all the methods you want but be aware when using external methods that profiles are nto always supported. When it is not, it is replaced with its consensus sequence which will not be quite as accurate. Methods supporting full profile information are: lalign_id_pair, slow_pair, proba_pair, clustalw_pair and clustalw_msa. All the other methods (internal or external) treat the profile as a consensus (less accurate).</p>
</div>
</section>
<section id="computing-very-accurate-but-slow-alignments-with-psi-tm-coffee">
<h5>Computing very accurate (but slow) alignments with PSI/TM-Coffee<a class="headerlink" href="#computing-very-accurate-but-slow-alignments-with-psi-tm-coffee" title="Permalink to this heading"></a></h5>
<p>PSI-Coffee is currently the most accurate mode of T-Coffee but also the slowest. Its principle is rather simple: it associates every sequence with a profile of homologous sequences gathered using BLAST on a sequence database (nr by default). PSI-Coffee then uses the profiles instead of the initial sequences to makes a multiple profile alignment (command 1). In a last step, your profiles are replaced by their initial query sequence from your initial dataset and returns a MSA of your sequences. PSI-Coffee can also use reduced database instead of nr (installed locally) in order to speed-up the process. A special mode, TM-Coffee, exists using PSI-Coffee but specialized to align transmembrane proteins using a reduced database of TM proteins and also including a prediction of transmembrane domains with the flag <strong>-template_file PSITM</strong> (command 2). It is much faster as the search database is limited to known transmembrane protein, however, it applies in only specific cases unlike PSI-Coffee which is a general method. You can find more information about TM-Coffee <a class="reference external" href="http://tcoffee.crg.cat/apps/tcoffee/tutorial_tmcoffee.html">here</a>. If you want to specify a local BLAST version and a local database of your choice, just add to your command line the flags <strong>-blast_server</strong> and <strong>-protein_db</strong> and the corresponding paths.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Command 1: PSI-Coffee
$$: t_coffee sample_seq1.fasta -mode psicoffee

Command 2: TM-Coffee
##: t_coffee proteases_small.fasta -mode psicoffee -template_file PSITM -protein_db &lt;database&gt;
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>PSI/TM-Coffee requires BLAST and a database to search; if you don’t have BLAST installed locally, it will use the BLAST default of T-Coffee. More importantly, if you don’t specify a reduced database for TM-Coffee, it will run on nr and be equal to PSI-Coffee.</p>
</div>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>When running PSI/TM-Coffee, T-Coffee will use the BLAST EBI by default; it can happen that the web service is unavailable from time to time, T-Coffee will return a warning asking you to use NCBI BLAST instead. You can either do that or wait and rerun your job later on.</p>
</div>
</section>
</section>
</section>
<section id="evaluating-your-alignment">
<h3>Evaluating Your Alignment<a class="headerlink" href="#evaluating-your-alignment" title="Permalink to this heading"></a></h3>
<p>There are three possible strategies for evaluating your alignment of protein sequences:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p><strong>Sequence based methods</strong> like the CORE index and the TCS if you don’t have any structure (quite often). These do pretty well in the core regions of an alignment (which can correspond to protein domains, fold, structural elements, etc…) but can be limited in more variable regions (which can correspond to loops, disordered regions, etc…).</p></li>
<li><p><strong>Structure is a killer</strong>, so if you have at least two structures available for your protein family, you are in an ideal situation and you can use the iRMSD. If you only have one structure available, we developped STRIKE to compare alternative alignment.</p></li>
<li><p><strong>Another killer is the use of functional information</strong>, but it is much less often at hand. If you know some residues MUST be aligned because they are functionally related. As the information is scarce and not standard, there is no automated procedure specifically designed for this kind of analysis but you can still setup an evaluation procedure with T-Coffee.</p></li>
</ol>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Most of evalution methods are designed for protein sequences (notably structure based methods), however, T-Coffee via the TCS/CORE index offers some possibilities to evaluate also DNA alignments.</p>
</div>
<section id="sequence-based-methods">
<h4>Sequence Based Methods<a class="headerlink" href="#sequence-based-methods" title="Permalink to this heading"></a></h4>
<section id="the-core-index">
<h5>The CORE index<a class="headerlink" href="#the-core-index" title="Permalink to this heading"></a></h5>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The CORE index is the basis of T-Coffee estimation of the consistency, however for evaluating alignment we recommend to use the TCS procedure describe in the next section.</p>
</div>
<section id="computing-the-local-core-index">
<h6>Computing the local CORE index<a class="headerlink" href="#computing-the-local-core-index" title="Permalink to this heading"></a></h6>
<p>The CORE index is an estimation of the consistency between your alignment and the computed library. The higher the consistency, the better the alignment. The score reported with every T-Coffee alignment is the concistency score (depending on the version it can be normalized to 100 or 1000). If you want to go further and estimate the local concistency (known as the CORE index), an html file is automatically created each time you run T-Coffee; it is colored version of your alignment where residues are colored according to their consistency score, from blue (low consistency) to red (high consistency). It is not full proof but in principle you can expect positions with a score above 6 to be correctly aligned.</p>
</section>
<section id="computing-the-core-index-of-any-alignment">
<h6>Computing the CORE index of any alignment<a class="headerlink" href="#computing-the-core-index-of-any-alignment" title="Permalink to this heading"></a></h6>
<p>You can evaluate any existing alignment with the CORE index. All you need to do is provide that alignment with the -infile flag and specify that you want to evaluate it. For more information on filtering/trimming an alignment using the CORE index score, refer to the subsection <strong>Preparing Your Data: Reformatting, Trimming an more…/Modifying the data itself</strong>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee -infile=proteases_small_g10.aln -output=html -score
</pre></div>
</div>
</section>
</section>
<section id="transitive-consistency-score-tcs">
<h5>Transitive Consistency Score (TCS)<a class="headerlink" href="#transitive-consistency-score-tcs" title="Permalink to this heading"></a></h5>
<p>TCS is an alignment evaluation score that makes it possible to identify the most correct positions in an MSA.
It has been shown that these positions are the most likely to be structuraly correct and also the most informative when estimating phylogenetic trees. The TCS evaluation and filtering procedure is implemented in the T-Coffee package and can be used to evaluate and filter any third party MSA (including T-Coffee MSA of course!).</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>TCS has been incorporated to T-Coffee recently, it means that not all distribution have the TCS implemented; you should install one the latest stable version of T-Coffee to have the TCS along with T-Coffee.</p>
</div>
<section id="evaluating-an-existing-msa">
<h6>Evaluating an existing MSA<a class="headerlink" href="#evaluating-an-existing-msa" title="Permalink to this heading"></a></h6>
<p>The TCS is most informative when used to identify low-scoring portions within an MSA. It is also worth noting that the TCS is not informative when aligning less than five sequences.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee -infile sample_seq1.aln -evaluate -output=score_ascii,aln,score_html
</pre></div>
</div>
<p>Output files:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">sample_seq1.score_ascii</span></code>  displays the score of the MSA, the sequences and the residues.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sample_seq1.score_html</span></code> displays a colored version score of the MSA, the sequences and the residues.</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The color code in the score_html indicates the agreement between the library and the considered alignment. It is important to understand that this score does not only depend on the input MSA, but it also depends on the library.</p>
</div>
</section>
<section id="filtering-unreliable-msa-positions">
<h6>Filtering unreliable MSA positions<a class="headerlink" href="#filtering-unreliable-msa-positions" title="Permalink to this heading"></a></h6>
<p>TCS allows you to filter out from your alignment regions that appears unreliable according to the consistency score; the filtering can be made at the residue level or the column level:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee -infile sample_seq1.aln -evaluate -output tcs_residue_filter3, \
    tcs_column_filter3,tcs_residue_lower4
</pre></div>
</div>
<p>Output files:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">sample_seq1.tcs_residue_filter3</span></code>  All residues with a TCS score lower than 3 are filtered out</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sample_seq1.tcs_column_filter3</span></code>   All columns with a TCS score lower than 3 are filtered out</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sample_seq1.tcs_residue_lower4</span></code>   All residues with a TCS score lower than 3 are in lower case</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The TCS will create output files containing your results; if you rerun similar jobs or with the same name, TCS will not overwrite the previous outputs but append the new results in the already existing files.</p>
</div>
<p>All these output functions are also compatible with the default T-Coffee (command 1) when computing an alignment or with <strong>seq_reformat</strong> (command 2) using a T-Coffee <code class="docutils literal notranslate"><span class="pre">&lt;name&gt;.score_ascii</span> <span class="pre">file</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Command 1:
$$: t_coffee -seq sample_seq1.fasta -output tcs_residue_filter3, tcs_column_filter3, \
    tcs_residue_lower4

Command 2:
$$: t_coffee -other_pg seq_reformat -in sample_seq1.aln -struc_in sample_seq1.score_ascii \
    -struc_in_f number_aln -output tcs_residue_filter3
</pre></div>
</div>
</section>
<section id="weighting-msa-for-improved-trees">
<h6>Weighting MSA for improved trees<a class="headerlink" href="#weighting-msa-for-improved-trees" title="Permalink to this heading"></a></h6>
<p>One cool trick about TCS is the possibility to deliver weigthed MSA, where each columns is multiplied according to its consistency score; this appears to be particularly useful to build phylogenetic tree. Phylogenetic trees are evaluated using a bootstrap score so each column as the same weight, no matter its relevance, in the case of weighted TCS, the more reliable columns are more represented, therefore improving the support of informative and reliable positions of your MSA.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee -infile sample_seq1.aln -evaluate -output tcs_weighted, tcs_replicate_100
</pre></div>
</div>
<p>Output files:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">sample_seq1.tcs_weighted</span></code>       All columns are duplicated according to their TCS score</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sample_seq1.tcs_replicate_100</span></code>  Contains 100 replicates in phylip format with each column drawn with a probability corresponding to its TCS score</p></li>
</ul>
<p>Note that all these output functions are also compatible with the default T-Coffee (command 1) when computing an alignment or with <strong>seq_reformat</strong> (command 2) using a T-Coffee .score_ascii file.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Command 1:
$$: t_coffee -seq sample_seq1.fasta -output tcs_weighted, tcs_replicate_100

Command 2:
$$: t_coffee -other_pg seq_reformat -in sample_seq1.aln -struc_in sample_seq1.score_ascii \
    -struc_in_f number_aln -output tcs_weighted
</pre></div>
</div>
</section>
<section id="using-different-libraries-for-tcs">
<h6>Using different libraries for TCS<a class="headerlink" href="#using-different-libraries-for-tcs" title="Permalink to this heading"></a></h6>
<p>It is possible to change the way TCS reliability is estimated. This can be done by building different T-Coffee libraries. The proba_pair is the default aligner of T-Coffee that runs a pair-HMM to populate the library with residue pairs having the best posterior probabilities (command 1). You can also combine local and global alignners (command 2). There is also a fast alternative by using a special mode to run a series of fast multiple aligners; it is very fast and used by <a class="reference external" href="http://www.ensembl.org/info/genome/compara/index.html">ENSEMBL Compara</a> (command 3)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Command 1:
$$: t_coffee -infile sample_seq1.aln -evaluate -method proba_pair -output score_ascii, \
    aln, score_html

Command 2:
$$: t_coffee -infile sample_seq1.aln -evaluate -method proba_pair,lalign_id_pair \
    -output score_ascii,aln, score_html

Command 3:
$$: t_coffee -infile sample_seq1.aln -evaluate -method mafft_msa,kalign_msa,muscle_msa \
    -output score_ascii, aln, score_html
</pre></div>
</div>
</section>
<section id="working-with-coding-dna">
<h6>Working with coding DNA<a class="headerlink" href="#working-with-coding-dna" title="Permalink to this heading"></a></h6>
<p>When working with DNA, it is advisable to first align the sequences at the protein level and later thread back the DNA onto your aligned proteins. The filtering must be done in two steps, as shown below. Note that your DNA and protein sequences must have the same name. This first step produces the TCS evaluation file <code class="docutils literal notranslate"><span class="pre">sample_prot_thread.score_ascii</span></code> (command 1). Then, the <strong>-out dna.replicates</strong> option produces 100 DNA replicates with positions selected according to their aminoacid TCS score (command 2). Finally, the <strong>-out dna.filtered</strong> option will filter the DNA alignment according to their TCS column score.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Command 1: evaluating the protein MSA
$$: t_coffee -infile sample_prot_thread.aln -evaluate -output score_ascii

Command 2: generating replicates for DNA
$$: t_coffee -other_pg seq_reformat -in sample_prot_thread.aln -in2 sample_dna_thread.fa \
    -struc_in sample_prot_thread.score_ascii -struc_in_f number_aln -output tcs_replicate_100 \
    -out dna.replicates

Command 3: filtering out according to the TCS score
$$: t_coffee -other_pg seq_reformat -in sample_prot_thread.aln -in2 sample_dna_thread.fa \
    -struc_in sample_prot_thread.score_ascii -struc_in_f number_aln -output tcs_column_filter5 \
    -out dna.filter
</pre></div>
</div>
</section>
<section id="summary-of-the-output-options">
<h6>Summary of the output options<a class="headerlink" href="#summary-of-the-output-options" title="Permalink to this heading"></a></h6>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Flags</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>score_ascii</strong></p></td>
<td><p>Outputs a TCS evaluation file</p></td>
</tr>
<tr class="row-odd"><td><p><strong>score_html</strong></p></td>
<td><p>Contains ascii format in html format</p></td>
</tr>
<tr class="row-even"><td><p><strong>score_pdf</strong></p></td>
<td><p>Transfers score_html into pdf format</p></td>
</tr>
<tr class="row-odd"><td><p><strong>sp_ascii</strong></p></td>
<td><p>Reports the TCS score of every aligned pair in the target MSA</p></td>
</tr>
<tr class="row-even"><td><p><strong>tcs_residue_filter_N</strong></p></td>
<td><p>Removes all residues with a TCS score lower than <cite>N</cite></p></td>
</tr>
<tr class="row-odd"><td><p><strong>tcs_columns_filter_N</strong></p></td>
<td><p>Removes all columns with a TCS score lower than <cite>N</cite></p></td>
</tr>
<tr class="row-even"><td><p><strong>tcs_weighted</strong></p></td>
<td><p>Phylip format with duplicated columns according to their TCS score</p></td>
</tr>
<tr class="row-odd"><td><p><strong>tcs_replicate_N</strong></p></td>
<td><p>Generates <cite>N</cite> replicates of columns drawn according to their TCS score</p></td>
</tr>
</tbody>
</table>
</section>
</section>
</section>
<section id="structural-evaluation-of-msas">
<h4>Structural evaluation of MSAs<a class="headerlink" href="#structural-evaluation-of-msas" title="Permalink to this heading"></a></h4>
<section id="apdb-irmsd">
<h5>APDB/iRMSD<a class="headerlink" href="#apdb-irmsd" title="Permalink to this heading"></a></h5>
<section id="what-is-the-apdb-irmsd">
<h6>What is the APDB/iRMSD?<a class="headerlink" href="#what-is-the-apdb-irmsd" title="Permalink to this heading"></a></h6>
<p>APDB and the iRMSD are two closely related measures meant to evaluate the accuracy of a MSAt without using a structure based reference alignment. The iRMSD is a follow up of the APDB measure and we now recommend using the iRMSD rather than APDB. Although it may seem that the iRMSD was an attempt to get free iPODs from Apple, it is not (or at least we never got the iPODs). The iRMSD is a special RMSD (standing for intramolecular distances based RMSD) where the alignments are evaluated using the structural information of the sequences with known structures.</p>
<p>The strength of the iRMSD is its independence from a specific superposition models. When using the iRMSD to evaluate the score of a MSA, one does not need to superpose the two structures and deduce a sequence alignment that will then be compared with the target alignment. Given two aligned residues (X and Y) the iRMSD score is an attempt to estimate the neighborhood support for the XY alignment. This is done by measuring the difference of distances between X and Y and every other pair of aligned residues within the same sphere (W and Z). The iRMSD is obtained by measuring the average Root Mean Square (RMS) of these differences of distances. The first step of APDB/iRMSD is to measure the distances between the Ca (carbon alpha) of each residue and its neighbors. Neighborhood is defined as a sphere of radius <strong>*-maximum_distance</strong> (10 by default). However, by setting <strong>-local_mode</strong> to ‘window’, the sphere can be replaced with a window of 1/2 size <strong>-maximum_distance</strong> residues.</p>
<p>The lower the iRMSD, the better the alignment. Yet, an alignment can obtain a good iRMSD score by simply having few aligned residues. To avoid this, the program also reports a normalized version of the iRMSD, the NiRMSD= MIN(L1,L2)*iRMSD/Number considered columns. It is recommended to use the NiRMSD to compare alternative alignments of different length. From a structural point of view, the NiRMSD has a meaning very similar to the iRMSD and it behaves in a similar fashion from a numerical point of view (similar ranges in Angstroms).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>APDB is an older measure less robust than the iRMSD; it is an attempt to estimate the fraction of pairs of residues whose alignment seems to be correct form a structural point of view. The higher APDB, the better the alignment, and conversely the lower the NiRMSD, the better the alignment.</p>
</div>
</section>
<section id="how-to-efficiently-use-structural-information">
<h6>How to efficiently use structural information?<a class="headerlink" href="#how-to-efficiently-use-structural-information" title="Permalink to this heading"></a></h6>
<p>When it comes to evaluating MSAs, nothing is better than structural information. To use the methods we describe here, you will need to have at least two structures, similar enough (&gt;60%) to sequences contained in your dataset. Here an outline of the best way to proceed:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Try to include two structures with distantly related sequences, the other sequences being intermediates.</p></li>
<li><p>Align your sequences without using the structural information (i.e. T-Coffee, MUSCLE, MAFFT…).</p></li>
<li><p>Evaluate your alignment with iRMSD/NiRMSD (see later in this section); give this alignment the score S1.</p></li>
<li><p>Realign your sequences but this time using structural information with Expresso.</p></li>
<li><p>Measure the score of that alignment; the score will be S2.</p></li>
</ol>
</div></blockquote>
<p>If S1 and S2 are almost similar, it means your distantly related structures were well aligned and you can expect the intermediate sequences to be well aligned as well. If S2 is much better than S1, you can expect the structures to be well aligned in the second alignment, while there is no guarantee that the alignment of the intermediate sequences has improved as well, although in practice it often does.</p>
</section>
<section id="evaluating-an-alignment-with-the-irmsd-package">
<h6>Evaluating an alignment with the iRMSD package<a class="headerlink" href="#evaluating-an-alignment-with-the-irmsd-package" title="Permalink to this heading"></a></h6>
<p>Let us evaluate the alignment produced by Expresso using the template file it returns. Evaluating the MSA with iRMSD will deliver a long output (all pairs are compared), the most interesting bit is at the bottom with the global iRMSD score in Angstrom (NiRMSD is the iRMSD score normalized to the length of the MSA).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Running the iRMSD:
$$: t_coffee -other_pg irmsd proteases_small.aln -template_file proteases_small.template

Result of the iRMSD evaluation:
TOTAL     EVALUATED :  50.17 %
TOTAL     APDB      :  83.44 %
TOTAL     iRMSD     :  0.67 Angs
TOTAL     NiRMSD    :  1.34 Angs
</pre></div>
</div>
</section>
<section id="evaluating-alternative-alignments">
<h6>Evaluating alternative alignments<a class="headerlink" href="#evaluating-alternative-alignments" title="Permalink to this heading"></a></h6>
<p>The strength of structure based alignments is that they make it possible to compare alternative alignments. In this case let us consider the following results in the table below (APDB in %, iRMSD/NiRMSD in Angstroms, and the evaluated columns in %). As expected, Expresso delivers the best alignment from a structural point of view. This makes sense, since Expresso explicitely USES structural information. The other figures show us that the structural based alignment is only marginally better than most sequences based alignments, yet with the notable exception of ClustalW.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Method</p></th>
<th class="head"><p>APDB(%)</p></th>
<th class="head"><p>iRMSD(A)</p></th>
<th class="head"><p>NiRMSD(A)</p></th>
<th class="head"><p>Eval. (%)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Expresso</p></td>
<td><p>83.44</p></td>
<td><p>0.67</p></td>
<td><p>1.34</p></td>
<td><p>50.17</p></td>
</tr>
<tr class="row-odd"><td><p>T-Coffee</p></td>
<td><p>83.11</p></td>
<td><p>0.68</p></td>
<td><p>1.35</p></td>
<td><p>50.29</p></td>
</tr>
<tr class="row-even"><td><p>M-Coffee</p></td>
<td><p>83.08</p></td>
<td><p>0.68</p></td>
<td><p>1.36</p></td>
<td><p>50.00</p></td>
</tr>
<tr class="row-odd"><td><p>ProbCons</p></td>
<td><p>83.10</p></td>
<td><p>0.68</p></td>
<td><p>1.35</p></td>
<td><p>50.28</p></td>
</tr>
<tr class="row-even"><td><p>MAFFT</p></td>
<td><p>82.99</p></td>
<td><p>0.68</p></td>
<td><p>1.35</p></td>
<td><p>50.25</p></td>
</tr>
<tr class="row-odd"><td><p>Kalign</p></td>
<td><p>82.42</p></td>
<td><p>0.69</p></td>
<td><p>1.38</p></td>
<td><p>50.02</p></td>
</tr>
<tr class="row-even"><td><p>ClustalW</p></td>
<td><p>80.62</p></td>
<td><p>0.73</p></td>
<td><p>1.47</p></td>
<td><p>49.55</p></td>
</tr>
</tbody>
</table>
</section>
<section id="dec-distance-evolutionnary-conservation-with-msa2distances">
<h6>DEC - Distance Evolutionnary Conservation with msa2distances<a class="headerlink" href="#dec-distance-evolutionnary-conservation-with-msa2distances" title="Permalink to this heading"></a></h6>
<p>Using a similar approach it is possible to estimate the variation of intra-molecular distances across a multiple structural MSA for every pair of residue of every sequence. The following command also returns the average variation (stdev) for every residue and its neighbours withing &lt;radius&gt;</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee -other_pg seq_reformat  -in proteases_small.aln -in2 proteases_small.template -action +msa2distances  20
#$: t_coffee -other_pg seq_reformat  -in proteases_small.aln -in2 proteases_small.template -action +msa2distances  &lt;radius: 20A&gt; &lt;threshold: 0.5 A&gt; &lt;min cluster: 4&gt;
</pre></div>
</div>
<p>The output comes in two sections that can be grepped with the first keyword:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">##DECPAIR s1:               ##DECPAIR s1:   &lt;seq_name&gt; c1:  &lt;column 1&gt; c2: &lt;column 2&gt; r1:  &lt;residue 1&gt; r2:  &lt;residue 2&gt; pdbr1:  &lt;pos filed on ATOM line&gt; pdbr2:  pos filed on ATOM line&gt; aa1: &lt;amino acid 1&gt; aa2: &lt;amino acid 2&gt; d:  &lt;distance&gt; avg_d:  &lt;average distance in the column&gt; stdev_d:  &lt;standard deviation&gt; Normalized_score: &lt;standard_deviation/average_distance&gt; N: &lt;number of residue pairs&gt; F: &lt;number residue pairs/number sequences&gt; ent1: &lt;shannon entropy col 1&gt; ent2: &lt;shannon entropy col2&gt;</span>
</pre></div>
</div>
<p>The second fraction summarizes the fate of each residue. Note that the radius parameter potentially makes each residue in a column resulting having different levels of conservation</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">##DECRES s1:               &lt;seq name&gt; aa: &lt;amino acid&gt; c1: &lt;msa column&gt; r1:  &lt;residue index 1..N&gt; avg_stdev: &lt;average stdev across radius AA&gt; -Zscore:  &lt;average zscores of the averaged stdev&gt; normZ: &lt;normalized zscore 0..100&gt; Neighborhood:  &lt;# of AA within radius&gt; Radius:  &lt;radius size in Angstrom as specified in the command line, 20 A by default&gt;</span>
</pre></div>
</div>
<p>This function also outputs colorized versions of the input PDBs using the PDB Bfactor filed. The output files are the following:</p>
</section>
</section>
<section id="strike-contact-based-evaluations">
<h5>STRIKE: Contact based evaluations<a class="headerlink" href="#strike-contact-based-evaluations" title="Permalink to this heading"></a></h5>
<p>STRIKE uses a contact matrix to evaluate an alignment using one or more structures. When doing so, the contacts are extracted from the sequences with known structures and are tnen projected onto the other sequences. Each sequence is then evaluated for the quality of its predicted contacts. When more than one structure is available, the results are provided using each structure as a template. The following Command line will carry this analysis. It takes as input an MSA containing at least one sequence with one of the templates defiend in the template file. The PDB files must be within the current directory.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee -other_pg seq_reformat -in sample_3Dseq1.aln -in2 sample_3Dseq1.template -action \
    +evaluate3D strike -output score_ascii -out sample_3D.score_ascii
</pre></div>
</div>
<p>The first part of the output is the STRIKE RAW SCORE. It reports the score of each sequence when using either one structure as a template, or averaging over all the structures; the highest value in every column is marked with a star. The various fields are as follows:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Field</p></th>
<th class="head"><p>Name</p></th>
<th class="head"><p>Definition</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>RS</p></td>
<td><p>Raw Score</p></td>
<td><p>Average STRIKE score</p></td>
</tr>
<tr class="row-odd"><td><p>Rn</p></td>
<td><p>Random Score</p></td>
<td><p>Average score when scrambling contacts</p></td>
</tr>
<tr class="row-even"><td><p>Bg</p></td>
<td><p>Background Score</p></td>
<td><p>Average score of all-against-all contacts</p></td>
</tr>
</tbody>
</table>
<p>It is also possible to use three extra parameters. The three parameters must be passed!!! Each one can be replaced with the string <strong>“def”</strong> if the default value is meant to be used.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Definition</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>max</p></td>
<td><p>1.2</p></td>
<td><p>Max distance between two contacting AA (Angstrom)</p></td>
</tr>
<tr class="row-odd"><td><p>end</p></td>
<td><p>3</p></td>
<td><p>Number of excluded neighbours between contacts</p></td>
</tr>
<tr class="row-even"><td><p>matrix</p></td>
<td><p>strike</p></td>
<td><p>File containing the STRIKE matrix</p></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Generic</span> <span class="n">common</span> <span class="n">line</span> <span class="k">for</span> <span class="n">STRIKE</span><span class="p">:</span>
<span class="c1">##: t_coffee -other_pg seq_reformat -in sample_3Dseq1.aln -in2 sample_3Dseq1.template -action \</span>
    <span class="o">+</span><span class="n">evaluate3D</span> <span class="n">strike</span> <span class="o">&lt;</span><span class="nb">max</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">end</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">matrix</span><span class="o">&gt;</span> <span class="o">-</span><span class="n">output</span> <span class="n">score_ascii</span>

<span class="n">Generic</span> <span class="n">common</span> <span class="n">line</span> <span class="k">for</span> <span class="n">colored</span> <span class="n">output</span><span class="p">:</span>
<span class="c1">##: t_coffee -other_pg seq_reformat -in sample_3Dseq1.aln -in2 sample_3Dseq1.template -action \</span>
    <span class="o">+</span><span class="n">evaluate3D</span> <span class="n">strike</span> <span class="o">&lt;</span><span class="nb">max</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">end</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">matrix</span><span class="o">&gt;</span> <span class="o">-</span><span class="n">output</span> <span class="n">score_html</span> <span class="o">-</span><span class="n">out</span> <span class="n">sample_3Dseq1</span><span class="o">.</span><span class="n">html</span>
</pre></div>
</div>
</section>
</section>
<section id="evaluating-a-msa-according-to-your-own-criterion">
<h4>Evaluating a MSA according to your own criterion<a class="headerlink" href="#evaluating-a-msa-according-to-your-own-criterion" title="Permalink to this heading"></a></h4>
<p>Any kind of feature can easily be turned into an evaluation grid. For instance, the protease sequences we have been using here have a well characterized binding site. A possible evaluation can be made as follows: let us consider the UniProt annotation of the two distantly related sequences; these two sequences contain the electron relay system of the proteases. We can use it to build an evaluation library: in P29786 (TRY3_AEDAE) the Histidine residue is at position 68 while in P21844 (MCPT5_MOUSE) the functionally equivalent Histidine residue is at position 66. We can therefore build a library that will check whether these two residues are properly aligned in any MSA. The library will look like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>! TC_LIB_FORMAT_01
2
sp|P21844|MCPT5_MOUSE 247 MHLLTLHLLLLLLGSSTKAGEIIGGTECIPHSRPYMAYLEIVTSENYLSACS\
GFLIRRNFVLTAAHCAGRSITVLLGAHNKTSKEDTWQKLEVEKQFLHPKYDENLVVHDIMLLKLKEKAKLTLGVGTLP\
LSANFNFIPPGRMCRAVGWGRTNVNEPASDTLQEVKMRLQEPQACKHFTSFRHNSQLCVGNPKKMQNVYKGDSGGPLL\
CAGIAQGIASYVHRNAKPPAVFTRISHYRPWINKILREN
sp|P29786|TRY3_AEDAE 254 MNQFLFVSFCALLDSAKVSAATLSSGRIVGGFQIDIAEVPHQVSLQRSGRHFC\
GGSIISPRWVLTRAHCTTNTDPAAYTIRAGSTDRTNGGIIVKVKSVIPHPQYNGDTYNYDFSLLELDESIGFSRSIEA\
IALPDASETVADGAMCTVSGWGDTKNVFEMNTLLRAVNVPSYNQAECAAALVNVVPVTEQMICAGYAAGGKDSCQGDS\
GGPLVSGDKLVGVVSWGKGCALPNLPGVYARVSTVRQWIREVSEV
#1 2
66 68 100
! SEQ_1_TO_N
</pre></div>
</div>
<p>You simply need to cut and paste this library in a file and use this file to measure the concistency between your alignment and the correspondances declared in your library. The following command line also makes it possible to visually display the agreement between your sequences and the library.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee -infile proteases_small.aln -lib charge_relay_lib.tc_lib -score \
    -output html
</pre></div>
</div>
</section>
</section>
<section id="downstream-analysis">
<h3>Downstream Analysis<a class="headerlink" href="#downstream-analysis" title="Permalink to this heading"></a></h3>
<section id="contact-evaluations">
<h4>Contact Evaluations<a class="headerlink" href="#contact-evaluations" title="Permalink to this heading"></a></h4>
<section id="contact-evaluation-on-proteins">
<h5>Contact Evaluation on proteins<a class="headerlink" href="#contact-evaluation-on-proteins" title="Permalink to this heading"></a></h5>
<p>This function will report in a library format all the intra-molecular distances of the provided sequences</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Command 1:
$$: t_coffee -other_pg seq_reformat -in sample_3Dseq1.aln -in2 sample_3Dseq1.template -action +pdb2contacts intra  distances 10 -output contact_lib
</pre></div>
</div>
<p>This command will report all the distances between every pair of residue less than 10 Angstrom appart. In the output every pair of residue will be assocuiated with an integer value equal to 100*distance in Angstrom. Distances are between CA</p>
<dl class="simple">
<dt>Command 1:</dt><dd><p>$$: t_coffee -other_pg seq_reformat -in sample_3Dseq1.aln -in2 sample_3Dseq1.template -action +pdb2contacts intra  contacts 1.2  -output contact_lib</p>
</dd>
</dl>
<p>This command will report all the pairs of residue featuring two atoms less than 1.2 Angstrom appart</p>
</section>
</section>
<section id="clustering-trees-based-on-protein-3d-structures">
<h4>Clustering/Trees based on protein 3D structures<a class="headerlink" href="#clustering-trees-based-on-protein-3d-structures" title="Permalink to this heading"></a></h4>
<p>This section describes tree estimation procedure based on the comparison of intramolecular distances. These methods are slightly different from the <cite>T-RMSD &lt;http://tcoffee.readthedocs.io/en/latest/tcoffee_main_documentation.html#the-t-rmsd&gt;</cite> that was also originally developped for this purpose and whose usage is decribed in the next section. The methods described in this section are more versatile than the original T-RMSD: they support trees based on contacts or intra-molecular distance variations,alternative tree reconstruction algorithms (NJ, UPGMA), genuine column based generalized boostrap procedures. They also support the STRIKE protocol that involves projecting contacts measured within one or more experimental structures onto the sequences these are aligned with and using the <cite>STRIKE &lt;https://academic.oup.com/bioinformatics/article/27/24/3385/306640/STRIKE-evaluation-of-protein-MSAs-using-a-single&gt;</cite> contact matrice to score these contacts in the sequences without known structures.</p>
<section id="generating-a-tree-based-on-3d-intramolecular-distances-conservation">
<h5>Generating a tree based on 3D intramolecular distances conservation<a class="headerlink" href="#generating-a-tree-based-on-3d-intramolecular-distances-conservation" title="Permalink to this heading"></a></h5>
<p>This option makes it possible to estimate a tree while taking into account the variation of intramolecular distances within the considered sequences. It requires in input an alignment (FASTA, MSF, ClustalW…) and a template file (structure files associated with the query sequences). The following command (command 1) will generate a 100 replicate NJ trees using the difference of distances between pairs of aligned residues, at a maximum cut-off of 15A. Columns with less than 50% residues are ignored. It is possible to control the defautl parameters (command 2). The ouput will be a tree in the Newick format with bootstrap supports.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Command 1:
$$: t_coffee -other_pg seq_reformat -in sample_3Dseq1.aln -in2 sample_3Dseq1.template -action \
    +tree replicates 100 +evaluate3D distances +tree2bs first +print_replicates -output newick
</pre></div>
</div>
<p>This command will print the main tree with bootstrap support values (first line). The 100 replicates (+tree replicates 100) will then be printed in the following lines (+print_replicates flag)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Command 2:
$$: t_coffee -other_pg seq_reformat -in sample_3Dseq1.aln -in2 sample_3Dseq1.template -action \
    +tree replicates 100 +evaluate3D distances +tree2bs first +print_replicates -output dm
</pre></div>
</div>
<p>This command will print the main distance matrix in triangular format (first block). The 100 replicates (+tree replicates 100) will then be printed in the following blocks (+print_replicates flag)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Command 3:
$$: t_coffee -other_pg seq_reformat -in sample_3Dseq1.aln -in2 sample_3Dseq1.template -action \
    +tree replicates 100 +evaluate3D distances +tree2bs first +print_replicates -output newick_dm
</pre></div>
</div>
<p>This command will print the newick trees and their corresponding distance matrix in triangular format (first block). The 100 replicates (+tree replicates 100) will then be printed in the following blocks along with the trees (+print_replicates flag). Note that the lines containing trees can be grepped by the “;” symbol they terminate with.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Command 4:
$$: t_coffee -other_pg seq_reformat -in sample_3Dseq1.aln -in2 sample_3Dseq1.template -action \
    +tree replicates 100 gap 0.5 mode nj +evaluate3D distances 15 +tree2bs first -output newick
</pre></div>
</div>
<p>This command will do the same but pairs of residues will only contribute to the distance computation if they are less than 15 Angstroms appart (i.e. when comparing two aligned pairs, both pairs of residues in each sequence must be less than 15 Angstroms appart)</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Sequences without 3D structure will be excluded from the analysis and from the final output.</p>
</div>
</section>
<section id="generating-a-tree-based-on-contact-conservation">
<h5>Generating a tree based on contact conservation<a class="headerlink" href="#generating-a-tree-based-on-contact-conservation" title="Permalink to this heading"></a></h5>
<p>The following option (command 1) makes it possible to estimate a tree while taking into account the variation of contact conservation within the considered sequences. This call will generate a 100 replicate NJ trees using as a distance metrics the fraction of contacts conserved between pairs of aligned residues, at a maximum cutoff of 1.2 A between Van der Waals radius and ignoring the 3 closest neighbors; columns with less than 50% residues are ignored. For sequences without 3D information, the STRIKE contact potential is used instead (Watson and Crick base pairing propensity for RNA). The output will be a tree in Newick format. It is possible to control default parameters using the following extended command line (command 2).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Command 1:
$$: t_coffee -other_pg seq_reformat -in sample_3Dseq1.aln -in2 sample_3Dseq1.template -action \
    +tree replicates 100 +evaluate3D contacts +tree2bs first -output newick -out tree.dnd

Command 2:
$$: t_coffee -other_pg seq_reformat -in sample_3Dseq1.aln -in2 sample_3Dseq1.template -action \
    +tree replicates 100 gap 0.5 mode nj +evaluate3D contacts 1.2 3 +tree2bs first -output \
    newick -out tree.dnd
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The procedure requires at least 1 sequence with a known 3D structure or with contact information.</p>
</div>
</section>
<section id="visualizing-contact-distance-conservation">
<h5>Visualizing contact/distance conservation<a class="headerlink" href="#visualizing-contact-distance-conservation" title="Permalink to this heading"></a></h5>
<p>This same procedure can be used to visualize either intramolecular distance conservation or contact conservation.  The output option <strong>score_raw</strong> generate a tabulated dump of the numerical values associated with every residue, sequence and column of the considered alignment. The flag <strong>-out</strong> specifies the name of the output file containing the results (you can give the name you want, but if you read the documentation so far, you already know it…).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee -other_pg seq_reformat -in sample_3Dseq1.aln -in2 sample_3Dseq1.template \
    -action +evaluate3D distances -output score_html -out out.html

$$: t_coffee -other_pg seq_reformat -in sample_3Dseq1.aln -in2 sample_3Dseq1.template \
    -action +evaluate3D distances -output score_ascii -out out.ascii

$$: t_coffee -other_pg seq_reformat -in sample_3Dseq1.aln -in2 sample_3Dseq1.template \
    -action +evaluate3D distances -output score_raw -out out.tab
</pre></div>
</div>
</section>
<section id="visualizing-informative-positions">
<h5>Visualizing informative positions<a class="headerlink" href="#visualizing-informative-positions" title="Permalink to this heading"></a></h5>
<p>If you have a well defined subgroup of sequences (domains having the same function, same specificity, etc…), it is possible to estimate which columns yield the best support using the following command. The input are an alignment of your sequences, a template file containing the list of structure files to use as templates and a FASTA file of the sequences that form the group whose support you want to analyze. The output will be a colored version of your MSA indicating the sequences that best contribute to your clustering.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee -other_pg seq_reformat -in sample_3Dseq1.aln -in2 sample_3Dseq1.template \
    -action +tree replicates columns +evaluate3D  distances +evaluateTree group_3Dseq1.fasta \
    -output score_html -out out_aln.html
</pre></div>
</div>
</section>
<section id="evaluating-clustering-capacities-under-maintenance">
<h5>Evaluating clustering capacities (under maintenance…)<a class="headerlink" href="#evaluating-clustering-capacities-under-maintenance" title="Permalink to this heading"></a></h5>
<p>If you want to check the capacity of an algorithm to bring related sequences within monophyletic groups, you should name your sequences according to the group they belong to (XXXX_1 for members of group 1; YYYY_2, for members of group 2; etc…) and use the following evaluation procedure. The output will be the number of monophyletic groups containing sequences belonging to the same group. The tree can be precomputed (command 1) or it can be computed on the fly (command 2).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Command</span> <span class="mi">1</span><span class="p">:</span> <span class="n">precomputed</span> <span class="n">tree</span>
<span class="c1">##: t_coffee -other_pg seq_reformat -in &lt;tree&gt; +tree2collapse groups 4 +print nseq -output no</span>

<span class="n">Command</span> <span class="mi">2</span><span class="p">:</span> <span class="n">computed</span> <span class="n">on</span> <span class="n">the</span> <span class="n">fly</span>
<span class="c1">##: t_coffee -other_pg seq_reformat -in &lt;aln&gt; -in2 &lt;template&gt; -action +tree replicates 100 \</span>
    <span class="o">+</span><span class="n">evaluate3D</span>  <span class="n">distances</span> <span class="mi">15</span> <span class="o">+</span><span class="n">tree2bs</span> <span class="n">first</span> <span class="o">+</span><span class="n">tree2collapse</span> <span class="n">groups</span> <span class="mi">4</span> <span class="o">+</span><span class="nb">print</span> <span class="n">nseq</span> <span class="o">-</span><span class="n">output</span> <span class="n">no</span>
</pre></div>
</div>
</section>
<section id="structural-tree-parameters">
<h5>Structural Tree Parameters<a class="headerlink" href="#structural-tree-parameters" title="Permalink to this heading"></a></h5>
<dl class="simple">
<dt>The structural tree parameters come through three distinct flags:</dt><dd><ul class="simple">
<li><p><strong>-tree</strong>                       :Used to pass Tree computation parameters</p></li>
<li><p><strong>* replicates &lt;I=integer&gt; *</strong>  : Indicates how many replicates I are to be produced (def=1) when doing the bootsrap</p></li>
<li><p><strong>* mode &lt;nj|upgma&gt; *</strong>         : Tree computation mode to be used</p></li>
<li><p><strong>* gap  &lt;F=float&gt;*</strong>           : ignores columns with a fraction of gaps higher or equal to F (def=0.5)</p></li>
<li><p><strong>-evaluate3D contacts &lt;MaxD&gt; &lt;Ng&gt;</strong>:Used to estimate the cointact matrix</p></li>
<li><p><strong>*&lt;MAxD=float&gt;*</strong>              : maximum distance between the closest atoms (including side chains) of two residues &lt;def=1.3&gt;</p></li>
<li><p><strong>*&lt;Ng=integer&gt;*</strong>              : Number of excluded neighbours (on both side) &lt;def=3&gt;</p></li>
<li><p><strong>*def*</strong>                       : Any value can be left to its default as follows -evaluate3D contacts def 5 will used 1.2 as maxD and 5 as neighbor cutoff</p></li>
<li><p><strong>-evaluate3D distances &lt;MaxD&gt; &lt;Ng&gt;</strong>:Used to estimate the cointact matrix</p></li>
<li><p><strong>*&lt;MAxD=float&gt;*</strong>              : maximum distance between the closest atoms (including side chains) of two residues &lt;def=15&gt;. When set to 0, all against all distances are computed.</p></li>
<li><p><strong>*&lt;Ng=integer&gt;*</strong>              : Number of excluded neighbours (on both side) &lt;def=3&gt;</p></li>
<li><p><strong>*def*</strong>                       : Any value can be left to its default as follows -evaluate3D contacts def 5 will used 1.2 as maxD and 5 as neighbor cutoff</p></li>
<li><p><strong>-evaluate3D strike &lt;MaxD&gt; &lt;Ng&gt; &lt;mat&gt;</strong>:Used to estimate the cointact matrix</p></li>
<li><p><strong>*&lt;MAxD=float&gt;*</strong>              : maximum distance between the closest atoms (including side chains) of two residues &lt;def=15&gt;</p></li>
<li><p><strong>*&lt;Ng=integer&gt;*</strong>              : Number of excluded neighbours (on both side) &lt;def=3&gt;</p></li>
<li><p><strong>*&lt;mat=string&gt;*</strong>              : strike matrix file (def=”strike”)</p></li>
<li><p><strong>*def*</strong>                       : Any value can be left to its default as follows -evaluate3D contacts def 5 will used 1.2 as maxD and 5 as neighbor cutoff</p></li>
</ul>
</dd>
</dl>
<p>Distance based trees measures are based on a normalized difference of distances between pairs of residues:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="n">AB</span>
<span class="n">Y</span> <span class="n">CD</span>
<span class="n">d1</span><span class="o">=</span><span class="n">d</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
<span class="n">d2</span><span class="o">=</span><span class="n">d</span><span class="p">(</span><span class="n">B</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
<span class="n">score</span><span class="p">(</span><span class="n">AB</span><span class="p">,</span> <span class="n">CD</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="n">Min</span> <span class="p">(</span><span class="n">d1</span><span class="o">/</span><span class="n">d2</span><span class="p">,</span> <span class="n">d2</span><span class="o">/</span><span class="n">d1</span><span class="p">)</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">d1</span>
<span class="n">score</span> <span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span><span class="o">=</span><span class="n">Sum</span><span class="p">(</span><span class="n">score</span><span class="p">(</span><span class="n">AB</span><span class="p">,</span><span class="n">CD</span><span class="p">))</span><span class="o">+</span><span class="n">Sum</span><span class="p">(</span><span class="n">score</span> <span class="p">(</span><span class="n">CD</span><span class="p">,</span> <span class="n">AB</span><span class="p">)</span><span class="o">/</span><span class="n">Sum</span> <span class="p">(</span><span class="n">d</span><span class="p">(</span><span class="n">AB</span><span class="p">))</span><span class="o">+</span><span class="n">Sum</span> <span class="p">(</span><span class="n">d</span><span class="p">(</span><span class="n">CD</span><span class="p">))</span> <span class="n">over</span> <span class="nb">all</span> <span class="n">pairs</span> <span class="k">for</span> <span class="n">which</span> <span class="n">d</span><span class="p">(</span><span class="n">AB</span><span class="p">)</span><span class="o">&gt;=</span><span class="n">MaxD</span> <span class="n">AND</span> <span class="n">d</span><span class="p">(</span><span class="n">CD</span><span class="p">)</span><span class="o">&gt;=</span><span class="n">MaxD</span>
</pre></div>
</div>
</section>
</section>
<section id="the-t-rmsd">
<h4>The T-RMSD<a class="headerlink" href="#the-t-rmsd" title="Permalink to this heading"></a></h4>
<section id="what-is-the-t-rmsd">
<h5>What is the T-RMSD?<a class="headerlink" href="#what-is-the-t-rmsd" title="Permalink to this heading"></a></h5>
<p>T-RMSD (Tree based on Root Mean Square Deviation) is a structure based clustering method using the iRMSD to drive the structural clustering of your aligned sequences with available structures. The T-RMSD supports all the parameters supported by iRMSD or APDB. T-RMSD  is a distance RMSD (dRMSD) based method which generate Structural Trees (analogue to phylogenetic tree) to determine fine-grained structural variations associated with a given Multiple Sequence Alignment (generated by the user using the method of is choice). The specificity of T-RMSD compared to other structural comparison methods stems from its capacity to generate a structural tree with values equivalent bootstrap values supporting the structural clustering. Such clustering is achieved by the construction of matrixes of distances, calculated between equivalent residues as defined by the ungapped columns of the given MSA. The resulting matrixes are then combined using the CONSENSE program from the Phylip package to generate a consensus structural tree with equivalent bootstrap values supporting each node (from 0 to 100; 100 indicating that all positions support the clustering).</p>
</section>
<section id="generating-a-structural-tree-with-support-values">
<h5>Generating a structural tree with support values<a class="headerlink" href="#generating-a-structural-tree-with-support-values" title="Permalink to this heading"></a></h5>
<p>T-RMSD is a special modof T-Coffee. To run T-RMSD, you just need a MSA (generated the way you want) and a template file; you need one structure for each sequence, otherwise these sequences will be excluded from the final results. There are several output files:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;input</span> <span class="pre">name&gt;.struc_tree.list</span></code>: list of all individual trees (one per ungapped column)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;input</span> <span class="pre">name&gt;.struc_tree.consense_output</span></code>: basic consensus tree rendering</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;input</span> <span class="pre">name&gt;.struc_tree.consensus</span></code>: resulting structural tree with support (Newick)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;input</span> <span class="pre">name&gt;.struc_tree.html</span></code>: colored MSA according to the contribution to the clusterin#</p></li>
</ul>
</div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee -other_pg trmsd -aln sample_3Dseq1.aln -template_file sample_3Dseq1.template
</pre></div>
</div>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>Another important information displayed only on screen is the number of usable positions used to build the clustering. If your alignment is too gappy, this percentage will be low and the resulting clustering may not be accurate nor informative; in the previous example, 28.57% of the MSA will be used.</p>
</div>
</section>
<section id="visualizing-the-structural-clustering">
<h5>Visualizing the structural clustering<a class="headerlink" href="#visualizing-the-structural-clustering" title="Permalink to this heading"></a></h5>
<p>T-Coffee have limited tree visualization capacities, yet the T-RMSD delivers two relevant files in this matter: the first one is a basic rendering of the tree with the support values for each node (<code class="docutils literal notranslate"><span class="pre">&lt;input</span> <span class="pre">name&gt;.struc_tree.list</span></code>), the second one is a colored html of the MSA where columns are colored according to their individual support to the final consensus tree (<code class="docutils literal notranslate"><span class="pre">&lt;input</span> <span class="pre">name&gt;.struc_tree.html</span></code>). If you want to visualize/modify the resulting tree, we recommend to use a dedicated tree viewer such as <a class="reference external" href="http://www.phylowidget.org/">PhyloWidget</a>. By default PhyloWidget is used by the T-RMSD web server, but as the format is standard (Newick format) you can use any viewer you want (iTOL, ETE, FigTree, Phylodendron, etc…)</p>
</section>
</section>
<section id="the-tcs">
<h4>The TCS<a class="headerlink" href="#the-tcs" title="Permalink to this heading"></a></h4>
<p>The TCS (Transitive Consistency Score) is a measure of consistency between a multiple sequence alignmment and a library of pairwise alignments of the same sequences. In the original <cite>publication &lt;https://academic.oup.com/mbe/article/31/6/1625/2925802/TCS-A-New-Multiple-Sequence-Alignment-Reliability&gt;</cite> the TCS score was shown to correlate well with local structural accuracy and with the phylogenic reconstruction potential of individual MSA columns. As such the TCS can therefore be used to down-weight or filter out the less reliable positions. The TCS is available as <cite>&gt;web-server http://tcoffee.crg.cat/apps/tcoffee/do:core&gt;</cite> and its command line usage is described in details in an <cite>earlier section &lt;http://tcoffee.readthedocs.io/en/latest/tcoffee_main_documentation.html#transitive-consistency-score-tcs&gt;</cite> of this documentation.</p>
<p>It can be used to evaluate and compare existing alignmnets
. The original publication describing it is available
described in the previous subsection as it is mainly an evaluation tool. It has however several option that are relevant for downstream analysis such weighting and/or trimming MSA for phylogenetic reconstruction. It was demonstrated that TCS was able to improve phylogenetic reconstruction, you are welcome to look at the publication for more details.</p>
</section>
</section>
<section id="internal-external-methods">
<h3>Internal/External Methods<a class="headerlink" href="#internal-external-methods" title="Permalink to this heading"></a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The real power of T-Coffee is its ability to seamlessly combine many methods into one. While we try to integrate as many methods as we can in the default distribution, we do not have the means to be exhaustive and if you desperately need your favorite method to be integrated, you will need to bite the bullet …</p>
</div>
<section id="what-are-the-methods-already-integrated-in-t-coffee">
<h4>What are the methods already integrated in T-Coffee?<a class="headerlink" href="#what-are-the-methods-already-integrated-in-t-coffee" title="Permalink to this heading"></a></h4>
<p>Although, it does not necessarily do so explicitly, T-Coffee always end up combining libraries (collections of pairs of residues). Given a set of libraries, T-Coffee makes an attempt to assemble the alignment with the highest level of consistence. You can think of the alignment as a timetable, each library pair being a request from students or teachers, and the job of T-Coffee would be to assemble the time table that makes as many people as possible happy…In T-Coffee, methods replace the students/professors to generate constraints. These methods can be any standard/non standard alignment methods that can be used to generate alignments (pairwise, most of the time). These alignments can be viewed as collections of constraints that must be fit within the final alignment. Of course, the constraints do not have to agree with one another…</p>
<p>This section shows you what are the available method in T-Coffee, and how you can add your own methods either through direct parameterization or via a perl script. There are two kinds of methods: the internal and the external. For the internal methods, you simply need to have T-Coffee up and running. The external methods are generally installed with T-Coffee (when using the installer), but if you have problems with some packages, refer to the <strong>T-Coffee Installation</strong> chapter.</p>
<section id="internal-methods-built-in">
<h5>INTERNAL methods (built-in)<a class="headerlink" href="#internal-methods-built-in" title="Permalink to this heading"></a></h5>
<p>Internal methods can be requested using the following names:</p>
<ul class="simple">
<li><p><strong>proba_pair</strong>: adapted from ProbCons, this method (the current default) uses a pair HMM to compute a pairwise alignment with a biphasic gap penalty.</p></li>
<li><p><strong>fast_pair</strong>: makes a global fasta style pairwise alignment. For proteins: <strong>matrix=blosum62mt, gep=-1, gop=-10, ktup=2</strong>. For DNA, <strong>matrix=idmat (id=10), gep=-1, gop=-20, ktup=5</strong>. Each pair of residue is given a score function of the weighting mode defined by <strong>-weight</strong>.</p></li>
<li><p><strong>slow_pair</strong>: identical to fast pair, but does a full dynamic programming, using the myers and miller algorithm. This method is recommended if your sequences are distantly related.</p></li>
<li><p><strong>ifast_pair</strong>: iterative fast_pair.</p></li>
<li><p><strong>islow_pair</strong>: makes a global fasta alignmnet using the previously computed pairs as a library. <cite>i</cite> stands for iterative. Each pair of residue is given a score function of the weighting mode defined by <strong>-weight</strong>. The library used for the computation is the one computed before the method is used. The result is therefore dependent on the order in methods and library are set via the <strong>-in</strong> flag.</p></li>
<li><p><strong>align_pdb_pair</strong>: uses the <strong>align_pdb</strong> routine to align two structures. The pairwise scores are those returnes by the <strong>align_pdb</strong> program. If a structure is missing, fast_pair is used instead. Each pair of residue is given a score function defined by align_pdb. [UNSUPPORTED]</p></li>
<li><p><strong>lalign_id_pair</strong>: uses the ten top non intersecting local alignments, as delivered by lalign. Each alignement is weighted with its average percent identity.</p></li>
<li><p><strong>lalign_rs_s_pair</strong>: Same as above but does also does self comparison and uses the lalign raw_score (s stands for self). This is needed when extracting repeats. [UNSUPPORTED]</p></li>
<li><p><strong>Matrix Amy</strong>: matrix can be requested, simply indicate as a method the name of the matrix preceded with an X (i.e. Xpam250mt). If you indicate such a matrix, all the other methods will simply be ignored, and a standard fast progressive alignment will be computed. If you want to change the substitution matrix used by the methods, use the <strong>-matrix</strong> flag.</p></li>
<li><p><strong>cdna_fast_pair</strong>: this method computes the pairwise alignment of two cDNA sequences. It is a fast_pair alignment that only takes into account the aminoacid similarity with different penalties for insertions and frameshifts. This alignment is turned into a library where matched nucleotides receive a score equal to the average level of identity at the aminoacid level. This mode is intended to clean cDNA obtained from ESTs or to align pseudo-genes. [UNSUPPORTED]</p></li>
</ul>
</section>
<section id="external-methods-plug-in">
<h5>EXTERNAL methods (plug-in)<a class="headerlink" href="#external-methods-plug-in" title="Permalink to this heading"></a></h5>
<p>External methods correspond to packages developed by other groups that you may want to run within T-Coffee. We are very open to extending these options and we welcome any request to add an extra interface. To have a complete list of the methods that can be used as plug-ins, just type <strong>t_coffee</strong> in a terminal, it will we displayed on your screen. Most of these methods can be used as either pairwise (<strong>&lt;method&gt;_pair</strong>) or multiple alignment methods (<strong>&lt;method&gt;_msa</strong>); note that all these methods use Blosum62 as a default.</p>
<p>One package is a bit different; <strong>fugue_pair</strong> uses a standard FUGUE installation to make a sequence/structure alignment. Installation must be standard but it does not have to include all the FUGUE packages but only:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Required</span> <span class="n">packages</span><span class="p">:</span>
<span class="mi">1</span><span class="p">)</span> <span class="n">joy</span><span class="p">,</span> <span class="n">melody</span><span class="p">,</span> <span class="n">fugueali</span><span class="p">,</span> <span class="n">sstruc</span><span class="p">,</span> <span class="n">hbond</span>
<span class="mi">2</span><span class="p">)</span> <span class="n">copy</span> <span class="n">fugue</span><span class="o">/</span><span class="n">classdef</span><span class="o">.</span><span class="n">dat</span> <span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">fugue</span><span class="o">/</span><span class="n">SUBST</span><span class="o">/</span><span class="n">classdef</span><span class="o">.</span><span class="n">dat</span>

<span class="n">Configuration</span><span class="p">:</span>
<span class="c1">##: setenv MELODY_CLASSDEF=&lt;location&gt;</span>
<span class="c1">##: setenv MELODY_SUBST=fugue/allmat.dat</span>
</pre></div>
</div>
</section>
</section>
<section id="modifying-the-parameters-of-internal-external-methods">
<h4>Modifying the parameters of INTERNAL/EXTERNAL methods<a class="headerlink" href="#modifying-the-parameters-of-internal-external-methods" title="Permalink to this heading"></a></h4>
<section id="internal-methods">
<h5>Internal methods<a class="headerlink" href="#internal-methods" title="Permalink to this heading"></a></h5>
<p>It is possible to modify on the fly the parameters of hard coded methods (<strong>EP</strong> stands for Extra parameters). These parameters will superseed any other parameters.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee sample_seq1.fasta -method slow_pair@EP@MATRIX@pam250mt@GOP@-10@GEP@-1
</pre></div>
</div>
</section>
<section id="external-methods">
<h5>External methods<a class="headerlink" href="#external-methods" title="Permalink to this heading"></a></h5>
<p>External methods receive a command line built with the information provided via the parameter file (see next heading). It is possible to produce such a parameter file and to modify it in order to modify the commands passed to the methods. The passed command is built as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">##: &lt;EXECUTABLE&gt;&lt;PARAM1&gt;&lt;IN_FLAG&gt;&lt;seq_file&gt;&lt;PARAM2&gt;&lt;OUT_FLAG&gt;&lt;outname&gt;&lt;PARAM&gt;</span>
</pre></div>
</div>
<p>You should know what is the best place for squizing your extra parameters. It will depend on the application, although PARAM2 is usually a good guess. Now if you want, for instance to modify the gap penalty of clustalw, you can try the following (of course, you must know the command line of the program you are trying to modify (ClustalW in this case):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee sample_seq1.fasta -method clustalw_msa@EP@PARAM2@-GAPOPEN%e100%s-GAPEXT%e10

&lt;@EP&gt;     : indicates that you will pass an extra parameter
&lt;@PARAM1&gt; : is the name of this parameter
&lt;%s&gt;      : replaces spaces
&lt;%e&gt;      : replaces the equal sign
</pre></div>
</div>
</section>
</section>
<section id="integrating-external-methods">
<h4>Integrating EXTERNAL methods<a class="headerlink" href="#integrating-external-methods" title="Permalink to this heading"></a></h4>
<p>If the method you need is not already included in T-Coffee, you will need to integrate it yourself. We give you here some guidelines on how to do so.</p>
<section id="accessing-external-methods">
<h5>Accessing external methods<a class="headerlink" href="#accessing-external-methods" title="Permalink to this heading"></a></h5>
<p>A special method exists in T-Coffee that can be used to invoke any existing program (command 1): for instance, ClustalwWis a method that can be ran with the command 2. Here is just an example but ClustalW can be replaced with any method using a similar syntax. If the program you want to use cannot be run this way, you can either write a perl wrapper that fits the bill or write a <code class="docutils literal notranslate"><span class="pre">tc_method</span></code> file adapted to your program (cf. next section). This special method (<strong>em</strong> for external method) uses a particular syntax (command 3).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Command 1: T-Coffee using ClustalW
$*: t_coffee sample_seq1.fasta -method=em@clustalw@pairwise

Command 2: ClustalW command
##: method -infile=&lt;infile&gt; -outfile=&lt;outfile&gt;

Command 3: Syntax for EXTERNAL methods
##: em@&lt;method&gt;@&lt;aln_mode:pairwises_pairwise|multiple&gt;
</pre></div>
</div>
</section>
<section id="customizing-an-external-method">
<h5>Customizing an external method<a class="headerlink" href="#customizing-an-external-method" title="Permalink to this heading"></a></h5>
<p>T-Coffee can run external method using a <code class="docutils literal notranslate"><span class="pre">tc_method</span></code> file that can be used in place of an established method. Two such files are incorporated in T-Coffee (<code class="docutils literal notranslate"><span class="pre">clustalw_method.tc_method</span></code> and <code class="docutils literal notranslate"><span class="pre">generic_method.tc_method</span></code>). You can dump them and customize them according to your needs. The first file is a very straightforward example on how to run Clustalw via T-Coffee with a set of parameters you may be interested in. Note that <strong>ALN_MODE</strong> instructs T_Coffee to run ClustalW on every pair of sequences. The second file is detailed in the next section.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>1) Getting the configuration file:
$$: t_coffee -other_pg unpack_clustalw_method.tc_method

2) Format of the configuration file:
*TC_METHOD_FORMAT_01

***************clustalw_method.tc_method*********
EXECUTABLE clustalw
ALN_MODE pairwise
IN_FLAG -INFILE=
OUT_FLAG -OUTFILE=
OUT_MODE aln
PARAM -gapopen=-10
SEQ_TYPE S
*************************************************

3) The configuration file will cause T-Coffee to emit the following system call:
##: clustalw -INFILE=tmpfile1 -OUTFILE=tmpfile2 -gapopen=-10

4) Running ClustalW via T-Coffee (in your working DIR):
$$: t_coffee sample_seq1.fasta -method clustalw_method.tc_method
</pre></div>
</div>
</section>
<section id="advanced-method-integration">
<h5>Advanced method integration<a class="headerlink" href="#advanced-method-integration" title="Permalink to this heading"></a></h5>
<p>It may sometimes be difficult to customize the program you want to use through a <code class="docutils literal notranslate"><span class="pre">tc_method</span> <span class="pre">file</span></code>. In that case, you may rather use an external perl_script to run your external application. This can easily be achieved using the <code class="docutils literal notranslate"><span class="pre">generic_method.tc_method</span></code> file which contains many hints on how to customize your new method. The <code class="docutils literal notranslate"><span class="pre">tc_method</span></code> files are treated like any standard established method in T-Coffee.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>1) Using any generic method
$$: t_coffee -other_pg unpack_generic_method.tc_method

2) Format of the configuration file:
*TC_METHOD_FORMAT_01
***************generic_method.tc_method*********
EXECUTABLE tc_generic_method.pl
ALN_MODE pairwise
IN_FLAG -infile=
OUT_FLAG -outfile=
OUT_MODE aln
PARAM -method clustalw
PARAM -gapopen=-10
SEQ_TYPE S
*************************************************
* Note: &amp;amp;bsnp can be used to for white spaces

3) Run the method:
$*: t_coffee sample_seq1.fasta -method generic_method.tc_method
</pre></div>
</div>
<p>T-Coffee runs the script <strong>tc_generic_method.pl</strong> on your data. It also provides the script with parameters. In the case <strong>-method clustalw</strong> indicates that the script should run ClustalW on your data. Over the time, this script will be the place where novel methods will be integrated and make it possible to run any available method. It will be used to run the script <strong>tc_generic_method.pl</strong>, a perl script automatically generated by T-Coffee.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If there is a copy of that script in your local directory, that copy will be used in place of the internal copy of T-Coffee.</p>
</div>
</section>
<section id="the-mother-of-all-method-files">
<h5>The mother of all method files…<a class="headerlink" href="#the-mother-of-all-method-files" title="Permalink to this heading"></a></h5>
<p>Here is the mother of all configuration file for T-Coffee:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">*</span><span class="n">TC_METHOD_FORMAT_01</span>
<span class="o">******************</span><span class="n">generic_method</span><span class="o">.</span><span class="n">tc_method</span><span class="o">*************</span>
<span class="o">*</span>
<span class="o">*</span> <span class="n">Incorporating</span> <span class="n">new</span> <span class="n">methods</span> <span class="ow">in</span> <span class="n">T</span><span class="o">-</span><span class="n">Coffee</span>
<span class="o">*</span> <span class="n">Cedric</span> <span class="n">Notredame</span> <span class="mi">17</span><span class="o">/</span><span class="mi">04</span><span class="o">/</span><span class="mi">05</span>
<span class="o">*</span>
<span class="o">*******************************************************</span>
<span class="o">*</span><span class="n">This</span> <span class="n">file</span> <span class="ow">is</span> <span class="n">a</span> <span class="n">method</span> <span class="n">file</span>
<span class="o">*</span><span class="n">Copy</span> <span class="n">it</span> <span class="ow">and</span> <span class="n">adapt</span> <span class="n">it</span> <span class="n">to</span> <span class="n">your</span> <span class="n">need</span> <span class="n">so</span> <span class="n">that</span> <span class="n">the</span> <span class="n">method</span>
<span class="o">*</span><span class="n">you</span> <span class="n">want</span> <span class="n">to</span> <span class="n">use</span> <span class="n">can</span> <span class="n">be</span> <span class="n">incorporated</span> <span class="n">within</span> <span class="n">T</span><span class="o">-</span><span class="n">Coffee</span>
<span class="o">******************************************************</span>
<span class="o">*</span> <span class="n">USAGE</span> <span class="o">*</span>
<span class="o">*******************************************************</span>
<span class="o">*</span><span class="n">This</span> <span class="n">file</span> <span class="ow">is</span> <span class="n">passed</span> <span class="n">to</span> <span class="n">t_coffee</span> <span class="n">via</span> <span class="o">-</span><span class="ow">in</span><span class="p">:</span>
<span class="o">*</span>
<span class="o">*</span> <span class="n">t_coffee</span> <span class="o">-</span><span class="ow">in</span> <span class="n">Mgeneric_method</span><span class="o">.</span><span class="n">method</span>
<span class="o">*</span>
<span class="o">*</span><span class="n">The</span> <span class="n">method</span> <span class="ow">is</span> <span class="n">passed</span> <span class="n">to</span> <span class="n">the</span> <span class="n">shell</span> <span class="n">using</span> <span class="n">the</span> <span class="n">following</span>
<span class="o">*</span><span class="n">call</span><span class="p">:</span>
<span class="o">*&lt;</span><span class="n">EXECUTABLE</span><span class="o">&gt;&lt;</span><span class="n">IN_FLAG</span><span class="o">&gt;&lt;</span><span class="n">seq_file</span><span class="o">&gt;&lt;</span><span class="n">OUT_FLAG</span><span class="o">&gt;&lt;</span><span class="n">outname</span><span class="o">&gt;&lt;</span><span class="n">PARAM</span><span class="o">&gt;</span>
<span class="o">*</span>
<span class="o">*</span><span class="n">Conventions</span><span class="p">:</span>
<span class="o">*&lt;</span><span class="n">FLAG_NAME</span><span class="o">&gt;</span>  <span class="o">&lt;</span><span class="n">TYPE</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">VALUE</span><span class="o">&gt;</span>
<span class="o">*&lt;</span><span class="n">VALUE</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">no_name</span>  <span class="o">&lt;=&gt;</span> <span class="n">Replaced</span> <span class="k">with</span> <span class="n">a</span> <span class="n">space</span>
<span class="o">*&lt;</span><span class="n">VALUE</span><span class="o">&gt;</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span><span class="n">nbsp</span> <span class="o">&lt;=&gt;</span> <span class="n">Replaced</span> <span class="k">with</span> <span class="n">a</span> <span class="n">space</span>
<span class="o">*</span>
<span class="o">*******************************************************</span>
<span class="o">*</span> <span class="n">EXECUTABLE</span> <span class="o">*</span>
<span class="o">*******************************************************</span>
<span class="o">*</span><span class="n">name</span> <span class="n">of</span> <span class="n">the</span> <span class="n">executable</span>
<span class="o">*</span><span class="n">passed</span> <span class="n">to</span> <span class="n">the</span> <span class="n">shell</span><span class="p">:</span> <span class="n">executable</span>
<span class="o">*</span>
<span class="n">EXECUTABLE</span> <span class="n">tc_generic_method</span><span class="o">.</span><span class="n">pl</span>
<span class="o">*</span>
<span class="o">*******************************************************</span>
<span class="o">*</span> <span class="n">ALN_MODE</span> <span class="o">*</span>
<span class="o">*******************************************************</span>
<span class="o">*</span><span class="n">pairwise</span> <span class="o">-&gt;</span><span class="nb">all</span> <span class="n">Vs</span> <span class="nb">all</span> <span class="p">(</span><span class="n">no</span> <span class="bp">self</span> <span class="p">)[(</span><span class="n">n2</span><span class="o">-</span><span class="n">n</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="n">aln</span><span class="p">]</span>
<span class="o">*</span><span class="n">m_pairwise</span> <span class="o">-&gt;</span><span class="nb">all</span> <span class="n">Vs</span> <span class="nb">all</span> <span class="p">(</span><span class="n">no</span> <span class="bp">self</span><span class="p">)[</span><span class="n">n</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">n</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span>
<span class="o">*</span><span class="n">s_pairwise</span> <span class="o">-&gt;</span><span class="nb">all</span> <span class="n">Vs</span> <span class="nb">all</span> <span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="p">[</span><span class="n">n</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">n</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">n</span>
<span class="o">*</span><span class="n">multiple</span> <span class="o">-&gt;</span><span class="n">All</span> <span class="n">the</span> <span class="n">sequences</span> <span class="ow">in</span> <span class="n">one</span> <span class="n">go</span>
<span class="o">*</span>
<span class="n">ALN_MODE</span> <span class="n">pairwise</span>
<span class="o">*</span>
<span class="o">*******************************************************</span>
<span class="o">*</span> <span class="n">OUT_MODE</span> <span class="o">*</span>
<span class="o">*******************************************************</span>
<span class="o">*</span><span class="n">mode</span> <span class="k">for</span> <span class="n">the</span> <span class="n">output</span><span class="p">:</span>
<span class="o">*</span><span class="n">External</span> <span class="n">methods</span><span class="p">:</span>
<span class="o">*</span> <span class="n">aln</span> <span class="o">-&gt;</span> <span class="n">Alignmnent</span> <span class="n">file</span> <span class="p">(</span><span class="n">Fasta</span> <span class="ow">or</span> <span class="n">ClustalW</span> <span class="n">Format</span><span class="p">)</span>
<span class="o">*</span> <span class="n">lib</span><span class="o">-&gt;</span> <span class="n">Library</span> <span class="n">file</span> <span class="p">(</span><span class="n">TC_LIB_FORMAT_01</span><span class="p">)</span>
<span class="o">*</span><span class="n">Internal</span> <span class="n">Methods</span><span class="p">:</span>
<span class="o">*</span> <span class="n">fL</span> <span class="o">-&gt;</span> <span class="n">Internal</span> <span class="n">Function</span> <span class="n">returning</span> <span class="n">a</span> <span class="n">Lib</span> <span class="p">(</span><span class="n">Library</span><span class="p">)</span>
<span class="o">*</span> <span class="n">fA</span> <span class="o">-&gt;</span> <span class="n">Internal</span> <span class="n">Function</span> <span class="n">returning</span> <span class="n">an</span> <span class="n">Alignmnent</span>
<span class="o">*</span>
<span class="n">OUT_MODE</span> <span class="n">aln</span>
<span class="o">*</span>
<span class="o">*******************************************************</span>
<span class="o">*</span> <span class="n">IN_FLAG</span> <span class="o">*</span>
<span class="o">*******************************************************</span>
<span class="o">*</span><span class="n">IN_FLAG</span>
<span class="o">*</span><span class="n">flag</span> <span class="n">indicating</span> <span class="n">the</span> <span class="n">name</span> <span class="n">of</span> <span class="n">the</span> <span class="ow">in</span> <span class="n">coming</span> <span class="n">sequences</span>
<span class="o">*</span><span class="n">IN_FLAG</span> <span class="n">no_name</span> <span class="o">-&gt;</span><span class="n">no</span> <span class="n">flag</span>
<span class="o">*</span><span class="n">IN_FLAG</span> <span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span><span class="n">nbsp</span><span class="o">-</span><span class="ow">in</span><span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span><span class="n">nbsp</span> <span class="o">-&gt;</span> <span class="s1">&#39; -in &#39;</span>
<span class="o">*</span>
<span class="n">IN_FLAG</span> <span class="o">-</span><span class="n">infile</span><span class="o">=</span>
<span class="o">*</span>
<span class="o">*******************************************************</span>
<span class="o">*</span> <span class="n">OUT_FLAG</span> <span class="o">*</span>
<span class="o">*******************************************************</span>
<span class="o">*</span><span class="n">OUT_FLAG</span>
<span class="o">*</span><span class="n">flag</span> <span class="n">indicating</span> <span class="n">the</span> <span class="n">name</span> <span class="n">of</span> <span class="n">the</span> <span class="n">out</span><span class="o">-</span><span class="n">coming</span> <span class="n">data</span>
<span class="o">*</span><span class="n">same</span> <span class="n">conventions</span> <span class="k">as</span> <span class="n">IN_FLAG</span>
<span class="o">*</span><span class="n">OUT_FLAG</span> <span class="n">no_name</span> <span class="o">-&gt;</span><span class="n">no</span> <span class="n">flag</span>
<span class="o">*</span>
<span class="n">OUT_FLAG</span> <span class="o">-</span><span class="n">outfile</span><span class="o">=</span>
<span class="o">*</span>
<span class="o">*******************************************************</span>
<span class="o">*</span> <span class="n">SEQ_TYPE</span> <span class="o">*</span>
<span class="o">*******************************************************</span>
<span class="o">*</span><span class="n">G</span><span class="p">:</span> <span class="n">Genomic</span><span class="p">,</span> <span class="n">S</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">,</span> <span class="n">P</span><span class="p">:</span> <span class="n">PDB</span><span class="p">,</span> <span class="n">R</span><span class="p">:</span> <span class="n">Profile</span>
<span class="o">*</span><span class="n">Examples</span><span class="p">:</span>
<span class="o">*</span><span class="n">SEQTYPE</span> <span class="n">S</span> <span class="n">sequences</span> <span class="n">against</span> <span class="n">sequences</span> <span class="p">(</span><span class="n">default</span><span class="p">)</span>
<span class="o">*</span><span class="n">SEQTYPE</span> <span class="n">S_P</span> <span class="n">sequence</span> <span class="n">against</span> <span class="n">structure</span>
<span class="o">*</span><span class="n">SEQTYPE</span> <span class="n">P_P</span> <span class="n">structure</span> <span class="n">against</span> <span class="n">structure</span>
<span class="o">*</span><span class="n">SEQTYPE</span> <span class="n">PS</span> <span class="n">mix</span> <span class="n">of</span> <span class="n">sequences</span> <span class="ow">and</span> <span class="n">structure</span>
<span class="o">*</span>
<span class="n">SEQ_TYPE</span> <span class="n">S</span>
<span class="o">*</span>
<span class="o">*******************************************************</span>
<span class="o">*</span> <span class="n">PARAM</span> <span class="o">*</span>
<span class="o">*******************************************************</span>
<span class="o">*</span><span class="n">Parameters</span> <span class="n">sent</span> <span class="n">to</span> <span class="n">the</span> <span class="n">EXECUTABLE</span>
<span class="o">*</span><span class="n">If</span> <span class="n">there</span> <span class="ow">is</span> <span class="n">more</span> <span class="n">than</span> <span class="mi">1</span> <span class="n">PARAM</span> <span class="n">line</span><span class="p">,</span> <span class="n">the</span> <span class="n">lines</span> <span class="n">are</span>
<span class="o">*</span><span class="n">concatenated</span>
<span class="o">*</span>
<span class="n">PARAM</span> <span class="o">-</span><span class="n">method</span> <span class="n">clustalw</span>
<span class="n">PARAM</span> <span class="o">-</span><span class="n">OUTORDER</span><span class="o">=</span><span class="n">INPUT</span> <span class="o">-</span><span class="n">NEWTREE</span><span class="o">=</span><span class="n">core</span> <span class="o">-</span><span class="n">align</span> <span class="o">-</span><span class="n">gapopen</span><span class="o">=-</span><span class="mi">15</span>
<span class="o">*</span>
<span class="o">*******************************************************</span>
<span class="o">*</span> <span class="n">END</span> <span class="o">*</span>
<span class="o">*******************************************************</span>
</pre></div>
</div>
</section>
<section id="weighting-your-method">
<h5>Weighting your method<a class="headerlink" href="#weighting-your-method" title="Permalink to this heading"></a></h5>
<p>By default, the alignment produced by your method will be weighted according to its percent identity. However, this can be customized via the <strong>WEIGHT</strong> parameter, which supports all the values of the <strong>-weight</strong> flag. The only difference is that the <strong>-weight</strong> value thus declared will only be applied onto your method. If needed you can also modify on the fly the WEIGHT value of your method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Increases by a factor 2 the weight of slow_pair:
$$: t_coffee sample_seq1.fasta -method slow_pair@WEIGHT@OW2

Causes every pair of slow_pair to have a weight equal to 250:
$$: t_coffee sample_seq1.fasta -method slow_pair@WEIGHT@250
</pre></div>
</div>
</section>
<section id="managing-a-collection-of-method-files">
<h5>Managing a collection of method files<a class="headerlink" href="#managing-a-collection-of-method-files" title="Permalink to this heading"></a></h5>
<p>It may be convenient to store all the method files in a single location on your system. By default, T-Coffee will go looking into the directory ~/.t_coffee/methods/. You can change this by either modifying the <strong>METHODS_4_TCOFFEE</strong> in <code class="docutils literal notranslate"><span class="pre">define_headers.h</span></code> (and recompile) or by modifying the environement variable <strong>METHODS_4_TCOFFEE**</strong>.</p>
</section>
</section>
<section id="creating-your-own-t-coffee-libraries">
<h4>Creating your own T-Coffee libraries<a class="headerlink" href="#creating-your-own-t-coffee-libraries" title="Permalink to this heading"></a></h4>
<p>If the method you want to use is not integrated or impossible to integrate, you can generate your own libraries, either directly or by turning existing alignments into libraries. You may also want to precompute your libraries, in order to combine them at your convenience.</p>
<section id="using-precomputed-alignments">
<h5>Using precomputed alignments<a class="headerlink" href="#using-precomputed-alignments" title="Permalink to this heading"></a></h5>
<p>If the method you wish to use is not supported, or if you simply have the alignments, the simplest thing to do is to generate yourself the pairwise/multiple alignments, in FASTA, ClustalW, MSF or PIR format and feed them into T-Coffee. You can even combine multiple MSAs (refers to subsection <strong>Combining multiple MSAs</strong>).</p>
</section>
<section id="customizing-the-weighting-scheme">
<h5>Customizing the weighting scheme<a class="headerlink" href="#customizing-the-weighting-scheme" title="Permalink to this heading"></a></h5>
<p>The previous integration method forces you to use the same weighting scheme for each alignment and the rest of the libraries generated on the fly. This weighting scheme is based on global pairwise sequence identity. If you want to use a more specific weighting scheme with a given method, you should either generate your own library (command 1) or convert your alignment into a library (command 2), or use the <strong>-weight</strong> flag (command 3).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Command 1:
$$: t_coffee -aln=sample_aln1.aln,sample_aln2.aln -method=fast_pair,lalign_id_pair

Command 2:
$$: t_coffee -aln sample_aln1.aln -lib=test_lib.tc_lib

Command 3:
$$: t_coffee -aln sample_aln1.aln -out_lib=test_lib.tc_lib -lib_only -weight=sim_pam250mt
</pre></div>
</div>
</section>
<section id="generating-your-own-libraries">
<h5>Generating your own libraries<a class="headerlink" href="#generating-your-own-libraries" title="Permalink to this heading"></a></h5>
<p>This is suitable if you have local alignments, or very detailed information about your potential residue pairs, or if you want to use a very specific weighting scheme. You will need to generate your own libraries using the format described in the last section. You may also want to precompute your libraries in order to save them for further use. For instance, in the following example, we generate the local (command 1) and the global (command 2) libraries and later reuse them for combination into a multiple alignment. Once these libraries have been computed, you can then combine them at your convenience in a single MSA (command 3). Of course you can decide to only use the local or the global library.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Command 1:
$$: t_coffee sample_seq1.fasta -method lalign_id_pair -out_lib lalign_id_pair_seq1.tc_lib \
    -lib_only

Command 2:
$$: t_coffee sample_seq1.fasta -method slow_pair -out_lib slow_pair_seq1.tc_lib -lib_only

Command 3:
$$: t_coffee sample_seq1.fasta -lib lalign_id_pair_seq1.tc_lib, slow_pair_seq1.tc_lib
</pre></div>
</div>
</section>
</section>
<section id="plug-out-using-t-coffee-as-a-plug-in">
<h4>Plug-out: using T-Coffee as a plug-in<a class="headerlink" href="#plug-out-using-t-coffee-as-a-plug-in" title="Permalink to this heading"></a></h4>
<p>Just because it enjoys enslaving other methods as plug-in does not mean that T-Coffee does not enjoy being incorporated within other packages. We try to give as much support as possible to anyone who wishes to incorporate T-Coffee in an alignment pipeline. If you want to do so, please work out some way to incorporate T-Coffee in your script. If you need some help along the way, do not hesitate to ask, as we will always be happy to either give assistance or even modify the package so that it accomodates as many needs as possible. Once that procedure is over, set aside a couple of input files with the correct parameterisation and send them to us. These will be included as a distribution test, to insure that any further distribution remains compliant with your application.</p>
</section>
</section>
</section>
<span id="document-tcoffee_technical_documentation"></span><section id="t-coffee-technical-documentation">
<h2>T-Coffee Technical Documentation<a class="headerlink" href="#t-coffee-technical-documentation" title="Permalink to this heading"></a></h2>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This chapter has been extensively updated in 11/2016. The <strong>T-Coffee Technical Documentation</strong> covers the different parameters, flags and options. Everything described here should be working from T-Coffee version 9.03 and higher, yet there is a trade-off between new options present in the most recent versions and old options now deprecated, unsupported or substituted by new ones (don’t worry it will specified in the documentation).</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>T-Coffee is not POSIX compliant (sorry !!!).</p>
</div>
<section id="t-coffee-parameters-flags">
<h3>T-Coffee Parameters &amp; Flags<a class="headerlink" href="#t-coffee-parameters-flags" title="Permalink to this heading"></a></h3>
<section id="t-coffee-general-information">
<h4>T-Coffee general information<a class="headerlink" href="#t-coffee-general-information" title="Permalink to this heading"></a></h4>
<section id="general-syntax">
<h5>General syntax<a class="headerlink" href="#general-syntax" title="Permalink to this heading"></a></h5>
<p>About the syntax of T-Coffee command lines, just for you to know that T-Coffee is quite flexible, you can use any kind of separator you want (i.e. , ; &lt;space&gt; =). The syntax used in this document is meant to be consistent with that of ClustalW. However, in order to take advantage of the automatic filename completion provided by many shells, you can replace ‘=’ and ‘,’ with a space.</p>
</section>
<section id="t-coffee-flags">
<h5>T-Coffee flags<a class="headerlink" href="#t-coffee-flags" title="Permalink to this heading"></a></h5>
<p>This documentation gives a list of all the flags that can be used to modify the behavior of T-Coffee; for your convenience, we have grouped them according to their nature. When running T-Coffee, some options and their associated values or parameters will be displayed on screen (command 1). You can also display the list of all the flags (command 2) or a single flag (command 3) used in the version of T-Coffee you are using along with their default value type.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Command 1:
$$: t_coffee

Command 2:
$$: t_coffee -help

Command 3:
$#: t_coffee -help -&lt;flag&gt;
</pre></div>
</div>
</section>
<section id="setting-up-the-parameters">
<h5>Setting up the parameters<a class="headerlink" href="#setting-up-the-parameters" title="Permalink to this heading"></a></h5>
<p>There are many ways to enter parameters in T-Coffee (see the <strong>-parameters</strong> flag). In general you won’t need to use these complicated parameters, yet, if you find yourself typing long command lines on a regular basis it may be worth reading this section. One may easily feel confused with the various manners in which the parameters can be passed to T-Coffee. The reason for these many mechanisms is that they allow several levels of intervention. For instance, you may install T-Coffee for all the users and decide that the defaults we provide are not the proper ones…In this case, you will need to make your own <code class="docutils literal notranslate"><span class="pre">t_coffee_default</span></code> file. Later on, a user may find that he/she needs to keep reusing a specific set of parameters, different from those in <code class="docutils literal notranslate"><span class="pre">t_coffee_default</span></code>, hence the possibility to write an extra parameter file with the flag <strong>-parameters</strong>. In summary, this means that <strong>-parameters</strong> supersede all the other options, while parameters provided via <strong>-mode</strong> are the weakest.</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>Priorities: “-parameters” &gt; “prompt parameters” &gt; “-t_coffee_defaults” &gt; “-mode”</p>
</div>
</section>
<section id="setting-up-the-variables">
<h5>Setting up the variables<a class="headerlink" href="#setting-up-the-variables" title="Permalink to this heading"></a></h5>
<p>It is possible to modify T-Coffee’s behavior by setting any of the following environment variables. With the bash shell, use <strong>export VAR=’value’</strong>; with the cshell, use <strong>set $VAR=’value’</strong>. Here is a list of variables in T-Coffee:</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>http_proxy_4_TCOFFEE</strong>: sets the http_proxy and HTTP_proxy values used by T-Coffee. These values supersede http_proxy and HTTP_proxy while http_proxy_4_TCOFFEE gets superseded by the command line values <strong>-proxy</strong> and <strong>-email</strong>; if you have no proxy, just set this value to an empty string.</p></li>
<li><p><strong>email_4_TCOFFEE</strong>: sets the E-mail values provided to web services called upon by T-Coffee; can be overriden by the flag <strong>-email</strong>.</p></li>
<li><p><strong>DIR_4_TCOFFEE</strong>: by default this variable is set to $HOME/.t_coffee; this is where T-Coffee expects to find its cache, tmp dir and possibly any temporary data stored by the program.</p></li>
<li><p><strong>TMP_4_TCOFFEE</strong>: by default this variable is set to $HOME/.t_coffee/tmp; this is where T-Coffee stores temporary files.</p></li>
<li><p><strong>CACHE_4_TCOFFEE</strong>: by default this variable is set to $HOME/.t_coffee/cache; this is where T-Coffee stores any data expensive to obtain: PDB files, structural alignments…</p></li>
<li><p><strong>PLUGINS_4_TCOFFEE</strong>: by default all the third party packages are searched in the directory DIR_4_TCOFFEE/plugins/&lt;OS&gt;. This variable overrides the default but can also be overriden by the <strong>-plugins</strong> flag.</p></li>
<li><p><strong>NO_ERROR_REPORT_4_TCOFFEE</strong>: by default this variable is no set; set it if you do not want the program to generate a verbose error output file (useful for running a server).</p></li>
<li><p><strong>PDB_DIR</strong>:indicate the location of your local PDB installation.</p></li>
<li><p><strong>NO_WARNING_4_TCOFFEE</strong>: suppresses all the warnings.</p></li>
<li><p><strong>UNIQUE_DIR_4_TCOFFEE</strong>: sets all DIR_4_TCOFFEE, CACHE_4_TCOFFEE, TMP_4_TCOFFEE, PLUGINS_4_TCOFFEE</p></li>
</ul>
</div></blockquote>
<p>T-Coffee can have its own environment file, kept in a file named <code class="docutils literal notranslate"><span class="pre">t_coffee_env</span></code> in the folder $HOME/.t_coffee/ and can be edited (under maintenance…). The value of any legal variable can be modified through that file. For instance, here are some examples of 1) <strong>using a configuration file</strong> when not requiring a proxy, 2) <strong>setting up any environment variable</strong> using the <strong>-setenv</strong> or 3) simply <strong>using an export</strong>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span><span class="p">)</span> <span class="n">No</span> <span class="n">proxy</span>
<span class="c1">##: http_proxy_4_TCOFFEE=</span>
<span class="c1">##: EMAIL_4_TCOFFEE=cedric.notredame@gmail.com</span>

<span class="mi">2</span><span class="p">)</span> <span class="n">Using</span> <span class="s1">&#39;setenv&#39;</span>
<span class="c1">##: t_coffee ... -setenv ENV_4_TCOFFEE=&lt;location&gt;</span>

<span class="mi">3</span><span class="p">)</span> <span class="n">Using</span> <span class="s1">&#39;export&#39;</span>
<span class="c1">##: export ENV_4_TCOFFEE=&lt;location&gt;</span>
</pre></div>
</div>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>Priorities: “export” &gt; “-setenv” &gt; “-proxy,-email” &gt; “t_coffee_env” &gt; “default environment”</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When you use <strong>-setenv</strong> for PATH, the value you provide is concatenated at the beginning of the current PATH value. This way you can force T-Coffee to use a specific version of an aligner.</p>
</div>
</section>
<section id="cpu-control">
<h5>CPU control<a class="headerlink" href="#cpu-control" title="Permalink to this heading"></a></h5>
<section id="multithreading">
<h6>Multithreading<a class="headerlink" href="#multithreading" title="Permalink to this heading"></a></h6>
<ul class="simple">
<li><p><strong>-multi_core</strong> (usage:<strong>-multi_core=[templates,jobs,relax,msa]</strong>/default:none)</p></li>
</ul>
<p>Specifies that T-Coffee should be multithreaded or not; by default all relevant steps are parallelized. The different options for the flag are the following:</p>
<blockquote>
<div><ul class="simple">
<li><p>template: fetch the templates in a parallel way</p></li>
<li><p>jobs: compute the library</p></li>
<li><p>relax: extend the library in a parallel way</p></li>
<li><p>msa: compute the msa in a parallel way</p></li>
<li><p>no: not parallelized</p></li>
</ul>
</div></blockquote>
<ul class="simple">
<li><p><strong>-n_core</strong> (usage:<strong>-n_core= [number of cores+]</strong>/default:1, deprecated: use -thread instead)</p></li>
</ul>
<p>Use 0 to use all the cores
- <strong>-max_n_core</strong> (usage:<strong>-max_n_core= [number of cores+]</strong>/default:1, deprecated: use -thread instead)
Use 0 to use all the cores
- <strong>-thread</strong> (usage:<strong>-thread= [number of cores+]</strong>/default:1)
Use 0 to use all the cores</p>
</section>
<section id="limits">
<h6>Limits<a class="headerlink" href="#limits" title="Permalink to this heading"></a></h6>
<ul class="simple">
<li><p><strong>-maxlen</strong> (usage:<strong>-maxlen=[value,0=nolimit]</strong>/default:<strong>-maxlen=1000</strong>)</p></li>
</ul>
<p>Indicates the maximum length of the sequences.</p>
<ul class="simple">
<li><p><strong>-maxnseq</strong> (usage:<strong>-maxnseq=[value,0=nolimit]</strong>/default:<strong>-maxnseq=??</strong>)</p></li>
</ul>
<p>Indicates the maximum number of the sequences.</p>
<ul class="simple">
<li><p><strong>-ulimit</strong> (usage:<strong>-ulimit=[value]</strong>/default:<strong>-ulimit=0</strong>)</p></li>
</ul>
<p>Specifies the upper limit of memory usage (in Megabytes) and processes exceeding this limit will automatically exit. A value 0 indicates that no limit applies.</p>
<ul class="simple">
<li><p><strong>-mem_mode</strong> [Deprecated]</p></li>
</ul>
</section>
</section>
<section id="meta-parameters">
<h5>Meta-parameters<a class="headerlink" href="#meta-parameters" title="Permalink to this heading"></a></h5>
<section id="global-parameters">
<h6>Global parameters<a class="headerlink" href="#global-parameters" title="Permalink to this heading"></a></h6>
<ul class="simple">
<li><p><strong>no flag</strong></p></li>
</ul>
<p>If no flag is provided, your sequence dataset must be the first argument. When you do so, the name of your file is used as a name prefix for every output file of the program (changing the extension according to the type of result).</p>
<ul class="simple">
<li><p><strong>-mode</strong></p></li>
</ul>
<p>A T-Coffee mode is a hard coded command line calling to specific options predetermined and optimized. By default, they are not used and should be called upon. Here are some examples: <strong>expresso, mcoffee, rcoffee, evaluate, accurate, procoffee</strong>…These modes have been designed to deliver the best results possible for a specific task; they can work without any parameters but can be controlled and modified extensively with extra parameters.</p>
<ul class="simple">
<li><p><strong>-parameters</strong></p></li>
</ul>
<p>The input has to be a file containing extra parameters for T-Coffee. Parameters read this way behave as if they had been added on the right end of the command line that they either supersede one parameter or complete list of parameters. Here is an example (command 1) that will cause T-Coffee to apply the <strong>fast_pair</strong> method onto the sequences contained in <code class="docutils literal notranslate"><span class="pre">sample_seq1.fasta</span></code>. If you wish, you can also pipe these arguments into T-Coffee (command 2) by naming the parameter file ‘stdin’ (as a rule, any file named stdin is expected to receive its content via the stdin).</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The parameter file can ONLY contain valid parameters; comments are not allowed. Parameters passed this way will be checked like normal parameters.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Command 1: defining parameters for T-coffee
$$: t_coffee -parameters=sample_param_file.param

Command 2: sending parameters to T-Coffee
$$: cat sample_param_file.param | t_coffee -parameters=stdin

**********sample_file.param***********
 -in=Ssample_seq1.fasta,Mfast_pair
 -output=msf_aln
**************************************
</pre></div>
</div>
<ul class="simple">
<li><p><strong>-t_coffee_defaults</strong></p></li>
</ul>
<p>The input has to be a file; it will tells the program to use some default parameter file for T-Coffee. The format of that file is the same as the one used with <strong>-parameters</strong>. The file used is either:</p>
<ol class="arabic simple">
<li><p>&lt;file name&gt; if a name has been specified</p></li>
<li><p>~/.t_coffee_defaults if no file was specified</p></li>
<li><p>The file indicated by the environment variable <strong>TCOFFEE_DEFAULTS</strong></p></li>
</ol>
<ul class="simple">
<li><p><strong>-evaluate</strong></p></li>
</ul>
<p>Replaces the former flag <strong>-score</strong> which is no longer supported. This flag toggles on the evaluate mode and causes T-Coffee to evaluate a precomputed MSA provided via <strong>-infile=&lt;MSA&gt;</strong>. The main purpose of this flag is to let you control every aspect of the evaluation, yet it is advisable to use predefined parameterization <strong>-mode=evaluate</strong>. The flag <strong>-output</strong> must be set to an appropriate format (refer to the subsection ‘Alignments Flags’).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee -infile=sample_aln1.aln -mode=evaluate -method proba_pair

$$: t_coffee -infile=sample_seq1.aln -in Lsample_seq1_lib1.tc_lib -mode=evaluate
</pre></div>
</div>
<ul class="simple">
<li><p><strong>-convert</strong> [cw]</p></li>
</ul>
<p>By default, is turned off. It toggles on the conversion mode and causes T-Coffee to convert the sequences, alignments, libraries or structures provided via the <strong>-infile</strong> and <strong>-in</strong> flags. The output format must be set via the <strong>-output</strong> flag. This flag can also be used if you simply want to compute a library (i.e. you have an alignment and you want to turn it into a library). This option is ClustalW compliant.</p>
</section>
<section id="misc-parameters">
<h6>Misc parameters<a class="headerlink" href="#misc-parameters" title="Permalink to this heading"></a></h6>
<ul class="simple">
<li><p><strong>-version</strong></p></li>
</ul>
<p>Returns the current version number of T-Coffee you are using.</p>
<ul class="simple">
<li><p><strong>-proxy</strong></p></li>
</ul>
<p>Sets the proxy used by <strong>HTTP_proxy</strong> and <strong>http_proxy</strong>. Setting with the propmpt supersedes ANY other setting. Note that if you use no proxy, you should still set <strong>-proxy</strong>.</p>
<ul class="simple">
<li><p><strong>-email</strong></p></li>
</ul>
<p>Sets your email value as provided for web services.</p>
<ul class="simple">
<li><p><strong>-cache</strong> (usage:<strong>-cache=[use, update, ignore, &lt;filename&gt;]</strong>/default:none)</p></li>
</ul>
<p>By default, T-Coffee stores in a cache directory the results of computationally expensive (structural alignment for instance) or network intensive operations (BLAST search). The usage is the following:.</p>
<ul class="simple">
<li><p><strong>-update</strong></p></li>
</ul>
<p>Causes a wget access that checks whether the T-Coffee version you are using needs updating.</p>
<ul class="simple">
<li><p><strong>-plugins</strong></p></li>
</ul>
<p>The input parameter has to be the directory, where all third pirty packages used by T-Coffee are kept (~/.t_coffee/plugins/ by default). As an alternative, you can also set the environment variable <strong>PLUGINS_4_TCOFFEE</strong> to your convenience.</p>
<ul class="simple">
<li><p><strong>-other_pg</strong> (usage:<strong>[seq_reformat,aln_compare,extract_from_pdb,irmsd,trmsd…]</strong>)</p></li>
</ul>
<p>Some rumours claim that Tetris is embedded within T-Coffee and could be ran using some special set of commands. We wish to deny these rumours, although we may admit that several interesting reformatting programs are now embedded in T-Coffee and can be ran through the <strong>-other_pg</strong> flag.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee -other_pg=seq_reformat
$$: t_coffee -other_pg=unpack_all
</pre></div>
</div>
<ul class="simple">
<li><p><strong>-check_configuration</strong> [under evaluation]</p></li>
</ul>
<p>Checks your system to determine if all the programs T-Coffee can interact with are installed or not.</p>
<ul class="simple">
<li><p><strong>-full_log</strong> [under evaluation]</p></li>
</ul>
<p>Requires a file name as parameter; it causes T-Coffee to output a full log file that contains all the input/output files.</p>
</section>
<section id="verbose-parameters">
<h6>Verbose parameters<a class="headerlink" href="#verbose-parameters" title="Permalink to this heading"></a></h6>
<ul class="simple">
<li><p><strong>-quiet</strong> (usage:<strong>-quiet=[stderr,stdout,file name OR nothing]</strong>/default:<strong>-quiet=stderr</strong>)</p></li>
</ul>
<p>This control the verbose mode of T-Coffee from the display on the screen or to redirect to a given file; <strong>-quiet</strong> on its own redirect the output to /dev/null.</p>
<ul class="simple">
<li><p><strong>-no_warning</strong> (usage:<strong>-no_warning=[yes,no]</strong>/default:none)</p></li>
</ul>
<p>Suppresses all warning output of the verbose mode.</p>
</section>
</section>
</section>
<section id="input-s">
<h4>Input(s)<a class="headerlink" href="#input-s" title="Permalink to this heading"></a></h4>
<section id="the-in-flag">
<h5>The “-in” flag<a class="headerlink" href="#the-in-flag" title="Permalink to this heading"></a></h5>
<p>The <strong>-in</strong> flag and its identifier TAGs <strong>are the real grinder of T-Coffee</strong>. Sequences, methods, alignments, whatever…all pass through so that T-Coffee can turn them all into a single list of constraints (the library). Everything is done automatically with T-Coffee going through each file to extract the sequences it contains. The methods are then applied to the sequences. Precompiled constraint list can also be provided. Each file provided via this flag must be preceded with a symbol (the identifier TAG) that indicates its nature to T-Coffee. The common usage is <strong>-in=[&lt;P,S,A,L,M,X&gt;&lt;name&gt;]</strong>. By default it is set up to <strong>-in=Mlalign_id_pair,Mclustalw_pair</strong>. This is a legal multiple alignments that will be treated as single sequences (the sequences it contains will not be realigned). The TAGs currently supported are the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">P</span> <span class="p">:</span> <span class="n">PDB</span> <span class="n">structure</span>
<span class="n">S</span> <span class="p">:</span> <span class="n">Sequences</span> <span class="p">(</span><span class="n">aligned</span> <span class="ow">or</span> <span class="n">unaligned</span> <span class="n">sequences</span><span class="p">)</span>
<span class="n">M</span> <span class="p">:</span> <span class="n">Methods</span> <span class="n">used</span> <span class="n">to</span> <span class="n">build</span> <span class="n">the</span> <span class="n">library</span>
<span class="n">L</span> <span class="p">:</span> <span class="n">Precomputed</span> <span class="n">T</span><span class="o">-</span><span class="n">Coffee</span> <span class="n">library</span>
<span class="n">A</span> <span class="p">:</span> <span class="n">Alignments</span> <span class="n">that</span> <span class="n">must</span> <span class="n">be</span> <span class="n">turned</span> <span class="n">into</span> <span class="n">a</span> <span class="n">Library</span>
<span class="n">X</span> <span class="p">:</span> <span class="n">Substitution</span> <span class="n">matrices</span>
<span class="n">R</span> <span class="p">:</span> <span class="n">Profiles</span>
</pre></div>
</div>
<p>If you do not want to use the TAGS, you will need to use the following flags in replacement. Do not use the TAGS when using these flags.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="n">aln</span>     <span class="p">:</span> <span class="n">Alignments</span>  <span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="o">-</span><span class="n">profile</span> <span class="p">:</span> <span class="n">Profiles</span>    <span class="p">(</span><span class="n">R</span><span class="p">)</span>
<span class="o">-</span><span class="n">method</span>  <span class="p">:</span> <span class="n">Method</span>      <span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="o">-</span><span class="n">seq</span>     <span class="p">:</span> <span class="n">Sequences</span>   <span class="p">(</span><span class="n">S</span><span class="p">)</span>
<span class="o">-</span><span class="n">lib</span>     <span class="p">:</span> <span class="n">Libraries</span>   <span class="p">(</span><span class="n">L</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The flag <strong>-in</strong> can be replaced with the combined usage of -aln, -profile, -pdb, -lib, -method depending on what you want.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee -in=Ssample_seq1.fasta,Asample_seq1_aln2.aln,Asample_seq1_aln2.msf, \
    Mlalign_id_pair,Lsample_seq1_lib1.tc_lib -outfile=outaln
</pre></div>
</div>
<p>This command will trigger the following chain of events:</p>
<ol class="arabic simple">
<li><p><strong>Gather all the sequences and pool them together</strong> (format recognition is automatic). Duplicates are removed (if they have the same name). Duplicates in a single file are only tolerated in FASTA format file, although they will cause sequences to be renamed. In the above case, the total set of sequences will be made of sequences contained in <code class="docutils literal notranslate"><span class="pre">sample_seq1.fasta</span></code>, <code class="docutils literal notranslate"><span class="pre">sample_seq1_aln2.aln</span></code>, <code class="docutils literal notranslate"><span class="pre">sample_seq1_aln2.msf</span></code> and <code class="docutils literal notranslate"><span class="pre">sample_seq1_lib1.tc_lib</span></code>, plus the sequences initially gathered by <strong>-infile</strong>.</p></li>
<li><p><strong>Turn alignment(s) into libraries</strong> (e.g. alignment1.aln and alignment2.msf will be read and turned into libraries). Another library will be produced by applying the method lalign_id_pair to the set of sequences previously obtained (1). The final library used for the alignment will be the combination of all this information.</p></li>
</ol>
<p>This procedure follows specific rules within T-Coffee; be carefull with the following rules:</p>
<ul class="simple">
<li><p><strong>Order</strong>: the order in which sequences, methods, alignments and libraries are fed in is irrelevant.</p></li>
<li><p><strong>Heterogeneity</strong>: there is no need for each element (A, S, L) to contain the same sequences.</p></li>
<li><p><strong>No Duplicate</strong>: each file should contain only one copy of each sequence. Duplicates are only allowed in FASTA files but will cause the sequences to be renamed.</p></li>
<li><p><strong>Reconciliation</strong>: if two files (for instance two alignments) contain different versions of the same sequence due to an indel, a new sequence will be reconstructed and used instead. This can be useful if you are trying to combine several runs of blast, or structural information where residues may have been deleted. However substitutions are forbidden. If two sequences with the same name cannot be merged, they will cause the program to exit with an information message.</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">aln</span> <span class="mi">1</span><span class="p">:</span>      <span class="n">hgab1</span> <span class="n">AAAAABAAAAA</span>
<span class="n">aln</span> <span class="mi">2</span><span class="p">:</span>      <span class="n">hgab1</span> <span class="n">AAAAAAAAAACCC</span>
<span class="n">consensus</span><span class="p">:</span>  <span class="n">hgab1</span> <span class="n">AAAAABAAAAACCC</span>
</pre></div>
</div>
<ul class="simple">
<li><p><strong>Substitution Matrices</strong>: if the method is a substitution matrix (X) then no other type of information should be provided. This command results in a progressive alignment carried out on the sequences in seqfile. The procedure does not use any more the T-Coffee concistency based algorithm, but switches to a standard progressive alignment algorithm (like ClustalW or Pileup) much less accurate. In this context, appropriate gap penalties should be provided. The matrices are in the file <code class="docutils literal notranslate"><span class="pre">matrices.h</span></code> in the folder <strong>“$HOME/tcoffee/Version_XX/src/”</strong>. <em>Ad hoc</em> matrices can also be provided by the user (see the matrices format section at the end of this manual).</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee sample_seq1.fasta -in=Xpam250mt -gapopen=-10 -gapext=-1
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The matrix <strong>X</strong> does not have the same effect as using the <strong>-matrix</strong> flag, which defines the matrix that will be used while compiling the library while the Xmatrix defines the matrix used when assembling the final alignment.</p>
</div>
<ul class="simple">
<li><p><strong>Methods</strong>: the method describer can either be built-in or be a file describing the method to be used (see chapter <strong>T-Coffee Main Documentation, Internal/External Methods In T-Coffee</strong> for more information). The exact syntax is provided later in this technical documentation.</p></li>
</ul>
</section>
<section id="sequence-input-flags">
<h5>Sequence input flags<a class="headerlink" href="#sequence-input-flags" title="Permalink to this heading"></a></h5>
<ul class="simple">
<li><p><strong>-infile</strong> (usage:<strong>-infile=&lt;filename&gt;</strong>) [cw]</p></li>
</ul>
<p>Common multiple sequence alignments format constitute a valid input format. To remain compatible with ClustalW ([cw]) it is possible to indicate the sequences with this flag. T-Coffee automatically removes the gaps before doing the alignment, and this behaviour is different from that of ClustalW where the gaps are kept.</p>
<ul class="simple">
<li><p><strong>-get_type</strong></p></li>
</ul>
<p>Forces T-Coffee to identify the sequences type (protein, DNA or RNA sequences).</p>
<ul class="simple">
<li><p><strong>-type</strong> (usage:<strong>-type=[DNA,RNA,PROTEIN]</strong>) [cw]</p></li>
</ul>
<p>This flag sets the type of the sequences. The. By default, it recognizes the sequence type. If omitted, the type is guessed automatically, but in case of low complexity or short sequences, it is recommended to set the type manually This flag is compatible with ClustalW.</p>
<ul class="simple">
<li><p><strong>-seq</strong> (usage:<strong>-seq=[&lt;P,S&gt;&lt;name&gt;]</strong>)</p></li>
</ul>
<p>The flag <strong>-seq</strong> is now the recommended flag to provide your sequences; it behaves mostly like the <strong>-in</strong> flag.</p>
<ul class="simple">
<li><p><strong>-seq_source</strong> (usage:<strong>-seq_source=[ANY or _LS or LS]</strong>) [under evaluation]</p></li>
</ul>
<p>You may not want to combine all the provided sequences into a single sequence list. You can do by specifying that you do not want to treat all the <strong>-in</strong> files as potential sequence sources.The flag <strong>-seq_source=_LA</strong> indicates that neither sequences provided via the A (Alignment) flag or via the L (Library flag) should be added to the sequence list. The flag <strong>-seq_source=S</strong> means that only sequences provided via the S tag will be considered. All the other sequences will be ignored. This flag was mostly designed for interactions between T-Coffee and T-CoffeeDPA (the large scale version of T-Coffee) which is now deprecated !!!</p>
</section>
<section id="other-input-flags-structure-tree-profile">
<h5>Other input flags (structure, tree, profile)<a class="headerlink" href="#other-input-flags-structure-tree-profile" title="Permalink to this heading"></a></h5>
<ul class="simple">
<li><p><strong>-pdb</strong> (usage:<strong>-pdb=&lt;pdbid1&gt;,&lt;pdbid2&gt;…</strong>/[max 200])</p></li>
</ul>
<p>It reads or fetch a PDB file or even to specify a chain or a sub-chain: PDBID(PDB_CHAIN)[opt] (FIRST,LAST)[opt]. It is also possible to input structures via the <strong>-in</strong> flag but in that case, you will need to use the TAG identifier (Ppdb1 Ppdb2…).</p>
<ul class="simple">
<li><p><strong>-usetree</strong> (usage:<strong>-usetree=&lt;tree file&gt;</strong>) [cw]</p></li>
</ul>
<p>This flag indicates that rather than computing a new dendrogram, T-Coffee must use a precomputed one in newick tree format (ClustalW Style). The tree files are in Phylip format and compatible with ClustalW. In most cases, using a precomputed tree will halve the computation time required by T-Coffee. It is also possible to use trees output by ClustalW, Phylip and some other tree generating software.</p>
<ul class="simple">
<li><p><strong>-profile</strong> (usage:<strong>-profile=[&lt;name1&gt;,&lt;name2&gt;,…]</strong>/[max 200])</p></li>
</ul>
<p>This flag causes T-Coffee to treat multiple alignments as a single sequences, thus making it possible to make multiple profile alignments. The profile-profile alignment is controlled by <strong>-profile_mode</strong> and <strong>-profile_comparison</strong>. When provided with the <strong>-in</strong> flag, profiles must be preceded with the letter R. Note that when using <strong>-template_file</strong>, the program will also look for the templates associated with the profiles even if the profiles have been provided as templates themselves (however it will not look for the template of the profile templates of the profile templates…).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Turning several MSA into a single profile:
$$: t_coffee -profile sample_seq1.aln,sample_seq1_aln2.aln -outfile=profile_aln

Using MSA as profiles:
$$: t_coffee -in Rsample_seq1.aln,Rsample_seq1_aln2.aln,Mslow_pair,Mlalign_id_pair \
    -outfile=profile_aln
</pre></div>
</div>
<ul class="simple">
<li><p><strong>-profile1</strong>/<strong>-profile2</strong> (usage:<strong>-profile1=[&lt;prf1&gt;]</strong>/<strong>-profile2=[&lt;prf2&gt;]</strong>/one name only/) [cw]</p></li>
</ul>
<p>It is similar to the previous command and was provided for compatibility with ClustalW.It accepts only one name in as parameter.</p>
</section>
</section>
<section id="output-s">
<h4>Output(s)<a class="headerlink" href="#output-s" title="Permalink to this heading"></a></h4>
<p>Those names, stdout, stderr, stdin, no, /dev/null are valid filenames. They cause the corresponding file to be output in stderr or stdout; for an input file, stdin causes the program to requests the corresponding file through pipe. No causes a suppression of the output, as does /dev/null. In the T-Coffee output (displayed on screen), the output results appear in the following format (last lines displayed once the job is done):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">OUTPUT</span> <span class="n">RESULTS</span>
<span class="c1">##### File Type= &lt;type&gt; Format= &lt;format&gt; Name &lt;filename&gt;</span>

<span class="n">File</span> <span class="n">Type</span><span class="p">:</span> <span class="n">can</span> <span class="n">be</span> <span class="n">GUIDE</span> <span class="n">TREE</span><span class="p">,</span> <span class="n">MSA</span><span class="p">,</span> <span class="n">etc</span><span class="o">...</span>
<span class="n">Format</span>   <span class="p">:</span> <span class="n">can</span> <span class="n">be</span> <span class="n">newick</span><span class="p">,</span> <span class="n">html</span><span class="p">,</span> <span class="n">aln</span><span class="p">,</span> <span class="n">etc</span><span class="o">...</span>
<span class="n">Name</span>     <span class="p">:</span> <span class="n">prefix</span> <span class="ow">is</span> <span class="n">the</span> <span class="n">name</span> <span class="n">of</span> <span class="n">the</span> <span class="nb">input</span><span class="p">,</span> <span class="n">extension</span> <span class="n">corresponds</span> <span class="n">to</span> <span class="n">the</span> <span class="nb">type</span> <span class="o">&amp;</span> <span class="nb">format</span><span class="o">.</span>
</pre></div>
</div>
<section id="output-files-format-names">
<h5>Output files, format &amp; names<a class="headerlink" href="#output-files-format-names" title="Permalink to this heading"></a></h5>
<ul class="simple">
<li><p><strong>-run_name</strong> (usage:<strong>-run_name=&lt;your run name&gt;</strong>)</p></li>
</ul>
<p>This flag causes the prefix &lt;your sequences&gt; to be replaced by &lt;your run name&gt; when renaming the default output files.</p>
<ul class="simple">
<li><p><strong>-align</strong> [cw]</p></li>
</ul>
<p>This flag indicates that the program MUST produce an alignment. It is here for compatibility with ClustalW.</p>
<ul class="simple">
<li><p><strong>-outfile</strong> (usage:<strong>-outfile=[out_aln,file,default,no]</strong>)</p></li>
</ul>
<p>Indicates the name of the alignment output by T-Coffee. If the default is used, the alignment is named &lt;your sequences&gt;.aln.</p>
<ul class="simple">
<li><p><strong>output</strong> (usage:<strong>-output=[format1,format2,…]</strong>/default:<strong>-output=clustalw</strong>)</p></li>
</ul>
<p>Indicates the format used for the output of the resulting alignment; more than one format can be indicated. The supported input/output formats are listed below. The scoring output files rely mainly on the T-Coffee CORE index (you can find more information <a class="reference external" href="http://www.tcoffee.org/Publications/Pdf/core.pp.pdf">here</a>).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Sequence</span> <span class="nb">format</span><span class="p">:</span>
<span class="o">-</span> <span class="n">clustalw_aln</span><span class="p">,</span> <span class="n">clustalw</span>
<span class="o">-</span> <span class="n">gcg</span>
<span class="o">-</span> <span class="n">msf_aln</span>
<span class="o">-</span> <span class="n">pir_aln</span><span class="p">,</span> <span class="n">pir_seq</span>
<span class="o">-</span> <span class="n">fasta_aln</span><span class="p">,</span> <span class="n">fasta_seq</span>
<span class="o">-</span> <span class="n">phylip</span>

<span class="n">Output</span> <span class="nb">format</span><span class="p">:</span>
<span class="o">-</span> <span class="n">score_ascii</span> <span class="p">:</span> <span class="n">causes</span> <span class="n">the</span> <span class="n">output</span> <span class="n">of</span> <span class="n">a</span> <span class="n">reliability</span> <span class="n">flag</span>
<span class="o">-</span> <span class="n">score_html</span>  <span class="p">:</span> <span class="n">causes</span> <span class="n">the</span> <span class="n">output</span> <span class="n">to</span> <span class="n">be</span> <span class="n">a</span> <span class="n">reliability</span> <span class="n">plot</span> <span class="ow">in</span> <span class="n">HTML</span>
<span class="o">-</span> <span class="n">score_pdf</span>   <span class="p">:</span> <span class="n">idem</span> <span class="ow">in</span> <span class="n">PDF</span> <span class="p">(</span><span class="k">if</span> <span class="n">ps2pdf</span> <span class="ow">is</span> <span class="n">installed</span> <span class="n">on</span> <span class="n">your</span> <span class="n">system</span><span class="p">)</span>
<span class="o">-</span> <span class="n">score_ps</span>    <span class="p">:</span> <span class="n">idem</span> <span class="ow">in</span> <span class="n">postscript</span>
</pre></div>
</div>
<ul class="simple">
<li><p><strong>-seqnos</strong> (usage:<strong>-seqnos=[on,off]</strong>/default:<strong>-seqnos=off</strong>)</p></li>
</ul>
<p>Causes the output alignment to contain the number of residue at the end of each line.</p>
</section>
<section id="evaluation-files">
<h5>Evaluation files<a class="headerlink" href="#evaluation-files" title="Permalink to this heading"></a></h5>
<p>The CORE is an index that indicates the consistency between the library of piarwise alignments and the final multiple alignment. Our experiment indicate that the higher this consistency, the more reliable the alignment. A publication describing the CORE index can be found <a class="reference external" href="http://www.tcoffee.org/Publications/Pdf/core.pp.pdf">here</a>. All these modes will be useful when generating colored version of the output, with the <strong>-output</strong> flag (cf. Chapter <strong>T-Coffee Main Documentation, Section Preparing Your Data</strong>).</p>
<ul class="simple">
<li><p><strong>-evaluate_mode</strong> (usage:<strong>-evaluate_mode=&lt;t_coffee_fast,t_coffee_slow,t_coffee_non_extended&gt;</strong>/default:<strong>-evaluate_mode=t_coffee_fast</strong>)</p></li>
</ul>
<p>This flag indicates the mode used to normalize the T-Coffee score when computing the reliability score. Several options are possible:</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>t_coffee_fast</strong>: Normalization is made using the highest score in the MSA. This evaluation mode was validated and in our hands, pairs of residues with a score of 5 or higher have 90 % chances to be correctly aligned to one another.</p></li>
<li><p><strong>t_coffee_slow</strong>: Normalization is made using the library. This usually results in lower score and a scoring scheme more sensitive to the number of sequences in the dataset. Note that this scoring scheme is not any more slower, thanks to the implementation of a faster heuristic algorithm.</p></li>
<li><p><strong>t_coffee_non_extended</strong>: the score of each residue is the ratio between the sum of its non extended scores with the column and the sum of all its possible non extended scores.</p></li>
</ul>
</div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee sample_seq1.fasta -evaluate_mode t_coffee_slow -output score_ascii

$$: t_coffee sample_seq1.fasta -evaluate_mode t_coffee_fast -output score_ascii

$$: t_coffee sample_seq1.fasta -evaluate_mode t_coffee_non_extended -output score_ascii
</pre></div>
</div>
</section>
<section id="alignments">
<h5>Alignments<a class="headerlink" href="#alignments" title="Permalink to this heading"></a></h5>
<ul class="simple">
<li><p><strong>-outseqweight</strong> (usage:<strong>-outseqweight=&lt;filename&gt;</strong>/default:none)</p></li>
</ul>
<p>Indicates the name of the file in which the sequences weights should be saved…</p>
<ul class="simple">
<li><p><strong>-case</strong> (usage:<strong>-case=[keep,upper,lower]</strong>/default:<strong>-case=keep</strong>)</p></li>
</ul>
<p>Instructs the program on the case to be used in the output file (Clustalw uses upper case). The default keeps the case and makes it possible to maintain a mixture of upper and lower case residues. If you need to change the case of your file, refers to the <strong>T-Coffee Main Documentation</strong>.</p>
<ul class="simple">
<li><p><strong>-outorder</strong> (usage:<strong>-outorder=[input,aligned,filename]</strong>/default:<strong>-outorder=input</strong>) [cw]</p></li>
</ul>
<p>Sets the order of the sequences in the output alignment; by default, the sequences are kept in the original order of the input dataset. Using <strong>-outorder=aligned</strong> means the sequences come in the order indicated by the tree; this order can be seen as a one dimensional projection of the tree distances. It is also possible to provide a file (a legal FASTA file) whose order will be used in the final MSA via <strong>-outdorder=&lt;filename&gt;</strong>.</p>
<ul class="simple">
<li><p><strong>-inorder</strong> (usage:<strong>-inorder=[input,aligned]</strong>/default:<strong>-inorder=aligned</strong>) [cw]</p></li>
</ul>
<p>MSAs based on dynamic programming depend slightly on the order in which the incoming sequences are provided. To prevent this effect sequences are arbitrarily sorted at the beginning of the program (<strong>-inorder=aligned</strong>). However, this affects the sequence order within the library. You can switch this off by stating <strong>-inorder=input</strong>.</p>
<ul class="simple">
<li><p><strong>-cpu</strong> [Deprecated]</p></li>
</ul>
</section>
<section id="librairies-trees">
<h5>Librairies &amp; trees<a class="headerlink" href="#librairies-trees" title="Permalink to this heading"></a></h5>
<ul class="simple">
<li><p><strong>-out_lib</strong> (usage:<strong>-out_lib=[name of the library,default,no]</strong>/default:<strong>-out_lib=default</strong>)</p></li>
</ul>
<p>Sets the name of the library output. Default implies <code class="docutils literal notranslate"><span class="pre">&lt;run_name&gt;.tc_lib</span></code>.</p>
<ul class="simple">
<li><p><strong>-lib_only</strong></p></li>
</ul>
<p>Causes the program to stop once the library has been computed. Must be used in conjunction with the flag <strong>-out_lib</strong>.</p>
<ul class="simple">
<li><p><strong>-newtree</strong> (usage:<strong>-newtree=&lt;tree file&gt;</strong>)</p></li>
</ul>
<p>Indicates the name of the file into which the guide tree will be written. The default will be <code class="docutils literal notranslate"><span class="pre">&lt;sequence_name&gt;.dnd</span></code>, or <code class="docutils literal notranslate"><span class="pre">&lt;run_name.dnd&gt;</span></code>. The tree is written in the parenthesis format known as Newick or New Hampshire and used by Phylip.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Do NOT confuse this guide tree with a phylogenetic tree.</p>
</div>
</section>
</section>
<section id="alignment-computation">
<h4>Alignment Computation<a class="headerlink" href="#alignment-computation" title="Permalink to this heading"></a></h4>
<section id="library-computation-methods-and-extension">
<h5>Library computation: methods and extension<a class="headerlink" href="#library-computation-methods-and-extension" title="Permalink to this heading"></a></h5>
<p>Although it does not necessarily do so explicitly, T-Coffee always end up combining libraries. Libraries are collections of pairs of residues. Given a set of libraries, T-Coffee tries to assemble the alignment with the highest level of consistency. You can think of the alignment as a list of constraints; the job of T-Coffee is to satisfy as many constraints as possible.</p>
<ul class="simple">
<li><p><strong>-lalign_n_top</strong> (usage:<strong>-lalign_n_top=&lt;Integer&gt;</strong>/default:<strong>-lalign_n_top=10</strong>)</p></li>
</ul>
<p>Number of alignment reported by the local method (lalign).</p>
<ul class="simple">
<li><p><strong>-align_pdb_param_file</strong> [Unsupported]</p></li>
<li><p><strong>-align_pdb_hasch_mode</strong> [Unsupported]</p></li>
<li><p><strong>-do_normalise</strong> (usage:<strong>-do_normalise=[0 or a positive value]</strong>/default:<strong>-do_normalise=1000</strong>)</p></li>
</ul>
<p>Development Only. When using a value different from 0, this flag sets the score of the highest scoring pair to 1000.</p>
<ul class="simple">
<li><p><strong>-extend</strong> (usage:<strong>-extend=[0,1 or a positive value]</strong>/default:<strong>-extend=1</strong>)</p></li>
</ul>
<p>Development only. When turned on, this flag indicates that the library extension should be carried out when performing the multiple alignment. If <strong>-extend =0</strong>, the extension is not made, if it is set to 1, the extension is made on all the pairs in the library. If the extension is set to another positive value, the extension is only carried out on pairs having a weight value superior to the specified limit.</p>
<ul class="simple">
<li><p><strong>-extend_mode</strong> (usage:<strong>-extend=[see below…]</strong>/default:<strong>-extend=very_fast_triplet</strong>)</p></li>
</ul>
<p>Development only. Controls the algorithm for matrix extension. Available SUPPORTED modes include: <strong>fast_triplet</strong>, <strong>very_fast_triplet</strong> (limited to the <strong>-max_n_pair</strong> best sequence pairs when aligning two profiles), <strong>slow_triplet</strong> (exhaustive use of all the triplets), <strong>matrix</strong> (use of the matrix <strong>-matrix</strong>) and <strong>fast_matrix</strong> (use of the matrix <strong>-matrix</strong>). The following are NOT SUPPORTED: relative_triplet, g_coffee, g_coffee_quadruplets, mixt, quadruplet, test. Profiles are turned into consensus.</p>
<ul class="simple">
<li><p><strong>-max_n_pair</strong> (usage:<strong>-max_n_pair=[integer]</strong>/default:<strong>-extend=10</strong>)</p></li>
</ul>
<p>Development only. Controls the number of pairs considered by the <strong>-extend_mode=very_fast_triplet</strong>. Setting it to 0 forces all the pairs to be considered equivalent to <strong>-extend_mode=slow_triplet</strong>).</p>
<ul class="simple">
<li><p><strong>-weight</strong> (usage:<strong>-weight=[winsimN,sim,sim_&lt;matrix_name,matrix_file&gt;,integer]</strong> / default:<strong>-weight=sim</strong>)</p></li>
</ul>
<p>Weight defines the way alignments are weighted when turned into a library. Overweighting can be obtained with the OW&lt;X&gt; weight mode; winsimN indicates that the weight assigned to a given pair will be equal to the percent identity within a window of 2N+1 length centered on that pair. For instance winsim10 defines a window of 10 residues around the pair being considered. This gives its own weight to each residue in the output library. However, in our hands, this type of weighting scheme has not provided any significant improvement over the standard sim value (the value indicates that all the pairs found in the alignments must be given the same weight equal to value). This is useful when the alignment one wishes to turn into a library must be given a prespecified score (for instance if they come from a structure superimposition program).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee sample_seq1.fasta -weight=winsim10 -out_lib=test.tc_lib

$$: t_coffee sample_seq1.fasta -weight=1000 -out_lib=test.tc_lib

$$: t_coffee sample_seq1.fasta -weight=sim_pam250mt -out_lib=test.tc_lib
</pre></div>
</div>
<p>Several options are available:</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>sim</strong>             : indicates that the weight equals the average identity within the sequences containing the matched residues.</p></li>
<li><p><strong>OW&lt;X&gt;</strong>           : will cause the sim weight to be multiplied by X.</p></li>
<li><p><strong>sim_matrix_name</strong> : indicates the average identity with two residues regarded as identical when their substitution value is positive. The valid matrices names are in <code class="docutils literal notranslate"><span class="pre">matrices.h</span></code> (pam250mt). Matrices not found in this header are considered to be filenames (Refer to the next section about matrices). For instance, -weight=sim_pam250mt indicates that the grouping used for similarity will be the set of classes with positive substitutions.</p></li>
<li><p><strong>sim_clustalw_col</strong>: categories of clustalw marked with “:”.</p></li>
<li><p><strong>sim_clustalw_dot</strong>: categories of clustalw marked with “.”.</p></li>
</ul>
</div></blockquote>
<ul class="simple">
<li><p><strong>-lib_list</strong> (usage:<strong>-lib_list=&lt;filename&gt;</strong>) [Unsupported]</p></li>
</ul>
<p>Use this flag if you do not want the library computation to take into account all the possible pairs in your dataset.</p>
<ul class="simple">
<li><p><strong>-do_self</strong> [Unsupported]</p></li>
</ul>
<p>This flag causes the extension to carried out within the sequences (as opposed to between sequences). This is necessary when looking for internal repeats with Mocca.</p>
<ul class="simple">
<li><p><strong>-seq_name_for_quadruplet</strong> [Unsupported]</p></li>
<li><p><strong>-compact</strong> [Unsupported]</p></li>
<li><p><strong>-clean</strong> [Unsupported]</p></li>
<li><p><strong>-maximise</strong> [Unsupported]</p></li>
</ul>
</section>
<section id="tree-computation">
<h5>Tree computation<a class="headerlink" href="#tree-computation" title="Permalink to this heading"></a></h5>
<ul class="simple">
<li><p><strong>-distance_matrix_mode</strong> (usage:<strong>-distance_matrix_mode=[slow,fast,very_fast]</strong>/default:<strong>very_fast</strong>)</p></li>
</ul>
<p>This flag indicates the method used for computing the distance matrix (distance between every pair of sequences) required for the computation of the dendrogram.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span> <span class="n">slow</span>      <span class="p">:</span> <span class="n">the</span> <span class="n">chosen</span> <span class="n">dp_mode</span> <span class="n">using</span> <span class="n">the</span> <span class="n">extended</span> <span class="n">library</span>
<span class="o">-</span> <span class="n">fast</span>      <span class="p">:</span> <span class="n">the</span> <span class="n">fasta</span> <span class="n">dp_mode</span> <span class="n">using</span> <span class="n">the</span> <span class="n">extended</span> <span class="n">library</span>
<span class="o">-</span> <span class="n">very_fast</span> <span class="p">:</span> <span class="n">the</span> <span class="n">fasta</span> <span class="n">dp_mode</span> <span class="n">using</span> <span class="n">blosum62mt</span>
<span class="o">-</span> <span class="n">ktup</span>      <span class="p">:</span> <span class="n">Ktup</span> <span class="n">matching</span> <span class="p">(</span><span class="n">MUSCLE</span><span class="o">-</span><span class="n">like</span><span class="p">)</span>
<span class="o">-</span> <span class="n">aln</span>       <span class="p">:</span> <span class="n">read</span> <span class="n">the</span> <span class="n">distances</span> <span class="n">on</span> <span class="n">a</span> <span class="n">precomputed</span> <span class="n">MSA</span>
</pre></div>
</div>
<ul class="simple">
<li><p><strong>-quicktree</strong> [cw]</p></li>
</ul>
<p>Causes T-Coffee to compute a fast approximate guide tree; this flag is kept for compatibility with ClustalW.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee sample_seq1.fasta -distance_matrix_mode=very_fast

$$: t_coffee sample_seq1.fasta -quicktree
</pre></div>
</div>
</section>
<section id="weighting-schemes">
<h5>Weighting schemes<a class="headerlink" href="#weighting-schemes" title="Permalink to this heading"></a></h5>
<ul class="simple">
<li><p><strong>-seq_weight</strong> (usage:<strong>-seq_weight=[t_coffee or &lt;file_name&gt;]</strong>/default:<strong>-seq_weight=t_coffee</strong>)</p></li>
</ul>
<p>These are the individual weights assigned to each sequence. The t_coffee weights try to compensate the bias in consistency caused by redundancy in the sequences.*</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">)</span><span class="o">=%</span><span class="n">similarity</span> <span class="n">between</span> <span class="n">A</span> <span class="ow">and</span> <span class="n">B</span><span class="p">,</span> <span class="n">between</span> <span class="mi">0</span> <span class="ow">and</span> <span class="mf">1.</span>
<span class="n">weight</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="nb">sum</span><span class="p">(</span><span class="n">sim</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">X</span><span class="p">)</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<p>Weights are normalized so that their sum equals the number of sequences. They are applied onto the primary library in the following manner:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">res_score</span><span class="p">(</span><span class="n">Ax</span><span class="p">,</span><span class="n">By</span><span class="p">)</span><span class="o">=</span><span class="n">Min</span><span class="p">(</span><span class="n">weight</span><span class="p">(</span><span class="n">A</span><span class="p">),</span> <span class="n">weight</span><span class="p">(</span><span class="n">B</span><span class="p">))</span><span class="o">*</span><span class="n">res_score</span><span class="p">(</span><span class="n">Ax</span><span class="p">,</span> <span class="n">By</span><span class="p">)</span>
</pre></div>
</div>
<p>These are very simple weights. Their main goal is to prevent a single sequence present in many copies to dominate the alignment.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The library output by <strong>-out_lib</strong> is the unweighted library; weights can be output using the <strong>-outseqweight</strong> flag; you can use your own weights (see <strong>T-Coffee Parameter Files Format</strong> subsection).</p>
</div>
</section>
<section id="pairwise-alignment-computation">
<h5>Pairwise alignment computation<a class="headerlink" href="#pairwise-alignment-computation" title="Permalink to this heading"></a></h5>
<p>Most parameters in this section refer to the alignment mode <strong>fasta_pair_wise</strong> and <strong>cfatsa_pair_wise</strong>. When using these alignment modes, things proceed as follow:</p>
<ol class="arabic simple">
<li><p>Sequences are recoded using a degenerated alphabet provided with <strong>-sim_matrix</strong></p></li>
<li><p>Recoded sequences are then hashed into ktuples of size <strong>-ktup</strong></p></li>
<li><p>Dynamic programming runs on the <strong>-ndiag</strong> best diagonals whose score is higher than <strong>-diag_threshold</strong>, the way diagonals are scored is controlled via <strong>-diag_mode</strong>.</p></li>
<li><p>The Dynamic computation is made to optimize either the library scoring scheme (as defined by the <strong>-in</strong>) or a substitution matrix as provided via <strong>-matrix</strong>. The penalty scheme is defined by <strong>-gapopen</strong> and <strong>-gapext</strong>. If <strong>-gapopen</strong> is undefined, the value defined via <strong>-cosmetic_penalty</strong> is used instead.</p></li>
<li><p>Terminal gaps are scored according to <strong>-tg_mode</strong>.</p></li>
</ol>
<ul class="simple">
<li><p><strong>-dp_mode</strong> (usage:<strong>-dp_mode=&lt;string&gt;</strong>/default:<strong>-dp_mode=cfasta_fair_wise</strong>).</p></li>
</ul>
<p>This flag indicates the type of dynamic programming used by the program. Users may find by looking into the code that other modes with fancy names exists (viterby_pair_wise…). Unless mentioned in this documentation, these modes are NOT SUPPORTED.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee sample_seq1.fasta -dp_mode myers_miller_pair_wise
</pre></div>
</div>
<p>The possible modes are:</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>gotoh_pair_wise</strong>: implementation of the gotoh algorithm (quadratic in memory and time).</p></li>
<li><p><strong>myers_miller_pair_wise</strong>: implementation of the Myers and Miller dynamic programming algorithm ( quadratic in time and linear in space). This algorithm is recommended for very long sequences. It is about 2 times slower than gotoh and only accepts <strong>-tg_mode= 1 or 2</strong> (i.e. gaps penalized for opening).</p></li>
<li><p><strong>fasta_pair_wise</strong>: implementation of the fasta algorithm. The sequence is hashed, looking for ktuples words. Dynamic programming is only carried out on the ndiag best scoring diagonals. This is much faster but less accurate than the two previous. This mode is controlled by the parameters <strong>-ktuple, -diag_mode and -ndiag</strong>.</p></li>
<li><p><strong>cfasta_pair_wise</strong>: c stands for checked but it is the same algorithm. The dynamic programming is made on the ndiag best diagonals, and then on the 2*ndiags, and so on until the scores converge. Complexity will depend on the level of divergence of the sequences, but will usually be L*log(L), with an accuracy comparable to the two first mode (this was checked on BaliBase). This mode is controlled by the parameters <strong>-ktuple, -diag_mode and -ndiag</strong>.</p></li>
</ul>
</div></blockquote>
<ul class="simple">
<li><p><strong>-ktuple</strong> (usage:<strong>-ktuple=[value]</strong>/default:<strong>-ktuple=1 or 2</strong>).</p></li>
</ul>
<p>Indicates the ktuple size for cfasta_pair_wise and fasta_pair_wise of <strong>-dp_mode</strong>. It is set to 1 for proteins, and 2 for DNA. The alphabet used for protein can be a degenerated version, set with <strong>-sim_matrix</strong>.</p>
<ul class="simple">
<li><p><strong>-ndiag</strong> (usage:<strong>-ndiag=[value]</strong>/default:<strong>-ndiag=0</strong>)</p></li>
</ul>
<p>Indicates the number of diagonals used by the fasta_pair_wise algorithm (<strong>-dp_mode</strong>). When <strong>-ndiag=0</strong>, n_diag=Log (length of the smallest sequence)+1. When <strong>-ndiag &amp; -diag_threshold</strong> are set, diagonals are selected if and only if they fulfill both conditions.</p>
<ul class="simple">
<li><p><strong>-diag_mode</strong> (usage:<strong>-diag_mode=[value]</strong>/default:<strong>-diag_mode=0</strong>)</p></li>
</ul>
<p>Indicates the manner in which diagonals are scored during the fasta hashing: “0” indicates that the score of a diagonal is equal to the sum of the scores of the exact matches it contains, and “1” indicates that this score is set equal to the score of the best uninterrupted segment (useful when dealing with fragments of sequences).</p>
<ul class="simple">
<li><p><strong>-diag_threshold</strong> (usage:<strong>-diag_threshold=[value]</strong>/default:<strong>-diag_threshold=0</strong>)</p></li>
</ul>
<p>Sets the value of the threshold when selecting diagonals. A value of 0: indicates that <strong>-ndiag</strong> (seen before) should be used to select the diagonals.</p>
<ul class="simple">
<li><p><strong>-sim_matrix</strong> (usage:<strong>-sim_matrix=[string]</strong>/default:<strong>-sim_matrix=vasiliky</strong>)</p></li>
</ul>
<p>Indicates the manner in which the aminoacid alphabet is degenerated when hashing in the fasta_pairwise dynamic programming. Standard ClustalW matrices are all valid. They are used to define groups of aminoacids having positive substitution values. In T-Coffee, the default is a 13 letter grouping named Vasiliky, with residues grouped as follows: [RK], [DE], [QH], [VILM], [FY], and all other residues kept alone. To keep the standard alphabet non degenerated, better use <strong>-sim_matrix=idmat</strong>.</p>
<ul class="simple">
<li><p><strong>-matrix</strong> (usage:<strong>-matrix=[blosum62mt,…]</strong>/default:<strong>-matrix=blosum62mt</strong>) [cw]</p></li>
</ul>
<blockquote>
<div><p>The usage of this flag has been modified from previous versions due to frequent mistakes in its usage. This flag sets the matrix that will be used by alignment methods within T-Coffee (slow_pair,lalign_id_pair). It does not affect external methods (like clustal_pair, clustal_aln…). Users can also provide their own matrices, using your own <cite>matrix &lt;http://www.tcoffee.org/Projects/tcoffee/documentation/index.html#blast-format-recommended&gt;</cite>.</p>
</div></blockquote>
<ul class="simple">
<li><p><strong>-nomatch</strong> (usage:<strong>-nomatch=[positive value]</strong>/default:<strong>-nomatch=0</strong>)</p></li>
</ul>
<p>Indicates the penalty to associate with a match. When using a library, all matches are positive or equal to 0. Matches equal to 0 are unsupported by the library but not penalized. Setting <strong>-nomatch</strong> to a non negative value makes it possible to penalize these null matches and prevent unrelated sequences from being aligned (this can be useful when the alignments are meant to be used for structural modeling).</p>
<ul class="simple">
<li><p><strong>-gapopen</strong> (usage:<strong>-gapopen=[negative value]</strong>/default:<strong>-gapopen=0</strong>)</p></li>
</ul>
<p>Indicates the penalty applied for opening a gap. The penalty must be negative. If no value is provided when using a substitution matrix, a value will be automatically computed.</p>
<ul class="simple">
<li><p><strong>-gapext</strong> (usage:<strong>-gapext=[negative value]</strong>/default:<strong>-gapext=0</strong>)</p></li>
</ul>
<p>Indicates the penalty applied for extending a gap. The penalty must be negative. If no value is provided when using a substitution matrix, a value will be automatically computed.</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>Here are some guidelines regarding the tuning of <strong>-gapopen</strong> and <strong>-gapext</strong>. In T-Coffee matches get a score between 0 (match) and 1000 (match perfectly consistent with the library). The default cosmetic penalty is set to -50 (5% of a perfect match). If you want to tune <strong>-gaopen</strong> and see a strong effect, you should therefore consider values between 0 and -1000.</p>
</div>
<ul class="simple">
<li><p><strong>-cosmetic_penalty</strong> (usage:<strong>-cosmetic_penalty=[negative value]</strong>/default:<strong>-cosmetic_penalty=-50</strong>)</p></li>
</ul>
<p>Indicates the penalty applied for opening a gap. This penalty is set to a very low value, it will only have an influence on the portions of the alignment that are unalignable. It will not make them more correct but only more pleasing to the eye (avoid stretches of lonely residues). The cosmetic penalty is automatically turned off if a substitution matrix is used rather than a library.</p>
<ul class="simple">
<li><p><strong>-tg_mode</strong> (usage:<strong>-tg_mode=[0,1 or 2]</strong>/default:<strong>-tg_mode=1</strong>)</p></li>
</ul>
<p>The values indicate a penalty on the terminal gaps: “0” a penalty of -gapopen + -gapext*len; “1” a penalty of -gapext*len; and
“2” for no penalty associated to terminal gaps.</p>
<ul class="simple">
<li><p><strong>-fgapopen</strong> [Unsupported]</p></li>
<li><p><strong>-fgapext</strong> [Unsupported]</p></li>
</ul>
</section>
<section id="multiple-alignment-computation">
<h5>Multiple alignment computation<a class="headerlink" href="#multiple-alignment-computation" title="Permalink to this heading"></a></h5>
<ul class="simple">
<li><p><strong>-one2all</strong> (usage:<strong>-one2all=[name]</strong>)</p></li>
</ul>
<p>Will generate a one to all library with respect to the specified sequence and will then align all the sequences in turn to that sequence, in a sequence determined by the order in which the sequences were provided.If <strong>-profile_comparison=profile</strong>, the MSAs provided via <strong>-profile</strong> are vectorized and the function specified by <strong>-profile_comparison</strong> is used to make profile-profile alignments. In that case, the complexity is NL^2.</p>
<ul class="simple">
<li><p><strong>-profile_comparison</strong> (usage:<strong>-profile_mode=[fullN,profile]</strong>/default:<strong>-profile_mode=full50</strong>)</p></li>
</ul>
<p>The profile mode flag controls the multiple profile alignments in T-Coffee. There are two instances where T-Coffee can make multiple profile alignments:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>When N, the number of sequences is higher than <strong>-maxnseq</strong>, the program switches to its multiple profile alignment mode (t_coffee_dpa [Unsupported]).</p></li>
<li><p>When MSAs are provided via <strong>-profile, -profile1 or -profile2</strong>. In these situations, the <strong>-profile_mode</strong> value influences the alignment computation, these values are: a) <strong>-profile_comparison=profile</strong>, the MSAs provided via <strong>-profile</strong> are vectorized and the function specified by <strong>-profile_comparison</strong> is used to make profile-profile alignments. In that case, the complexity is NL^2; b) <strong>-profile_comparison=fullN</strong>, N is an integer value that can omitted. Full indicates that given two profiles, the alignment will be based on a library that includes every possible pair of sequences between the two profiles. If N is set, then the library will be restricted to the N most similar pairs of sequences between the two profiles, as judged from a measure made on a pairwise alignment of these two profiles.</p></li>
</ol>
</div></blockquote>
<ul class="simple">
<li><p><strong>-profile_mode**(usage:</strong>-profile_mode=[cw_profile_profile, muscle_profile_profile, multi_channel]**/default:<strong>-profile_mode=cw_profile_profile</strong>)</p></li>
</ul>
<p>When <strong>-profile_comparison=profile</strong>, this flag selects a profile scoring function.</p>
<ul class="simple">
<li><p><strong>-msa_mode</strong> (usage:<strong>-msa_mode=[tree,graph,precomputed]</strong>/default:<strong>-evaluate_mode=tree</strong>) [Unsupported]</p></li>
</ul>
</section>
<section id="large-scale-aligment-computation-unsupported">
<h5>Large scale aligment computation [Unsupported]<a class="headerlink" href="#large-scale-aligment-computation-unsupported" title="Permalink to this heading"></a></h5>
<ul class="simple">
<li><p><strong>-dpa</strong> (usage:<strong>-dpa</strong>/default:<strong>unset</strong>) [Unsupported]</p></li>
</ul>
<blockquote>
<div><p>This flag triggers the dpa mode. This mode involves computing the &lt;-dpa_tree&gt; that is then resolved into an alignment on buckets of &lt;-dpa_nseq&gt; sequences using &lt;-dpa_method&gt; as an aligner. If no &lt;-dpa_method&gt; is provided the T-Coffee aligner is used and all the parameters (including modes) are passed to T-Coffee. Note that all the output parameters are not supported. Note tha sequences should be input using the -seq flag.</p>
</div></blockquote>
<ul class="simple">
<li><p><strong>-dpa_nseq</strong> (usage:<strong>-dpa_nseq=[ineger]</strong>/default:<strong>-dpa_nseq=30</strong>)</p></li>
</ul>
<blockquote>
<div><p>Specifies the maximum bucket size when using the dpa mode. The buckets are provided to the &lt;dpa_method&gt; or to the remainder of the command line</p>
</div></blockquote>
<ul class="simple">
<li><p><strong>-dpa_tree</strong> (usage:<strong>-dpa_tree=[file, method]</strong>/default:<strong>-dpa_tree=kmtree</strong>)</p></li>
</ul>
<blockquote>
<div><p>Specifies the dpa tree</p>
</div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dpa_tree</span> <span class="n">modes</span>
<span class="c1">##: catswl       --- caterpilar tree with sequences ordered according to their distance from the average swl vector</span>
<span class="c1">##:                  the swl vector of a sequence is defined as the SMith and Waterman Length against the -swlN N sequences</span>
<span class="c1">##: catlong      --- caterpilar tree with sequences ordered according to their length (longuest on root)</span>
<span class="c1">##: catshort     --- caterpilar tree with sequences ordered according to their length (shortest on root)</span>
<span class="c1">##: swldnd       --- Kmeans ran on the &lt;-swlN&gt; dimention vector where each component is the SW length of a sequence against a swlN seed</span>
<span class="c1">##: kmdnd        --- use kmeans based on triaa vectors (fast)</span>
<span class="c1">##: codnd        --- clustalo guide tree, obtainned by running clustalo externaly</span>
<span class="c1">##: cwdnd        --- clustalw guide tree, obtainned by running clustalw externaly</span>
<span class="c1">##: #&lt;pg&gt;        --- runs pg &lt;seq&gt; &gt; stdout that outputs the tree on the stdou</span>
<span class="c1">##: parttree     --- MAFFT parttree (external)</span>
<span class="c1">##: dpparttree   --- MAFFT dpparttree (external)</span>
<span class="c1">##: fastparttree --- MAFFT fastparttree (external)</span>
</pre></div>
</div>
<ul class="simple">
<li><p><strong>-dpa_swlN</strong> (usage:<strong>-dpa_swlN=[integer]</strong>/default:<strong>-dpa_swlN=10</strong>)</p></li>
</ul>
<blockquote>
<div><p>When computing sw vetcors, specifies the number of N seed sequences to do an all-against-N. The sequences are selected evenly among the full sequences set sorted by size.</p>
</div></blockquote>
<ul class="simple">
<li><p><strong>-dpa_weight</strong> (usage:<strong>-dpa_weight=[file, method]</strong>/default:<strong>-dpa_weight=longuest</strong>). Weight used to push sequences from buckets to buckets. Sequence with the highest weight gets pushed one lebel up.</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dpa_weight</span> <span class="n">modes</span>
<span class="c1">##: longuest     --- push the longuest sequence</span>
<span class="c1">##: shortest     --- push the shortest sequence</span>
<span class="c1">##: name         --- push the sequence with the shorttes name (debug purpose)</span>
<span class="c1">##: #&lt;pg&gt;        --- runs pg &lt;seq&gt; &gt; stdout that outputs a two column file &lt;seqname&gt; &lt;float weight value&gt; (fasta w/o sequences can be read)</span>
<span class="c1">##: &lt;file&gt;       --- reads weights from two column file &lt;seqname&gt; &lt;float weight value&gt; (fasta w/o sequences can be read)</span>
<span class="c1">##: kmeans       --- assign to each sequence the size of its kmeans cluster, as computed using triaa vectors and requesting 100 groups</span>
<span class="c1">##: swa,iswa     --- assigns to each sequence the average length of its SW alignment (matched residues) against the -dpa_swlN seed sequences, iswa for invert</span>
<span class="c1">##: swl,iswl     --- assign each sequence a weight equal to its distance from the average sequence using a swlN component vector, iswl for invert</span>
<span class="c1">##: diaa,idiaa   --- assign each sequence a weight equal to its distance from the average sequence using a diaa component vector, idiaa fro invert</span>
<span class="c1">##: triaa,itriaa --- assign each sequence a weight equal to its distance from the average sequence using a triaa component vector, itriaa fro invert</span>
</pre></div>
</div>
</section>
<section id="local-alignments-computation-unsupported">
<h5>Local alignments computation [Unsupported]<a class="headerlink" href="#local-alignments-computation-unsupported" title="Permalink to this heading"></a></h5>
<p>It is possible to compute multiple local alignments, using the moca routine. MOCCA is a routine that allows extracting all the local alignments that show some similarity with another predefined fragment. MOCCA is a perl script that calls T-Coffee and provides the appropriate parameters.</p>
<ul class="simple">
<li><p><strong>-domain/-mocca</strong> (usage:<strong>-domain</strong>) [Unsupported]</p></li>
</ul>
<p>This flag indicates that T-Coffee will run using the domain mode. All the sequences will be concatenated, and the resulting sequence will be compared to itself using <strong>lalign_rs_s_pair</strong> mode (lalign of the sequence against itself using keeping the lalign raw score). This step is the most computer intensive, and it is advisable to save the resulting file.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$#: t_coffee -in Ssample_seq1.fasta,Mlalign_rs_s_pair -out_lib=sample_lib1.mocca_lib \
    -domain -start=100 -len=50
</pre></div>
</div>
<p>This instruction will use the fragment 100-150 on the concatenated sequences, as a template for the extracted repeats. The extraction will only be made once. The library will be placed in the file &lt;lib name&gt;. If you want, you can test other coordinates for the repeat, such as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$#: t_coffee -in sample_lib1.mocca_lib -domain -start=100 -len=60
</pre></div>
</div>
<p>This run will use the fragment 100-160, and will be much faster because it does not need to recompute the lalign library.</p>
<ul class="simple">
<li><p><strong>-start</strong> (usage:<strong>-start=[integer]</strong>) [Unsupported]</p></li>
</ul>
<p>This flag indicates the starting position of the portion of sequence that will be used as a template for the repeat extraction. The value assumes that all the sequences have been concatenated, and is given on the resulting sequence.</p>
<ul class="simple">
<li><p><strong>-len</strong> (usage:<strong>-len=[integer]</strong>) [Unsupported]</p></li>
</ul>
<p>This flag indicates the length of the portion of sequence that will be used as a template.</p>
<ul class="simple">
<li><p><strong>-scale</strong> (usage:<strong>-scale=[integer]</strong>/default:<strong>-scale=-100</strong>) [Unsupported]</p></li>
</ul>
<p>This flag indicates the value of the threshold for extracting the repeats. The actual threshold is equal to -motif_len*scale
Increase the scale Increase sensitivity  More alignments( i.e. -50).</p>
<ul class="simple">
<li><p><strong>-domain_interactive</strong> [Unsupported]</p></li>
</ul>
<p>Launches an interactive MOCCA session.</p>
</section>
<section id="alignment-post-processing">
<h5>Alignment post-processing<a class="headerlink" href="#alignment-post-processing" title="Permalink to this heading"></a></h5>
<ul class="simple">
<li><p><strong>-clean_aln</strong></p></li>
</ul>
<p>This flag causes T-Coffee to post-process the MSA. Residues that have a reliability score smaller or equal to <strong>-clean_threshold</strong> (as given by an evaluation that uses <strong>-clean_evaluate_mode</strong>) are realigned to the rest of the alignment. Residues with a score higher than the threshold constitute a rigid framework that cannot be altered. The cleaning algorithm is greedy, it starts from the top left segment of low constitency residues and works its way left to right, top to bottom along the alignment. You can require this operation to be carried out for several cycles using the <strong>-clean_iterations</strong> flag. The rationale behind this operation is mostly cosmetic. In order to ensure a decent looking alignment, the GOP is set to -20 and the GEP to -1. There is no penalty for terminal gaps, and the matrix is blosum62mt. Gaps are always considered to have a reliability score of 0. The use of the cleaning option can result in memory overflow when aligning large sequences.</p>
<ul class="simple">
<li><p><strong>-clean_threshold</strong> (usage:<strong>-clean_threshold=[0-9]</strong>/default:<strong>-clean_aln=1</strong>)</p></li>
</ul>
<p>See <strong>-clean_aln</strong> for details.</p>
<ul class="simple">
<li><p><strong>-clean_iteration</strong> (usage: <strong>-clean_iteration=[1-X]</strong>/default:<strong>-clean_iteration=1</strong>)</p></li>
</ul>
<p>See <strong>-clean_aln</strong> for details.</p>
<ul class="simple">
<li><p><strong>-clean_evaluation_mode</strong> (usage:<strong>-clean_iteration=[evaluation_mode]</strong>/default:<strong>-clean_iteration=t_coffee_non_extended</strong>)</p></li>
</ul>
<p>Indicates the mode used for the evaluation that will indicate the segments that should be realigned. See <strong>-evaluation_mode</strong> for the list of accepted modes.</p>
<ul class="simple">
<li><p><strong>-iterate</strong> (usage: <strong>-iterate=[integer]</strong>/default:<strong>-iterate=0</strong>)</p></li>
</ul>
<p>Sequences are extracted in turn and realigned to the MSA. If <strong>-iterate</strong> is set to -1, each sequence is realigned; otherwise the number of iterations is set by <strong>-iterate</strong>.</p>
</section>
</section>
<section id="template-based-modes">
<h4>Template based modes<a class="headerlink" href="#template-based-modes" title="Permalink to this heading"></a></h4>
<section id="database-searches-parameters">
<h5>Database searches parameters<a class="headerlink" href="#database-searches-parameters" title="Permalink to this heading"></a></h5>
<p>These parameters are used when running template based modes of T-Coffee such as EXPRESSO (3D), PSI-Cofee (homology extension), TM/PSI-Coffee (homology extension/reduced databases), or accurate (mixture of profile and 3D templates).</p>
<ul class="simple">
<li><p><strong>-blast_server</strong> (sage:<strong>-blast_server=[EBI,NCBI,LOCAL]</strong>/default:<strong>-blast_server=EBI</strong>)</p></li>
</ul>
<p>Defines which way BLAST will be used, either through web services or locally. To have more information about BLAST, refer to the <strong>T-Coffee Installation</strong> chapter.</p>
<ul class="simple">
<li><p><strong>-psiJ</strong> (usage:<strong>-psiJ= &lt;D&gt;</strong>/default:1)</p></li>
</ul>
<p>Defines the number of psi-BLAST iterations</p>
<ul class="simple">
<li><p><strong>-protein_db</strong> (usage:<strong>-protein_db=&lt;database&gt;</strong>/default:nr database)</p></li>
</ul>
<p>Database used for the construction of a PSI-BLAST profile.</p>
<ul class="simple">
<li><p><strong>-prot_min_sim</strong> (usage:<strong>-prot_min_sim= [%identity]</strong>/default:40)</p></li>
</ul>
<p>Minimum identity for inclusion of a sequence in a PSI-BLAST profile.</p>
<ul class="simple">
<li><p><strong>-prot_max_sim</strong> (usage:<strong>-prot_max_sim= [%identity]</strong>/default:90)</p></li>
</ul>
<p>Maximum identity for inclusion of a sequence in a PSI-BLAST profile.</p>
<ul class="simple">
<li><p><strong>-prot_min_cov</strong> (usage:<strong>-prot_min_cov=[0-100]</strong>/default:40)</p></li>
</ul>
<p>Minimum coverage for inclusion of a sequence in a PSI-BLAST profile.</p>
<ul class="simple">
<li><p><strong>-pdb_db</strong> (usage:<strong>-protein_db=[database]</strong>/Default:PDB database)</p></li>
</ul>
<p>Database for PDB template to be selected by EXPRESSO. By default it runs on the PDB, but you can specify a version installed locally on your system,</p>
<ul class="simple">
<li><p><strong>-pdb_type</strong> (usage:<strong>-pdb_type=[d,n,m,dnm,dn]</strong>/default:<strong>-pdb_type=d</strong>)</p></li>
</ul>
<p>The different types are as follow: “d” stands for XRAY structures (diffraction), “n” stands for NMR structures, “e” stands for EM structures and “m” stands for models.</p>
<ul class="simple">
<li><p><strong>-pdb_min_sim</strong> (usage:<strong>-pdb_min_sim= [%identity]</strong>/default:35)</p></li>
</ul>
<p>Minimum % identity for a PDB template to be selected by Expresso.</p>
<ul class="simple">
<li><p><strong>-pdb_max_sim</strong> (usage:<strong>-pdb_max_sim= &lt;%identity&gt;</strong>/default:100)</p></li>
</ul>
<p>Maximum % identity for a PDB template to be selected by Expresso.</p>
<ul class="simple">
<li><p><strong>-pdb_min_cov</strong> (usage:<strong>-pdb_min_cov= &lt;0-100t&gt;</strong>/default:50)</p></li>
</ul>
<p>Minimum coverage for a PDB template to be selected by Expresso.
PSI-Coffee and TM-Coffee Parameters</p>
</section>
<section id="psi-coffee-and-tm-coffee-parameters">
<h5>PSI-Coffee and TM-Coffee parameters<a class="headerlink" href="#psi-coffee-and-tm-coffee-parameters" title="Permalink to this heading"></a></h5>
<p>Profiles returned by Blast and PSI-Blast are usualy too large and very redundant. They are trimmed to the &lt;-psitrim=40&gt; most informative sequences, as determined by applying the regressive algorithm onto the returned sequences using &lt;psitrim_tree=codnd&gt;</p>
</section>
<section id="using-structures">
<h5>Using structures<a class="headerlink" href="#using-structures" title="Permalink to this heading"></a></h5>
<ul class="simple">
<li><p><strong>-mode</strong> (usage:<strong>-mode=[3dcoffee,expresso]</strong>)</p></li>
</ul>
<p>Refer to the <strong>T-Coffee Main Documentation</strong> for the structural modes of T-Coffee.</p>
<ul class="simple">
<li><p><strong>-check_pdb_status</strong></p></li>
</ul>
<p>Forces T-Coffee to run <strong>extract_from_pdb</strong> to check the PDB status of each sequence. This can considerably slow down the program.</p>
</section>
<section id="using-finding-pdb-templates-for-the-sequences">
<h5>Using/finding PDB templates for the sequences<a class="headerlink" href="#using-finding-pdb-templates-for-the-sequences" title="Permalink to this heading"></a></h5>
<ul class="simple">
<li><p><strong>-struc_to_use</strong> (usage:<strong>-struc_to_use=[struc1, struc2…]</strong>/ Default:none)</p></li>
</ul>
<p>Restricts the 3D-Coffee to a set of predefined structures.</p>
<ul class="simple">
<li><p><strong>-template_file</strong> (usage:<strong>-template_file =[&lt;filename&gt;,&lt;SCRIPT_scriptname&gt;,SELF_TAG_,SEQFILE_TAG_&lt;filename&gt;,PDB,no&gt;</strong>)</p></li>
</ul>
<p>This flag instructs T-Coffee on the templates that will be used when combining several types of information. For instance, when using structural information, this file will indicate the structural template that corresponds to your sequences. Each template will be used in place of the sequence with the appropriate method. There are several ways to pass the templates, the format of the template file being as followed “&lt;sequence name&gt; &lt;TAG&gt; &lt;template name&gt;”:</p>
<p><strong>Using a “filename”</strong>:</p>
<p>You provide to T-Coffee an existing template file either created by Expresso or on your own. Different types of templates exist but all with the similar format and rules; the type of template on which a method works is declared with the SEQ_TYPE parameter in the method configuration file.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="n">Template</span> <span class="n">file</span> <span class="nb">format</span><span class="p">:</span>
 <span class="o">&gt;&lt;</span><span class="n">sequence</span> <span class="n">name</span><span class="o">&gt;</span> <span class="n">_P_</span> <span class="o">&lt;</span><span class="n">PDB</span> <span class="n">template</span><span class="o">&gt;</span>
 <span class="o">&gt;&lt;</span><span class="n">sequence</span> <span class="n">name</span><span class="o">&gt;</span> <span class="n">_G_</span> <span class="o">&lt;</span><span class="n">gene</span> <span class="n">template</span><span class="o">&gt;</span>
 <span class="o">&gt;&lt;</span><span class="n">sequence</span> <span class="n">name</span><span class="o">&gt;</span> <span class="n">_R_</span> <span class="o">&lt;</span><span class="n">MSA</span> <span class="n">template</span><span class="o">&gt;</span>
 <span class="o">&gt;&lt;</span><span class="n">sequence</span> <span class="n">name</span><span class="o">&gt;</span> <span class="n">_F_</span> <span class="o">&lt;</span><span class="n">RNA</span> <span class="n">Secondary</span> <span class="n">Structure</span><span class="o">&gt;</span>
 <span class="o">&gt;&lt;</span><span class="n">sequence</span> <span class="n">name</span><span class="o">&gt;</span> <span class="n">_T_</span> <span class="o">&lt;</span><span class="n">Transmembrane</span> <span class="n">Secondary</span> <span class="n">Structure</span><span class="o">&gt;</span>
 <span class="o">&gt;&lt;</span><span class="n">sequence</span> <span class="n">name</span><span class="o">&gt;</span> <span class="n">_E_</span> <span class="o">&lt;</span><span class="n">Protein</span> <span class="n">Secondary</span> <span class="n">Structure</span><span class="o">&gt;</span>

 <span class="n">Template</span> <span class="n">file</span> <span class="n">rules</span><span class="p">:</span>
 <span class="o">-</span> <span class="n">Each</span> <span class="n">sequence</span> <span class="n">can</span> <span class="n">have</span> <span class="n">one</span> <span class="n">template</span> <span class="n">of</span> <span class="n">each</span> <span class="nb">type</span> <span class="p">(</span><span class="n">structural</span><span class="p">,</span> <span class="n">genomics</span><span class="o">...</span><span class="p">)</span>
 <span class="o">-</span> <span class="n">Each</span> <span class="n">sequence</span> <span class="n">can</span> <span class="n">only</span> <span class="n">have</span> <span class="n">one</span> <span class="n">template</span> <span class="n">of</span> <span class="n">a</span> <span class="n">given</span> <span class="nb">type</span>
 <span class="o">-</span> <span class="n">Several</span> <span class="n">sequences</span> <span class="n">can</span> <span class="n">share</span> <span class="n">the</span> <span class="n">same</span> <span class="n">template</span>
 <span class="o">-</span> <span class="n">All</span> <span class="n">the</span> <span class="n">sequences</span> <span class="n">do</span> <span class="ow">not</span> <span class="n">need</span> <span class="n">to</span> <span class="n">have</span> <span class="n">a</span> <span class="n">template</span>

 <span class="n">Template</span> <span class="n">based</span> <span class="n">method</span> <span class="n">types</span><span class="p">:</span>
<span class="o">-</span> <span class="n">SEQ_TYPE</span> <span class="n">S</span><span class="p">:</span> <span class="n">a</span> <span class="n">method</span> <span class="n">that</span> <span class="n">uses</span> <span class="n">sequences</span>
<span class="o">-</span> <span class="n">SEQ_TYPE</span> <span class="n">PS</span><span class="p">:</span> <span class="n">a</span> <span class="n">pairwise</span> <span class="n">method</span> <span class="n">that</span> <span class="n">aligns</span> <span class="n">sequences</span> <span class="ow">and</span> <span class="n">structures</span>
<span class="o">-</span> <span class="n">SEQ_TYPE</span> <span class="n">P</span><span class="p">:</span> <span class="n">a</span> <span class="n">method</span> <span class="n">that</span> <span class="n">aligns</span> <span class="n">structures</span> <span class="p">(</span><span class="n">SAP</span> <span class="k">for</span> <span class="n">instance</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Using “SCRIPT_&lt;scriptname&gt;”</strong>:</p>
<p>Indicates that filename is a script that will be used to generate a valid template file. The script will run on a file containing all your sequences using the following syntax (See box 1.). It is also possible to pass some parameters, use &#64; as a separator and # in place of the = sign (See box 2.). For instance, if you want to call the a script named <strong>blast.pl</strong> with the following parameters. Bear in mind that the input/output flags will then be concatenated to this command line so that T-Coffee ends up calling the program using the following system call.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span><span class="p">)</span> <span class="n">Running</span> <span class="n">using</span> <span class="n">a</span> <span class="n">script</span><span class="p">:</span>
<span class="c1">##: scriptname -infile=&lt;your sequences&gt; -outfile=&lt;template_file&gt;</span>

<span class="mi">2</span><span class="p">)</span> <span class="n">Running</span> <span class="n">blast</span><span class="o">.</span><span class="n">pl</span><span class="p">:</span>
<span class="c1">##: blast.pl -db=pdb -dir=/local/test</span>
<span class="c1">##: SCRIPT_blast.pl@db#pdb@dir#/local/test</span>
<span class="c1">##: blast.pl -db=pdb -dir=/local/test -infile=&lt;some tmp file&gt; -outfile=&lt;another tmp file&gt;</span>
</pre></div>
</div>
<p><strong>Using “SELF_TAG”</strong>:</p>
<p>TAG can take the value of any of the known TAGS (_S_, _G_, _P_). <strong>SELF</strong> indicates that the original name of the sequence will be used to fetch the template.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee three_pdb.fasta -template_file SELF_P_
</pre></div>
</div>
<p><strong>Using “SEQFILE_TAG_filename”</strong></p>
<p>Use this flag if your templates are in filename, and are named according to the sequences. For instance, if your protein sequences have been recoded with Exon/Intron information, you should have the recoded sequences names according to the original <code class="docutils literal notranslate"><span class="pre">SEQFILE_G_recodedprotein.fasta</span></code>.</p>
</section>
<section id="using-structure-for-msa-evaluation">
<h5>Using structure for MSA evaluation<a class="headerlink" href="#using-structure-for-msa-evaluation" title="Permalink to this heading"></a></h5>
<p>MSA can be evaluated using structures with T-Coffee special mode APDB/iRMSD (see <strong>T-Coffee Main Documentation</strong>). The requirements to run these modes are similar to running a structure based MSA with Expresso/3D-Coffee. Here we describe the different parameters associated with the APDB mode.</p>
<ul class="simple">
<li><p><strong>-n_excluded_nb</strong> (usage:<strong>-n_excluded_nb=[integer]</strong>/default:1)</p></li>
</ul>
<p>When evaluating the local score of a pair of aligned residues, the residues immediately next to that column should not contribute to the measure. By default the first to the left and first to the right are excluded.</p>
<ul class="simple">
<li><p><strong>-maximum_distance</strong> (usage:<strong>-maximum_distance=[float]</strong>/default:10)</p></li>
</ul>
<p>Size of the neighborhood considered around every residue. If .-local_mode is set to sphere, -maximum_distance is the radius of a sphere centered around each residue. If -local_mode is set to window, then -maximum_distance is the size of the half window (i.e. window_size=-maximum_distance*2+1).</p>
<ul class="simple">
<li><p><strong>-similarity_threshold</strong> (usage:<strong>-similarity_threshold=[integer]</strong>/default:70)</p></li>
</ul>
<p>Fraction of the neighborhood that must be supportive for a pair of residue to be considered correct in APDB. The neighborhood is a sphere defined by -maximum_distance, and the support is defined by <strong>-md_threshold</strong>.</p>
<ul class="simple">
<li><p><strong>-local_mode</strong> (usage:<strong>-local_mode=[sphere,window]</strong>/default:sphere)</p></li>
</ul>
<p>Defines the shape of a neighborhood, either as a sphere or as a window.</p>
<ul class="simple">
<li><p><strong>-filter</strong> (usage:<strong>-filter=&lt;0.00-1.00&gt;</strong>/default:1.00)</p></li>
</ul>
<p>Defines the centiles that should be kept when making the local measure. Foir instance, -filter=0.90 means that the the 10 last centiles will be removed from the evaluation. The filtration is carried out on the iRMSD values.</p>
<ul class="simple">
<li><p><strong>print_rapdb</strong> (usage:<strong>-print_rapdb=[FLAG]</strong>/default:off) [Unsupported]</p></li>
</ul>
<p>This causes the prints out of the exact neighborhood of every considered pair of residues.</p>
<ul class="simple">
<li><p><strong>color_mode</strong> (usage:<strong>-color_mode=[apdb,irmsd]</strong>/default:apdb)</p></li>
</ul>
<p>This flag is meant to control the colored APDB output (local score). This file will either display the local APDB score or the local iRSMD.</p>
</section>
</section>
</section>
<section id="t-coffee-parameter-files-format">
<h3>T-Coffee Parameter Files Format<a class="headerlink" href="#t-coffee-parameter-files-format" title="Permalink to this heading"></a></h3>
<section id="sequence-name-handling">
<h4>Sequence name handling<a class="headerlink" href="#sequence-name-handling" title="Permalink to this heading"></a></h4>
<p>Sequence name handling is meant to be fully consistent with ClustalW (Version 1.75). This implies that in some cases the names of your sequences may be edited when coming out of the program. Five rules apply:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p><strong>No space</strong>: It is your responsibility to make sure that the names you provide are not ambiguous after such an editing. This editing is consistent with Clustalw (Version 1..75). For instance, sequences with spaces “&gt;seq1 human_myc”  will be turned into “&gt;seq1”.</p></li>
<li><p><strong>No strange character</strong>: Some non alphabetical characters are replaced with underscores. These are: ‘;:()’. Other characters are legal and will be kept unchanged. This editing is meant to keep in line with Clustalw (Version 1.75).</p></li>
<li><p><strong>&gt; is NEVER legal</strong> (except as a header token in a FASTA file)</p></li>
<li><p><strong>Name length must be below 100 characters</strong>, although 15 is recommended for compatibility with other programs.</p></li>
<li><p><strong>Duplicated sequences will be renamed</strong> (i.e. sequences with the same name in the same dataset) are allowed but will be renamed according to their original order. When sequences come from multiple sources via the <strong>-in</strong> flag, consistency of the renaming is not guaranteed. You should avoid duplicated sequences as they will cause your input to differ from your output thus making it difficult to track data.</p></li>
</ol>
</div></blockquote>
</section>
<section id="automatic-format-recognition">
<h4>Automatic format recognition<a class="headerlink" href="#automatic-format-recognition" title="Permalink to this heading"></a></h4>
<p>Most common formats are automatically recognized by t_coffee. See -in and the next section for more details. If your format is not recognized, use readseq or clustalw to switch to another format. We recommend FASTA.</p>
<ul class="simple">
<li><p><strong>Sequences</strong>: Sequences can come in the following formats: fasta, pir, swiss-prot, clustal aln, msf aln and t_coffee aln. These formats are the one automatically recognized. Please replace the ‘*’ sign sometimes used for stop codons with an X.</p></li>
<li><p><strong>Structures</strong>: PDB format is recognized by T-Coffee. T-Coffee uses extract_from_pdb (cf -other_pg flag). extract_from_pdb is a small embeded module that can be used on its own to extract information from pdb files.</p></li>
<li><p><strong>RNA Structures</strong>: RNA structures can either be coded as T-Coffee libraries, with each line indicating two paired residues, or as alifold output. The selex format is also partly supported (see the seq_reformat tutorial on RNA sequences handling).</p></li>
<li><p><strong>Alignments</strong>: Alignments can come in the following formats: msf, ClustalW, FASTA, PIR and T-Coffee. The T-Coffee format is very similar to the ClustalW format, but slightly more flexible. Any interleaved format with sequence name on each line will be correctly parsed:</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">empy</span> <span class="n">line</span><span class="o">&gt;</span>  <span class="p">[</span><span class="n">Facultative</span><span class="p">]</span><span class="n">n</span>
<span class="o">&lt;</span><span class="n">line</span> <span class="n">of</span> <span class="n">text</span><span class="o">&gt;</span>  <span class="p">[</span><span class="n">Required</span><span class="p">]</span>
<span class="o">&lt;</span><span class="n">line</span> <span class="n">of</span> <span class="n">text</span><span class="o">&gt;</span> <span class="p">[</span><span class="n">Facultative</span><span class="p">]</span><span class="n">n</span>
<span class="o">&lt;</span><span class="n">empty</span> <span class="n">line</span><span class="o">&gt;</span> <span class="p">[</span><span class="n">Required</span><span class="p">]</span>
<span class="o">&lt;</span><span class="n">empty</span> <span class="n">line</span><span class="o">&gt;</span> <span class="p">[</span><span class="n">Facultative</span><span class="p">]</span><span class="n">n</span>
<span class="o">&lt;</span><span class="n">seq1</span> <span class="n">name</span><span class="o">&gt;&lt;</span><span class="n">space</span><span class="o">&gt;&lt;</span><span class="n">seq1</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">seq2</span> <span class="n">name</span><span class="o">&gt;&lt;</span><span class="n">space</span><span class="o">&gt;&lt;</span><span class="n">seq2</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">seq3</span> <span class="n">name</span><span class="o">&gt;&lt;</span><span class="n">space</span><span class="o">&gt;&lt;</span><span class="n">seq3</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">empty</span> <span class="n">line</span><span class="o">&gt;</span> <span class="p">[</span><span class="n">Required</span><span class="p">]</span>
<span class="o">&lt;</span><span class="n">empty</span> <span class="n">line</span><span class="o">&gt;</span> <span class="p">[</span><span class="n">Facultative</span><span class="p">]</span><span class="n">n</span>
<span class="o">&lt;</span><span class="n">seq1</span> <span class="n">name</span><span class="o">&gt;&lt;</span><span class="n">space</span><span class="o">&gt;&lt;</span><span class="n">seq1</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">seq2</span> <span class="n">name</span><span class="o">&gt;&lt;</span><span class="n">space</span><span class="o">&gt;&lt;</span><span class="n">seq2</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">seq3</span> <span class="n">name</span><span class="o">&gt;&lt;</span><span class="n">space</span><span class="o">&gt;&lt;</span><span class="n">seq3</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">empty</span> <span class="n">line</span><span class="o">&gt;</span> <span class="p">[</span><span class="n">Required</span><span class="p">]</span>
<span class="o">&lt;</span><span class="n">empty</span> <span class="n">line</span><span class="o">&gt;</span> <span class="p">[</span><span class="n">Facultative</span><span class="p">]</span><span class="n">n</span>
</pre></div>
</div>
<p>An empty line is a line that does NOT contain amino-acid. A line that contains the ClustalW annotation (.:*) is empty. Spaces are forbidden in the name. When the alignment is being read, non character signs are ignored in the sequence field (such as numbers, annotation…).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A different number of lines in the different blocks will cause the program to crash or hang.</p>
</div>
</section>
<section id="libraries">
<h4>Libraries<a class="headerlink" href="#libraries" title="Permalink to this heading"></a></h4>
<section id="t-coffee-lib-format-01">
<h5>T-COFFEE_LIB_FORMAT_01<a class="headerlink" href="#t-coffee-lib-format-01" title="Permalink to this heading"></a></h5>
<p>This is currently the only supported format.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>!&lt;space&gt; TC_LIB_FORMAT_01
&lt;nseq&gt;
&lt;seq1 name&gt; &lt;seq1 length&gt; &lt;seq1&gt;
&lt;seq2 name&gt; &lt;seq2 length&gt; &lt;seq2&gt;
&lt;seq3 name&gt; &lt;seq3 length&gt; &lt;seq3&gt;
!Comment
(!Comment)n
#Si1 Si2
Ri1 Ri2 V1 (V2, V3)
#1 2
12 13 99 (12/0 vs 13/1, weight 99)
12 14 70
15 16 56
#1 3
12 13 99
12 14 70
15 16 56
!&lt;space&gt;SEQ_1_TO_N
</pre></div>
</div>
<p>Si1: index of Sequence 1
Ri1: index of residue 1 in seq1
V1: Integer Value: Weight
V2, V3: optional values</p>
<p>Note that here is a space between the ! And SEQ_1_TO_N…and the last line (! SEQ_1_TO_N) indicates that sequences and residues are numbered from 1 to N, unless the token SEQ_1_TO_N is omitted, in which case the sequences are numbered from 0 to N-1, and residues are from 1 to N. Residues do not need to be sorted, and neither do the sequences. The same pair can appear several times in the library. For instance, the following file would be legal:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#1 2</span>
<span class="mi">12</span> <span class="mi">13</span> <span class="mi">99</span>
<span class="c1">#1 2</span>
<span class="mi">15</span> <span class="mi">16</span> <span class="mi">99</span>
<span class="c1">#1 1</span>
<span class="mi">12</span> <span class="mi">14</span> <span class="mi">70</span>
</pre></div>
</div>
<p>It is also possible to declare ranges of residues rather than single pairs. For instance, the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#0 1</span>
<span class="o">+</span><span class="n">BLOCK</span><span class="o">+</span> <span class="mi">10</span> <span class="mi">12</span> <span class="mi">14</span> <span class="mi">99</span>
<span class="o">+</span><span class="n">BLOCK</span><span class="o">+</span> <span class="mi">15</span> <span class="mi">30</span> <span class="mi">40</span> <span class="mi">99</span>
<span class="c1">#0 2</span>
<span class="mi">15</span> <span class="mi">16</span> <span class="mi">99</span>
<span class="c1">#0 1</span>
<span class="mi">12</span> <span class="mi">14</span> <span class="mi">70</span>
</pre></div>
</div>
<p>The first statement BLOCK declares a BLOCK of length 10, that starts on position 12 of sequence 1 and position 14 of sequence 2 and where each pair of residues within the block has a score of 99. The second BLOCK starts on residue 30 of 1, residue 40 of 2 and extends for 15 residues. Blocks can overalp and be incompatible with one another, just like single constraints.</p>
</section>
<section id="t-coffee-lib-format-02">
<h5>T-COFFEE_LIB_FORMAT_02<a class="headerlink" href="#t-coffee-lib-format-02" title="Permalink to this heading"></a></h5>
<p>A simpler format is being developed, however it is not yet fully supported and is only mentioned here for development purpose.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>! TC_LIB_FORMAT_02
#S1 SEQ1 [OPTIONAL]
#S2 SEQ2 [OPTIONAL]
...
!comment [OPTIONAL]
S1 R1 Ri1 S2 R2 Ri2 V1 (V2 V3)
=&gt; N R1 Ri1 S2 R2 Ri2 V1 (V2 V3)
...
</pre></div>
</div>
<p>S1,S2: name of sequence 1 and 2.</p>
<p>SEQ1: sequence of S1.</p>
<p>Ri1, Ri2: index of the residues in their respective sequence.</p>
<p>R1, R2: Residue type.</p>
<p>V1, V2, V3: integer Values (V2 and V3 are optional).</p>
<p>Value1, Value 2 and Value3 are optional.</p>
</section>
<section id="library-list">
<h5>Library List<a class="headerlink" href="#library-list" title="Permalink to this heading"></a></h5>
<p>These are lists of pairs of sequences that must be used to compute a library. The format is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">nseq</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">S1</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">S2</span><span class="o">&gt;</span>
<span class="mi">2</span> <span class="n">hamg2</span> <span class="n">globav</span>
<span class="mi">3</span> <span class="n">hamgw</span> <span class="n">hemog</span> <span class="n">singa</span>
<span class="o">...</span>
</pre></div>
</div>
</section>
</section>
<section id="substitution-matrices">
<h4>Substitution matrices<a class="headerlink" href="#substitution-matrices" title="Permalink to this heading"></a></h4>
<p>If the required substitution matrix is not available, write your own in a file using one of the following format.</p>
<section id="blast-format-recommended">
<h5>BLAST format [Recommended]<a class="headerlink" href="#blast-format-recommended" title="Permalink to this heading"></a></h5>
<p>The alphabet can be freely defined</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># BLAST_MATRIX FORMAT</span>
<span class="c1"># ALPHABET=AGCT</span>
<span class="n">A</span> <span class="n">G</span> <span class="n">C</span> <span class="n">T</span>
<span class="n">A</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span>
<span class="n">G</span> <span class="mi">0</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span>
<span class="n">C</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span>
<span class="o">...</span>
</pre></div>
</div>
</section>
<section id="clustalw-style-deprecated">
<h5>ClustalW style [Deprecated]<a class="headerlink" href="#clustalw-style-deprecated" title="Permalink to this heading"></a></h5>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span># CLUSTALW_MATRIX FORMAT
$
v1
v2 v3
v4 v5 v6
...
$
</pre></div>
</div>
<p>v1, v2… are integers, possibly negatives. The order of the amino acids is: ABCDEFGHIKLMNQRSTVWXYZ, which means that v1 is the substitution value for A vs A, v2 for A vs B, v3 for B vs B, v4 for A vs C and so on.</p>
</section>
</section>
<section id="sequences-weights">
<h4>Sequences weights<a class="headerlink" href="#sequences-weights" title="Permalink to this heading"></a></h4>
<p>Create your own weight file, using the -seq_weight flag:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># SINGLE_SEQ_WEIGHT_FORMAT_01</span>
<span class="n">seq_name1</span> <span class="n">v1</span>
<span class="n">seq_name2</span> <span class="n">v2</span>
<span class="o">...</span>
</pre></div>
</div>
<p>No duplicate allowed. Sequences not included in the set of sequences provided to T-Coffee will be ignored. Order is free. V1 is a float. Unweighted sequences will see their weight set to 1.</p>
</section>
<section id="parameter-files">
<h4>Parameter files<a class="headerlink" href="#parameter-files" title="Permalink to this heading"></a></h4>
<p>Parameter files used with <strong>-parameters</strong>, <strong>-t_coffee_defaults</strong>, <strong>-dali_defaults</strong>…must contain a valid parameter string where line breaks are allowed. These files cannot contain any comment, the recommended format is one parameter per line:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">&gt;=&lt;</span><span class="n">value1</span><span class="o">&gt;</span><span class="p">,</span><span class="o">&lt;</span><span class="n">value2</span><span class="o">&gt;....</span>

<span class="o">&lt;</span><span class="n">parameter</span> <span class="n">name</span><span class="o">&gt;=.....</span>
</pre></div>
</div>
</section>
</section>
<section id="technical-notes">
<h3>Technical Notes<a class="headerlink" href="#technical-notes" title="Permalink to this heading"></a></h3>
<p>These notes are only meant for internal development.</p>
<section id="building-a-t-coffee-server">
<h4>Building a T-Coffee server<a class="headerlink" href="#building-a-t-coffee-server" title="Permalink to this heading"></a></h4>
<p>We maintain a T-Coffee server (www.tcoffee.org). We will be pleased to provide anyone who wants to set up a similar service with the sources</p>
<section id="environment-variables">
<h5>Environment Variables<a class="headerlink" href="#environment-variables" title="Permalink to this heading"></a></h5>
<p>T-Coffee stores a lots of information in locations that may be unsuitable when running a server.</p>
<p>By default, T-Coffee will generate and rely on the following directory structure:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Directory</span> <span class="n">structure</span><span class="p">:</span>
<span class="c1">##: /home/your account/ #HOME_4_TCOFFEE</span>
<span class="c1">##: HOME_4_TCOFFEE/.t_coffee/  #DIR_4_TCOFFEE</span>
<span class="c1">##: DIR_4_TCOFFEE/cache #CACHE_4_TCOFFEE</span>
<span class="c1">##: DIR_4_TCOFFEE/tmp #TMP_4_TCOFFEE</span>
<span class="c1">##: DIR_4_TCOFFEE/methods #METHOS_4_TCOFFEE</span>
<span class="c1">##: DIR_4_TCOFFEE/mcoffee #MCOFFEE_4_TCOFFEE</span>
</pre></div>
</div>
<p>By default, all these directories are automatically created, following the dependencies suggested here. The first step is the determination of the HOME. By default the program tries to use HOME_4_TCOFFEE, then the HOME variable and TMP or TEMP if HOME is not set on your system or your account. It is your responsibility to make sure that one of these variables is set to some valid location where the T-Coffee process is allowed to read and write. If no valid location can be found for HOME_4_TCOFFEE, the program exits. If you are running T-Coffee on a server, we recommend to hard set the following locations, where your scratch is a valid location.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">T</span><span class="o">-</span><span class="n">Coffee</span> <span class="n">server</span> <span class="n">configuration</span><span class="p">:</span>

<span class="c1">##: HOME_4_TCOFFEE=&#39;your scratch&#39;</span>
<span class="c1">##: TMP_4_TCOFFEE=&#39;your scratch&#39;</span>
<span class="c1">##: DIR_4_TCOFFEE=&#39;your scratch&#39;</span>
<span class="c1">##: CACHE_4_TCOFFEE=&#39;your scratch&#39;</span>
<span class="c1">##: NO_ERROR_REPORT_4_TCOFFEE=1</span>
</pre></div>
</div>
<p>Note that it is a good idea to have a cron job that cleans up this scratch area once in a while.</p>
</section>
<section id="output-of-the-dnd-file">
<h5>Output of the .dnd file.<a class="headerlink" href="#output-of-the-dnd-file" title="Permalink to this heading"></a></h5>
<p>A common source of error when running a server: T-Coffee MUST output the .dnd file because it re-reads it to carry out the progressive alignment. By default T-Coffee outputs this file in the directory where the process is running. If the T-Coffee process does not have permission to write in that directory, the computation will abort…To avoid this, simply specify the name of the output tree (refers to the <strong>T-Coffee Parameters &amp; Flags</strong>, in the <strong>Output</strong> subsection about trees). Choose the name so that two processes may not over-write each other dnd file.</p>
</section>
<section id="permissions">
<h5>Permissions<a class="headerlink" href="#permissions" title="Permalink to this heading"></a></h5>
<p>The T-Coffee process MUST be allowed to write in some scratch area, even when it is ran by Mr nobody… Make sure the /tmp/ partition is not protected.</p>
</section>
<section id="other-programs">
<h5>Other Programs<a class="headerlink" href="#other-programs" title="Permalink to this heading"></a></h5>
<p>T-Coffee may call various programs while it runs (lalign2list by defaults). Make sure your process knows where to find these executables.</p>
</section>
</section>
<section id="known-problems">
<h4>Known Problems<a class="headerlink" href="#known-problems" title="Permalink to this heading"></a></h4>
<blockquote>
<div><ol class="arabic simple">
<li><p>Sensitivity to sequence order: it is difficult to implement a MSA algorithm totally insensitive to the order of input of the sequences. In T-Coffee, robustness is increased by sorting the sequences alphabetically before aligning them. Beware that this can result in confusing output where sequences with similar name are unexpectedly close to one another in the final alignment.</p></li>
<li><p>Nucleotides sequences with long stretches of Ns will cause problems to lalign, especially when using Mocca. To avoid any problem, filter out these nucleotides before running mocca.</p></li>
<li><p>Stop codons are sometimes coded with * in protein sequences, this will cause the program to crash or hang. Please replace the all * signs with an X.</p></li>
<li><p>Results can differ from one architecture to another, due rounding differences. This is caused by the tree estimation procedcure. If you want to make sure an alignment is reproducible, you should keep the associated dendrogram.</p></li>
</ol>
</div></blockquote>
</section>
<section id="development">
<h4>Development<a class="headerlink" href="#development" title="Permalink to this heading"></a></h4>
<p>The following examples are only meant for internal development and are used to insure stability from release to release.</p>
<ul class="simple">
<li><p><strong>profile to list</strong></p></li>
</ul>
<p>prf1: profile containing one structure
prf2: profile containing one structure</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee -profile sample_profile1.aln,sample_profile2.aln -mode=3dcoffee
</pre></div>
</div>
<ul class="simple">
<li><p><strong>command line list</strong></p></li>
</ul>
<p>These command lines have been checked before every release along with the other command lines in this documentation.</p>
<ol class="arabic simple">
<li><p>External methods:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee sample_seq1.fasta -in=Mclustalw_pair,Mclustalw_msa,Mslow_pair -outfile=text
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>List of command lines provided by James Watson to crash T-Coffee before version 3.40:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee -mode 3dcoffee -in Sthree_pdb.fasta P1PPG
$$: t_coffee -mode 3dcoffee -in Sthree_pdb.fasta -template_file SELF_P_
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Command line to read ‘relaxed’ PDB files…</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee -in Msap_pair Ssample_3Dseq1.fasta -template_file sample_3Dseq1.template \
    -weight 1000 -out_lib sample_3Dseq1.tc_lib -lib_only
</pre></div>
</div>
<ol class="arabic simple" start="4">
<li><p>Parsing long sequence lines:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee -in Aproteases_large.aln -outfile test.aln
</pre></div>
</div>
</section>
</section>
<section id="t-coffee-test">
<h3>T-Coffee Test<a class="headerlink" href="#t-coffee-test" title="Permalink to this heading"></a></h3>
<p>Before the realease of a new T-Coffee version, many command lines in the documentation are programmatically tested. The purpose of this document is to explain which command lines are tested, how new command lines can be added to the documentation and how to perform a documentation check before a new release.</p>
<section id="introducing-a-new-command-to-test">
<h4>Introducing a new command to test<a class="headerlink" href="#introducing-a-new-command-to-test" title="Permalink to this heading"></a></h4>
<p>In this documentation you will find three types of command lines some of which are up and running on the examples files. Whenever adding a new command, input files must be added to the repository directory ./examples/. New commands can be also be built using the existing files, or they can depend on files newly added to the repository. Here are the three different flag types of command lines you will fine in the documentation “$$”, “$#” and “##”:</p>
<ul class="simple">
<li><p><strong>$$: t_coffee…</strong></p></li>
</ul>
<p>Corresponds to all command that will be tested systematically in a programmatic manner. Other command lines starting with different symbols are not checked.</p>
<ul class="simple">
<li><p><strong>$#: t_coffee…</strong></p></li>
</ul>
<p>Corresponds to a command that could be tested but will not be, either for the sake of time or because it is currently unstable. When a new release needs to be urgently made available because of a critical fix, it is advisable to comment out this way non critical command lines failing the test.</p>
<ul class="simple">
<li><p><strong>##: t_coffee…</strong></p></li>
</ul>
<p>These commands are never tested, either because they contain system dependant information or non programmatic information.</p>
</section>
<section id="checking-the-documentation">
<h4>Checking the documentation<a class="headerlink" href="#checking-the-documentation" title="Permalink to this heading"></a></h4>
<p>Our procedure uses <strong>doc2test.pl</strong> to extract all command lines from the .rst in docs and will run these command lines. When a reference output is available in /testsuite/docs/ref/ it will produce an other output and compare it with the reference. The new output will be put in /testsuite/docs/latest/. The script will eventually produce a global report that is to be found in /testsuite/docs/log/validation.log. The output of the failed scripts will be put in /testsuite/docs/failed. All the reference output will be added to git repository. The simplest way to check the documentation is to run the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Check</span> <span class="n">the</span> <span class="n">documentation</span><span class="p">:</span>
<span class="c1">##: ./lib/perl/lib/perl4makefile/doc2test.pl -mode update</span>
</pre></div>
</div>
<p>When changes are made in the list of command line, we use the following mode  whichwill only run the new command lines and report (defined as those not having a reference output in /testsuite/docs/ref/). This mode is the default mode:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Check</span> <span class="n">new</span> <span class="n">command</span> <span class="n">lines</span><span class="p">:</span>
<span class="c1">##: ./lib/perl/lib/perl4makefile/doc2test.pl -mode new</span>
</pre></div>
</div>
<p>This mode will only run the command lines that have previously failed, as indicated by the presence of an output in the failed directory.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Check</span> <span class="n">failed</span> <span class="n">command</span> <span class="n">lines</span><span class="p">:</span>
<span class="c1">##: ./lib/perl/lib/perl4makefile/doc2test.pl -mode failed</span>
</pre></div>
</div>
</section>
<section id="compiling-the-documentation">
<h4>Compiling the documentation<a class="headerlink" href="#compiling-the-documentation" title="Permalink to this heading"></a></h4>
<p>The documentation can be compiled using the following command; it will cause the test to stop whenever a failed is encountered.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Compile</span> <span class="n">the</span> <span class="n">documentation</span><span class="p">:</span>
<span class="c1">##: ./lib/perl/lib/perl4makefile/doc2test.pl -mode update -stop_on_failed</span>
</pre></div>
</div>
<p>To have a clean start, you can also reset all files. This command will cause all the reference files to be erased:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Reset</span> <span class="n">reference</span> <span class="n">files</span><span class="p">:</span>
<span class="c1">##: ./lib/perl/lib/perl4makefile/doc2test.pl -mode reset</span>
</pre></div>
</div>
<p>To removed unnecessary files, the following command will cause all the files in ./examples/ that are not used for any /docs/<a href="#id2"><span class="problematic" id="id3">*</span></a>.rst commands to be deleted. They will be deleted from both their current locations and the git repository. The remaining files will be added to the git repository.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Remove</span> <span class="n">unnecessary</span> <span class="n">files</span><span class="p">:</span>
<span class="c1">##: ./lib/perl/lib/perl4makefile/doc2test.pl -clean</span>
</pre></div>
</div>
</section>
<section id="making-a-new-release">
<h4>Making a new release<a class="headerlink" href="#making-a-new-release" title="Permalink to this heading"></a></h4>
<p>The Beta and Stable releases can be done with the makefile, from the t_coffee/src/ directory</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span><span class="o">-</span><span class="n">git</span> <span class="n">commit</span> <span class="o">-</span><span class="n">a</span> <span class="o">-</span><span class="n">m</span> <span class="s1">&#39;what you did&#39;</span>
<span class="mi">2</span><span class="o">-</span><span class="n">make</span> <span class="n">beta_release</span> <span class="n">OR</span> <span class="n">make</span> <span class="n">stable_release</span> <span class="o">--</span> <span class="n">This</span> <span class="n">will</span> <span class="n">populate</span> <span class="n">the</span> <span class="n">source</span> <span class="n">directories</span>
<span class="mi">3</span><span class="o">-</span><span class="n">git</span> <span class="n">push</span>
</pre></div>
</div>
</section>
</section>
</section>
<span id="document-tcoffee_webserver"></span><section id="t-coffee-web-server">
<h2>T-Coffee Web Server<a class="headerlink" href="#t-coffee-web-server" title="Permalink to this heading"></a></h2>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This chapter is currently under maintenance. Its aim is to describe what the T-Coffee web server is doing programmatically when you are using it; it provides technical details about the restrictions and commands in use.</p>
</div>
<p>In this chapter we describe briefly the available T-Coffee web servers and their usage (command lines and examples files); if you need more advanced options, you should use the T-Coffee package via command lines. The web server is a reduced version of the T-Coffee package, containing all T-Coffee modes for aligning protein, RNA or DNA sequences; it also contains the evaluation and downstream analysis tools (TCS, iRMSD/APDB, STRIKE, T-RMSD). Currently, all reformatting utilities are not available on the web server, however, you can choose some reformatting options related to the ouput format. Here we present briefly the webserver and the T-Coffee commands it contains.</p>
<section id="general">
<h3>General<a class="headerlink" href="#general" title="Permalink to this heading"></a></h3>
<p>Most of the following command lines used by the web server contains lots of different options called with flags; here is a summary of the options common to all comand lines:</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>-in</strong>: your input file</p></li>
<li><p><strong>-output</strong>: specifies the output files you require</p></li>
<li><p><strong>-maxnseq</strong>: maximum number of sequences you can run (variable depending on the mode)</p></li>
<li><p><strong>-maxlength</strong>: maximum length of your sequences (variable depending on the mode)</p></li>
<li><p><strong>-case=upper</strong>: all residues/nucleotids will be upper case</p></li>
<li><p><strong>-seqnos=off</strong>: the size of the sequences is not indicated on the MSA</p></li>
<li><p><strong>-outorder=input</strong>: orders the sequences in the final MSA as in the input dataset</p></li>
<li><p><strong>-run_name</strong>: name of the job on the cluster</p></li>
<li><p><strong>-multi_core=4</strong>: uses only 4 cores on your server when running the job</p></li>
<li><p><strong>-quiet=stdout</strong>: standard verbose output</p></li>
</ul>
</div></blockquote>
</section>
<section id="t-coffee-simple-msa">
<h3>T-Coffee Simple MSA<a class="headerlink" href="#t-coffee-simple-msa" title="Permalink to this heading"></a></h3>
<p>The central part of the web server is the T-Coffee aligner, you can use it to align any kind of sequences (Protein, RNA or DNA alike). The command it runs is the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$#: t_coffee -in=data_93c5fbb0.in -mode=regular -output=score_html clustalw_aln fasta_aln \
    score_ascii phylip -maxnseq=150 -maxlen=10000 -case=upper -seqnos=off -outorder=input \
    -run_name=result -multi_core=4 -quiet=stdout
</pre></div>
</div>
</section>
<section id="protein-sequences">
<h3>Protein Sequences<a class="headerlink" href="#protein-sequences" title="Permalink to this heading"></a></h3>
<section id="expresso-using-3d-structures">
<h4>Expresso (using 3D structures)<a class="headerlink" href="#expresso-using-3d-structures" title="Permalink to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$#: t_coffee -in=data_93c5fbb0.in -mode=expresso -blast=LOCAL -pdb_db=/db/pdb/derived_data_\
    format/blast/2016-01-01/pdb_seqres.fa -evaluate_mode=t_coffee_slow -output=score_html \
    clustalw_aln fasta_aln score_ascii phylip -maxnseq=150 -maxlen=2500 -case=upper -seqnos= \
    off -outorder=input -run_name=result -multi_core=4 -quiet=stdout
</pre></div>
</div>
</section>
<section id="m-coffee-combining-multiple-methods">
<h4>M-Coffee (combining multiple methods)<a class="headerlink" href="#m-coffee-combining-multiple-methods" title="Permalink to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$#: t_coffee -in=data_93c5fbb0.in  Mpcma_msa Mmafft_msa Mclustalw_msa Mdialigntx_msa Mpoa_msa \
    Mmuscle_msa Mprobcons_msa Mt_coffee_msa -output=score_html clustalw_aln fasta_aln \
    score_ascii phylip -tree -maxnseq=150 -maxlen=2500 -case=upper -seqnos=off -outorder=input \
    -run_name=result -multi_core=4 -quiet=stdout
</pre></div>
</div>
</section>
<section id="psi-tm-coffee-transmembrane-proteins">
<h4>PSI/TM-Coffee (transmembrane proteins)<a class="headerlink" href="#psi-tm-coffee-transmembrane-proteins" title="Permalink to this heading"></a></h4>
<p>Two options are available (in addition to the choice of the database): without transmembrane prediction or with prediction (displayed color coded on the html file).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$#: tmcoffee.sh -in data_9df741d4.in -mode psicoffee -blast_server LOCAL --search-db &#39;UniRef50 \
    -- Very Fast/Rough&#39; --search-type &#39;&#39; -prot_min_sim 50 -prot_max_sim 90 -prot_min_cov 70 \
    --search-out &#39;clustalw_aln fasta_aln score_ascii phylip score_html&#39; -maxnseq 1000 -maxlen \
    =5000 -case upper -seqnos=off -outorder input -run_name result -multi_core 4 -quiet=stdout

$#: tmcoffee.sh -in data_9df741d4.in -mode psicoffee -blast_server LOCAL --search-db &#39;UniRef50 \
    -- Very Fast/Rough&#39; --search-type &#39;transmembrane&#39; -prot_min_sim 50 -prot_max_sim 90 \
    -prot_min_cov 70 --search-out &#39;clustalw_aln fasta_aln score_ascii phylip score_html&#39;
    -maxnseq 1000 -maxlen 5000 -case upper -seqnos off -outorder input -run_name result º
    -multi_core 4 -quiet=stdout
</pre></div>
</div>
</section>
<section id="psi-coffee-homology-extension">
<h4>PSI-Coffee (homology extension)<a class="headerlink" href="#psi-coffee-homology-extension" title="Permalink to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$#: t_coffee -in=data_93c5fbb0.in -mode=psicoffee -blast=LOCAL -protein_db=/db/ncbi/201511/ \
    blast/db/nr.fa -output=score_html clustalw_aln fasta_aln score_ascii phylip -maxnseq=150 \
    -maxlen=2500 -case=upper -seqnos=off -outorder=input -run_name=result -multi_core=4 \
    -quiet=stdout
</pre></div>
</div>
</section>
</section>
<section id="rna-sequences">
<h3>RNA Sequences<a class="headerlink" href="#rna-sequences" title="Permalink to this heading"></a></h3>
<section id="r-coffee-using-2d-prediction">
<h4>R-Coffee (using 2D prediction)<a class="headerlink" href="#r-coffee-using-2d-prediction" title="Permalink to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$#: t_coffee -in=data_29091222.in -method=mafft_msa muscle_msa probconsRNA_msa -output= \
    score_html clustalw_aln fasta_aln score_ascii phylip -maxnseq=150 -maxlen=2500 -case=upper \
    -seqnos=off -outorder=input -run_name=result -tree -special_mode=rcoffee -method_limits= \
    consan_pair 5 150 -multi_core=4 -quiet=stdout
</pre></div>
</div>
</section>
<section id="sara-coffee-using-3d-structures">
<h4>SARA-Coffee (using 3D structures)<a class="headerlink" href="#sara-coffee-using-3d-structures" title="Permalink to this heading"></a></h4>
<p>SARA-Coffee is a bit complicated to run, it uses several third party packages and is run through a script and environment variables we set up; here is what it looks like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>##: export X3DNA=/data/www-cn/sara_coffee_package/X3DNA;
##: export PDB_DIR=/data/www-cn/sara_coffee_package/PDBdir/;
##: export NO_REMOTE_PDB_DIR=1;
##: unset MAFFT_BINARIES;
##: cd $CACHE_4_TCOFFEE
##: ln -s /data/www-cn/sara_coffee_package/pdb_entry_type.txt);
$#: t_coffee -in data_3e6e7aec.in -method sara_pair -template_file \
    /data/www-cn/sara_coffee_package/TEMPLATEFILE,RNA -extend_mode rna2 -relax_lib 0 -transform \
    dna2rna -run_name=result -output score_html clustalw_aln -case=upper -seqnos=off -outorder= \
    input -multi_core=4 -pdb_min_sim 0 -quiet stdout
</pre></div>
</div>
</section>
<section id="rm-coffee-combining-multiple-methods">
<h4>RM-Coffee (combining multiple methods)<a class="headerlink" href="#rm-coffee-combining-multiple-methods" title="Permalink to this heading"></a></h4>
<p>Not yet available…</p>
</section>
</section>
<section id="dna-sequences">
<h3>DNA Sequences<a class="headerlink" href="#dna-sequences" title="Permalink to this heading"></a></h3>
<section id="id1">
<h4>M-Coffee (combining multiple methods)<a class="headerlink" href="#id1" title="Permalink to this heading"></a></h4>
<p>For now, M-Coffee by default is the same for DNA, RNA and protein sequences alike. There is no specific M-Coffee for DNA sequences.</p>
</section>
<section id="pro-coffee-homologous-promoter-regions">
<h4>Pro-Coffee (homologous promoter regions)<a class="headerlink" href="#pro-coffee-homologous-promoter-regions" title="Permalink to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$#: t_coffee -in=data_476efe5f.in -mode=procoffee -output=score_html clustalw_aln fasta_aln \
    score_ascii phylip -maxnseq=150 -maxlen=10000 -case=upper -seqnos=off -outorder=input \
    -run_name=result -multi_core=4 -quiet=stdout
</pre></div>
</div>
</section>
</section>
<section id="evaluation-tools">
<h3>Evaluation Tools<a class="headerlink" href="#evaluation-tools" title="Permalink to this heading"></a></h3>
<section id="tcs-transitive-consistency-score">
<h4>TCS (Transitive Consistency Score)<a class="headerlink" href="#tcs-transitive-consistency-score" title="Permalink to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">##: tcs.sh -infile data_a98d61a6.in -in Mproba_pair -score 1 -output clustalw_aln fasta_aln \</span>
    <span class="n">phylip</span> <span class="n">score_ascii</span> <span class="n">tcs_weighted</span> <span class="n">tcs_replicate</span> <span class="n">score_html</span> <span class="o">-</span><span class="n">maxnseq</span> <span class="mi">1000</span> <span class="o">-</span><span class="n">maxlen</span> <span class="mi">8000</span> \
    <span class="o">-</span><span class="n">seqnos</span><span class="o">=</span><span class="n">off</span> <span class="o">-</span><span class="n">run_name</span> <span class="n">result</span> <span class="o">-</span><span class="n">multi_core</span> <span class="mi">4</span> <span class="o">--</span><span class="nb">filter</span><span class="o">-</span><span class="nb">type</span> <span class="n">column</span> <span class="o">--</span><span class="nb">filter</span><span class="o">-</span><span class="nb">min</span> <span class="mi">4</span> <span class="o">--</span><span class="nb">filter</span><span class="o">-</span><span class="nb">max</span> \
    <span class="mi">9</span> <span class="o">--</span><span class="nb">filter</span><span class="o">-</span><span class="n">gap</span> <span class="n">yes</span> <span class="o">-</span><span class="n">quiet</span><span class="o">=</span><span class="n">stdout</span>
</pre></div>
</div>
</section>
<section id="irmsd-apdb-msa-structural-evaluation-under-maintenance">
<h4>iRMSD/APDB (MSA structural evaluation) (under maintenance…)<a class="headerlink" href="#irmsd-apdb-msa-structural-evaluation-under-maintenance" title="Permalink to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$#: t_coffee -other_pg apdb -aln data_c7151320.in -apdb_outfile default -outfile default \
    -io_format hsg3 -output score_html -maximum_distance 10 -md_threshold 2.0 -similarity_ \
    threshold 70 -template_file EXPRESSO -run_name result -quiet stdout
</pre></div>
</div>
</section>
<section id="t-rmsd-structural-clustering">
<h4>T-RMSD (structural clustering)<a class="headerlink" href="#t-rmsd-structural-clustering" title="Permalink to this heading"></a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$#: t_coffee -in=data_b89d3438.in -mode=expresso -cache=$PWD -blast=LOCAL -pdb_db=/db/pdb/ \
    derived_data_format/blast/2016-01-01/pdb_seqres.fa -evaluate_mode=t_coffee_slow -output= \
    aln score_html -maxnseq=150 -maxlen=2500 -case=upper -outorder=input -run_name=result \
    -multi_core=4 -quiet=stdout; t_coffee -other_pg trmsd result.aln -template_file \
    result_pdb1.template_list -output color_html 2&gt;&amp;1; [ -e result.struc_tree.consensus ]
</pre></div>
</div>
</section>
<section id="strike-msa-evaluation-with-single-structure">
<h4>STRIKE (MSA evaluation with single structure)<a class="headerlink" href="#strike-msa-evaluation-with-single-structure" title="Permalink to this heading"></a></h4>
<dl>
<dt>::</dt><dd><p>$#: wget      <a class="reference external" href="ftp://ftp.rcsb.org/pub/pdb/derived_data/pdb_seqres.txt">ftp://ftp.rcsb.org/pub/pdb/derived_data/pdb_seqres.txt</a>
$#: install   <a class="reference external" href="ftp://ftp.ncbi.nlm.nih.gov/blast/executables/blast+/LATEST">ftp://ftp.ncbi.nlm.nih.gov/blast/executables/blast+/LATEST</a></p>
<p>$#: t_coffee -other_pg strike &lt;sequence file&gt; -template_file PDB  -pdb_db &lt;pdb_seqres&gt; -blast_server LOCAL</p>
</dd>
</dl>
</section>
</section>
</section>
<span id="document-tcoffee_faq"></span><section id="faq">
<h2>FAQ<a class="headerlink" href="#faq" title="Permalink to this heading"></a></h2>
<section id="abnormal-terminations-results">
<h3>Abnormal Terminations &amp; Results<a class="headerlink" href="#abnormal-terminations-results" title="Permalink to this heading"></a></h3>
<section id="q-the-program-keeps-crashing-when-i-give-my-sequences">
<h4>Q: The program keeps crashing when I give my sequences<a class="headerlink" href="#q-the-program-keeps-crashing-when-i-give-my-sequences" title="Permalink to this heading"></a></h4>
<p>A-1: This may be a format problem. Try to reformat your sequences, we recommend the FASTA format. If the problem persists, contact us.</p>
<p>A-2: Your sequences may not be recognized for what they really are. Normally T-Coffee recognizes the type of your sequences automatically, but if it fails specify the sequence format with <strong>-type</strong> and the type of sequence <strong>DNA, RNA or PROTEIN</strong>.</p>
<p>A-3: Costly computation or data gathered over the net is stored by T-Coffee in a cache directory. Sometimes, some of these files can be corrupted and cause an abnormal termination. You can either empty the cache ( ~/.t_coffee/cache/), request T-Coffee to run without using it (command 1), or update the files corresponding to your data (command 2).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Command 1: No cache
$$: t_coffee -pdb=struc1.pdb,struc2.pdb,struc3.pdb -method sap_pair -cache=no

Command 2: Update cache
$$: t_coffee -pdb=struc1.pdb,struc2.pdb,struc3.pdb -method sap_pair -cache=update
</pre></div>
</div>
</section>
<section id="q-the-default-alignment-is-not-good-enough">
<h4>Q: The default alignment is not good enough<a class="headerlink" href="#q-the-default-alignment-is-not-good-enough" title="Permalink to this heading"></a></h4>
<p>A: see next question</p>
</section>
<section id="q-the-alignment-contains-obvious-mistakes">
<h4>Q: The alignment contains obvious mistakes<a class="headerlink" href="#q-the-alignment-contains-obvious-mistakes" title="Permalink to this heading"></a></h4>
<p>A: This happens with most multiple alignment procedures. However, wrong alignments are sometimes caused by bugs or an implementation mistake. Please report the most unexpected results to the authors.</p>
</section>
<section id="q-the-program-is-crashing">
<h4>Q: The program is crashing<a class="headerlink" href="#q-the-program-is-crashing" title="Permalink to this heading"></a></h4>
<p>A: If you get the message <strong>FAILED TO ALLOCATE REQUIRED MEMORY</strong> refer to the next question. Otherwise, if the program crashes check whether you are using the right syntax. If the problem persists, contact us.</p>
</section>
<section id="q-i-am-running-out-of-memory">
<h4>Q: I am running out of memory<a class="headerlink" href="#q-i-am-running-out-of-memory" title="Permalink to this heading"></a></h4>
<p>A: You can use a more accurate, slower and less memory hungry dynamic programming mode called myers_miller_pair_wise (command 1). Note that this mode will be much less time efficient than the default, although it may be slightly more accurate. In practice the parameterization associate with special mode turns off every memory expensive heuristic within T-Coffee (command 2). If you keep running out of memory, you may also want to reduce the number of sequences using <strong>-maxnseq</strong>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Command 1:
$$: t_coffee sample_seq1.fasta -mode low_memory

Command 2:
$$: t_coffee sample_seq1.fasta -method=slow_pair,lalign_id_pair -distance_matrix_mode \
    =idscore -dp_mode=myers_miller_pair_wise
</pre></div>
</div>
</section>
</section>
<section id="input-output-control">
<h3>Input/Output control<a class="headerlink" href="#input-output-control" title="Permalink to this heading"></a></h3>
<section id="q-how-many-sequences-can-t-coffee-handle">
<h4>Q: How many sequences can T_Coffee handle?<a class="headerlink" href="#q-how-many-sequences-can-t-coffee-handle" title="Permalink to this heading"></a></h4>
<p>A: T-Coffee is recommanded for a maximum of 200. Above this number, the regreessive flavor (<strong>t_coffee -reg</strong> ) should be used</p>
</section>
<section id="q-can-i-change-line-length-in-the-defaut-format">
<h4>Q: Can I change line length in the defaut format?<a class="headerlink" href="#q-can-i-change-line-length-in-the-defaut-format" title="Permalink to this heading"></a></h4>
<p>A: Yes, by using the flag <strong>-aln_line_length</strong>.</p>
</section>
<section id="q-can-i-prevent-the-output-of-all-the-warnings">
<h4>Q: Can I prevent the output of all the warnings?<a class="headerlink" href="#q-can-i-prevent-the-output-of-all-the-warnings" title="Permalink to this heading"></a></h4>
<p>A: Yes, by setting <strong>-no_warning</strong>.</p>
</section>
<section id="q-how-many-ways-to-pass-parameters-to-t-coffee">
<h4>Q: How many ways to pass parameters to t_coffee?<a class="headerlink" href="#q-how-many-ways-to-pass-parameters-to-t-coffee" title="Permalink to this heading"></a></h4>
<p>A: Refer to the <strong>T-Coffee Technical Documentation</strong>, Section <strong>T-Coffee Parameters &amp; Flags</strong>.</p>
</section>
<section id="q-how-can-i-change-the-default-output-format">
<h4>Q: How can I change the default output format?<a class="headerlink" href="#q-how-can-i-change-the-default-output-format" title="Permalink to this heading"></a></h4>
<p>A: See the <strong>-output</strong> option in the <strong>T-Coffee Main Documentation</strong>; nearly all common output formats are recognized by T-Coffee.</p>
</section>
<section id="q-my-sequences-are-slightly-different-between-all-the-alignments">
<h4>Q: My sequences are slightly different between all the alignments.<a class="headerlink" href="#q-my-sequences-are-slightly-different-between-all-the-alignments" title="Permalink to this heading"></a></h4>
<p>A: It does not matter. T-Coffee will reconstruct a set of sequences that incorporates all the residues potentially missing in some of the sequences (See flag <strong>-in</strong>).</p>
</section>
<section id="q-is-it-possible-to-pipe-stuff-out-of-t-coffee">
<h4>Q: Is it possible to pipe stuff out of T-Coffee?<a class="headerlink" href="#q-is-it-possible-to-pipe-stuff-out-of-t-coffee" title="Permalink to this heading"></a></h4>
<p>A: Specify stderr or stdout as output filename, the output will be redirected accordingly. For instance this instruction will output the tree (in Newick format) and the alignment to stdout.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee sample_seq1.fasta -outfile=stdout -out_lib=stdout
</pre></div>
</div>
</section>
<section id="q-is-it-possible-to-pipe-stuff-into-t-coffee">
<h4>Q: Is it possible to pipe stuff into T_Coffee?<a class="headerlink" href="#q-is-it-possible-to-pipe-stuff-into-t-coffee" title="Permalink to this heading"></a></h4>
<p>A: If as a file name you specify stdin, the content of this file will be expected throught pipe:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: cat sample_seq1.fasta | t_coffee -infile=stdin

is equivalent to:

$$: t_coffee sample_seq1.fasta
</pre></div>
</div>
<p>If you do not give any argument to T-Coffee, they will be expected to come from pipe:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: cat sample_param_file.param | t_coffee -parameters=stdin

or

$$: echo -seq=sample_seq1.fasta -method=clustalw_pair | t_coffee -parameters=stdin
</pre></div>
</div>
</section>
<section id="q-can-i-read-my-parameters-from-a-file">
<h4>Q: Can I read my parameters from a file?<a class="headerlink" href="#q-can-i-read-my-parameters-from-a-file" title="Permalink to this heading"></a></h4>
<p>A: See the <strong>T-Coffee Technical Documentation</strong>.</p>
</section>
<section id="q-i-want-to-decide-myself-on-the-name-of-the-output-files">
<h4>Q: I want to decide myself on the name of the output files !!!<a class="headerlink" href="#q-i-want-to-decide-myself-on-the-name-of-the-output-files" title="Permalink to this heading"></a></h4>
<p>A: Use the <strong>-run_name</strong> flag:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee sample_seq1.fasta -run_name=luke_skywalker
</pre></div>
</div>
</section>
<section id="q-i-want-to-use-the-sequences-in-an-alignment-file">
<h4>Q: I want to use the sequences in an alignment file<a class="headerlink" href="#q-i-want-to-use-the-sequences-in-an-alignment-file" title="Permalink to this heading"></a></h4>
<p>A: Simply fed your alignment any way you like, but do not forget to append the prefix S for sequence:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee sample_aln1.aln -in proba_pair

$$: t_coffee -seq=sample_aln1.aln -method=slow_pair,lalign_id_pair -outfile=outaln
</pre></div>
</div>
<p>This means that the gaps will be reset and that the alignment you provide will not be considered as an alignment, but as a set of sequences.</p>
</section>
<section id="q-i-only-want-to-produce-a-library">
<h4>Q: I only want to produce a library<a class="headerlink" href="#q-i-only-want-to-produce-a-library" title="Permalink to this heading"></a></h4>
<p>A: use the <strong>-lib_only</strong> flag; but note that this supersedes the use of the <strong>-convert</strong> flag. Its main advantage is to restrict computation time to the actual library computation.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee sample_seq1.fasta -out_lib=sample_lib1.tc_lib -lib_only
</pre></div>
</div>
</section>
<section id="q-i-want-to-turn-an-alignment-into-a-library">
<h4>Q: I want to turn an alignment into a library<a class="headerlink" href="#q-i-want-to-turn-an-alignment-into-a-library" title="Permalink to this heading"></a></h4>
<p>A: use the <strong>-lib_only</strong> flag (command 1). It is also possible to control the weight associated with this alignment with the flag <strong>-weight</strong> (command 2).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Command 1:
$$: t_coffee -in=Asample_aln1.aln -out_lib=sample_lib1.tc_lib -lib_only

Command 2:
$$: t_coffee -aln=sample_aln1.aln -out_lib=sample_lib1.tc_lib -lib_only -weight=1000
</pre></div>
</div>
</section>
<section id="q-i-want-to-concatenate-two-libraries">
<h4>Q: I want to concatenate two libraries<a class="headerlink" href="#q-i-want-to-concatenate-two-libraries" title="Permalink to this heading"></a></h4>
<p>A: You cannot concatenate these files on their own. You will have to use T-Coffee assuming you want to combine for instance <code class="docutils literal notranslate"><span class="pre">tc_lib1.tc_lib</span></code> and <code class="docutils literal notranslate"><span class="pre">tc_lib2.tc_lib</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee -lib=sample_lib1.tc_lib,sample_lib2.tc_lib -lib_only -out_lib=sample_lib3.tc_lib
</pre></div>
</div>
</section>
<section id="q-what-happens-to-the-gaps-when-an-alignment-is-fed-to-t-coffee">
<h4>Q: What happens to the gaps when an alignment is fed to T-Coffee?<a class="headerlink" href="#q-what-happens-to-the-gaps-when-an-alignment-is-fed-to-t-coffee" title="Permalink to this heading"></a></h4>
<p>A: An alignment is <strong>ALWAYS</strong> considered as a library <strong>AND</strong> a set of sequences. If you want your alignment to be considered as a library only, use the S identifier; it will be seen as a sequence file, even if it has an alignment format (gaps will be removed).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee Ssample_aln1.aln -outfile=outaln
</pre></div>
</div>
</section>
<section id="q-i-cannot-print-the-html-graphic-display">
<h4>Q: I cannot print the html graphic display!!!<a class="headerlink" href="#q-i-cannot-print-the-html-graphic-display" title="Permalink to this heading"></a></h4>
<p>A: This is a problem that has to do with your browser. Instead of requesting the score_html output, request the score_ps output that can be read using ghostview:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Postscript
$$: t_coffee sample_seq1.fasta -output=score_ps

PDF only if you have ps2pdf installed
$*: t_coffee sample_seq1.fasta -output=score_pdf
</pre></div>
</div>
</section>
<section id="q-i-want-to-output-an-html-file-and-a-regular-file">
<h4>Q: I want to output an html file and a regular file<a class="headerlink" href="#q-i-want-to-output-an-html-file-and-a-regular-file" title="Permalink to this heading"></a></h4>
<p>A: See the next question.</p>
</section>
<section id="q-i-would-like-to-output-more-than-one-alignment-format-at-the-same-time">
<h4>Q: I would like to output more than one alignment format at the same time<a class="headerlink" href="#q-i-would-like-to-output-more-than-one-alignment-format-at-the-same-time" title="Permalink to this heading"></a></h4>
<p>A: The flag <strong>-output</strong> accepts more than one parameter. For instance this will output four alignment files in the corresponding formats. Alignments’ names will have the format name as an extension.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee sample_seq1.fasta -output=clustalw,html,score_ps,msf
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note: you need to have the converter ps2pdf installed on your system (standard under Linux and Cygwin). The latest versions of Internet Explorer and Netscape now allow the user to print the html display. Do not forget to request background printing.</p>
</div>
</section>
</section>
<section id="alignment-computation">
<h3>Alignment computation<a class="headerlink" href="#alignment-computation" title="Permalink to this heading"></a></h3>
<section id="q-is-t-coffee-the-best-why-not-using-muscle-mafft-or-probcons">
<h4>Q: Is T-Coffee the best? Why not using MUSCLE, MAFFT, or ProbCons???<a class="headerlink" href="#q-is-t-coffee-the-best-why-not-using-muscle-mafft-or-probcons" title="Permalink to this heading"></a></h4>
<p>A: All these packages are good packages and they sometimes outperform T-Coffee. They also claim to outperform one another… If you have them installed locally, you can have T-Coffee to generate a consensus alignment:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee sample_seq1.fasta -method muscle_msa,probcons_msa,mafft_msa,lalign_id_pair,slow_pair
</pre></div>
</div>
</section>
<section id="q-can-t-coffee-align-nucleic-acids">
<h4>Q: Can T_Coffee align nucleic acids ???<a class="headerlink" href="#q-can-t-coffee-align-nucleic-acids" title="Permalink to this heading"></a></h4>
<p>A: Normally it can, but check in the log that the program recognises the right type. If this fails, you will need to manually set the type using <strong>-type dna</strong></p>
</section>
<section id="q-i-do-not-want-to-compute-the-alignment">
<h4>Q: I do not want to compute the alignment<a class="headerlink" href="#q-i-do-not-want-to-compute-the-alignment" title="Permalink to this heading"></a></h4>
<p>A: use the <strong>-convert</strong> flag. This command will read the .aln file and turn it into an .msf alignment.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee sample_aln1.aln -convert -output=gcg
</pre></div>
</div>
</section>
<section id="q-i-would-like-to-force-some-residues-to-be-aligned">
<h4>Q: I would like to force some residues to be aligned<a class="headerlink" href="#q-i-would-like-to-force-some-residues-to-be-aligned" title="Permalink to this heading"></a></h4>
<p>If you want to brutally force some residues to be aligned, you may use as a post processing, the <strong>+force_aln</strong> function of <strong>seq_reformat</strong>. You can either specify single (command 1) or multiple constraints using a TC_LIB_FORMAT_02 file (command 2). When giving more than one constraint, these will be applied one after the other in the order they are provided. This greedy procedure means that the Nth constraint may disrupt the (N-1)th previously imposed constraint, hence the importance of forcing the constraints in the right order, with the most important coming last. We do not recommend imposing hard constraints on an alignment, and it is much more advisable to use the soft constraints provided by standard T-Coffee libraries (cf. <strong>T-Coffee Technical Documentation</strong>, subsection <strong>Creating your own T-Coffee libraries</strong>).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Command 1: single constraint
$$: t_coffee -other_pg seq_reformat -in sample_aln3.aln -action +force_aln seq1 5 seq2 6

Command 2: multiple constraints
$$: t_coffee -other_pg seq_reformat -in sample_aln3.aln -action +force_aln sample_lib3.tc_lib02
</pre></div>
</div>
<p>The TC_LIB_FORMAT_02 is still experimental and unsupported. It can only be used in the context of the force_aln function described here. The tc_lib02 format is as follow:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">*</span><span class="n">TC_LIB_FORMAT_02</span>
<span class="n">SeqX</span> <span class="n">resY</span> <span class="n">ResY_index</span>  <span class="n">SeqZ</span> <span class="n">ResZ</span> <span class="n">ResZ_index</span>
</pre></div>
</div>
</section>
<section id="q-i-would-like-to-use-structural-alignments">
<h4>Q: I would like to use structural alignments<a class="headerlink" href="#q-i-would-like-to-use-structural-alignments" title="Permalink to this heading"></a></h4>
<p>Refer to the <strong>T-Coffee Main Documentation and/or T-Coffee Technical Documentation</strong>.</p>
</section>
<section id="q-i-want-to-build-my-own-libraries">
<h4>Q: I want to build my own libraries<a class="headerlink" href="#q-i-want-to-build-my-own-libraries" title="Permalink to this heading"></a></h4>
<p>A: Turn your alignment into a library, forcing the residues to have a very good weight, using structure:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee -aln=sample_seq1.aln -weight=1000 -out_lib=sample_seq1.tc_lib -lib_only
</pre></div>
</div>
<p>The value 1000 is simply a high value that should make it more likely for the substitution found in your alignment to reoccur in the final alignment. This will produce the library sample_aln1.tc_lib that you can later use when aligning all the sequences:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee -seq=sample_seq1.fasta -lib=sample_seq1.tc_lib -outfile sample_seq1.aln
</pre></div>
</div>
<p>If you only want some of these residues to be aligned, or want to give them individual weights, you will have to edit the library file yourself or use the -force_aln option (cf FAQ: I would like to force some residues to be aligned). A value of N*N * 1000 (N being the number of sequences) usually ensure the respect of a constraint.</p>
</section>
<section id="q-i-want-to-use-my-own-tree">
<h4>Q: I want to use my own tree<a class="headerlink" href="#q-i-want-to-use-my-own-tree" title="Permalink to this heading"></a></h4>
<p>A: Use the <strong>-usetree=&lt;your own tree&gt;</strong> flag:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee sample_seq1.fasta -usetree=sample_seq1_tree_nj.nwk
</pre></div>
</div>
</section>
<section id="q-i-want-to-align-coding-dna">
<h4>Q: I want to align coding DNA<a class="headerlink" href="#q-i-want-to-align-coding-dna" title="Permalink to this heading"></a></h4>
<p>A: Use the <strong>fasta_cdna_pair</strong> method that compares two cDNA using the best reading frame and taking frameshifts into account. Notice that in the resulting alignments (command 1), all the gaps are of modulo3, except one small gap in the first line of sequence hmgl_trybr. This is a frameshift made on purpose. You can realign the same sequences while ignoring their coding potential and treating them like standard DNA (command 2).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Command 1:
$$: t_coffee three_cdna.fasta -method=cdna_fast_pair

Command 2:
$$: t_coffee three_cdna.fasta
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This method has not yet been fully tested and is only provided ‘as-is’ with no warranty. Any feedback will be much appreciated.</p>
</div>
</section>
<section id="q-i-do-not-want-to-use-all-the-possible-pairs-when-computing-the-library">
<h4>Q: I do not want to use all the possible pairs when computing the library<a class="headerlink" href="#q-i-do-not-want-to-use-all-the-possible-pairs-when-computing-the-library" title="Permalink to this heading"></a></h4>
<p>See next question.</p>
</section>
<section id="q-i-only-want-to-use-specific-pairs-to-compute-the-library">
<h4>Q: I only want to use specific pairs to compute the library<a class="headerlink" href="#q-i-only-want-to-use-specific-pairs-to-compute-the-library" title="Permalink to this heading"></a></h4>
<p>A: Simply write in a file the list of sequence groups you want to use. Pairwise methods (slow_pair, proba_pair, &lt;method&gt;_pair…) will only be applied to list of pairs of sequences, while multiple methods (clustalw_msa, mafft_msa, &lt;method_msa…) will be applied to any dataset having more than two sequences.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee sample_seq1.fasta -method=clustalw_pair,clustalw_msa -lib_list=sample_list1.lib_list

Format of the list of libraries:
***************sample_list1.lib_list****
2 hmgl_trybr hmgt_mouse
2 hmgl_trybr hmgb_chite
2 hmgl_trybr hmgl_wheat
3 hmgl_trybr hmgl_wheat hmgl_mouse
***************sample_list1.lib_list****
</pre></div>
</div>
</section>
<section id="q-there-are-duplicates-or-quasi-duplicates-in-my-set">
<h4>Q: There are duplicates or quasi-duplicates in my set.<a class="headerlink" href="#q-there-are-duplicates-or-quasi-duplicates-in-my-set" title="Permalink to this heading"></a></h4>
<p>A: If you can remove them, this will make the program run faster, otherwise the T-Coffee scoring scheme should be able to avoid overweighting of overrepresented sequences.</p>
</section>
</section>
<section id="using-structures-and-profiles">
<h3>Using Structures and Profiles<a class="headerlink" href="#using-structures-and-profiles" title="Permalink to this heading"></a></h3>
<section id="q-can-i-align-sequences-to-a-profile-with-t-coffee">
<h4>Q: Can I align sequences to a profile with T-Coffee?<a class="headerlink" href="#q-can-i-align-sequences-to-a-profile-with-t-coffee" title="Permalink to this heading"></a></h4>
<p>A: Yes, you simply need to indicate that your alignment is a profile with the R tag:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee sample_seq1.fasta -profile=sample_aln2.aln -outfile chewbacca
</pre></div>
</div>
</section>
<section id="q-can-i-align-sequences-two-or-more-profiles">
<h4>Q: Can I align sequences two or more profiles?<a class="headerlink" href="#q-can-i-align-sequences-two-or-more-profiles" title="Permalink to this heading"></a></h4>
<p>A: Yes, you, simply tag your profiles with the letter R and the program will treat them like standard sequences:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee -profile=sample_aln1.aln,sample_aln2.aln -outfile han_solo
</pre></div>
</div>
</section>
<section id="q-can-i-align-two-profiles-according-to-the-structures-they-contain">
<h4>Q: Can I align two profiles according to the structures they contain?<a class="headerlink" href="#q-can-i-align-two-profiles-according-to-the-structures-they-contain" title="Permalink to this heading"></a></h4>
<p>A: Yes, as long as the structure sequences are named according to their PDB identifier:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee -profile=sample_profile1.aln,sample_profile2.aln -mode=3dcoffee
</pre></div>
</div>
</section>
<section id="q-t-coffee-becomes-very-slow-when-combining-sequences-and-structures">
<h4>Q: T-Coffee becomes very slow when combining sequences and structures<a class="headerlink" href="#q-t-coffee-becomes-very-slow-when-combining-sequences-and-structures" title="Permalink to this heading"></a></h4>
<p>A: This is true. By default the structures are fetched through the net using RCSB. The problem arises when T-Coffee looks for the structure of sequences WITHOUT structures. One solution is to install the PDB database locally. In that case you will need to set two environment variables:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Variables</span> <span class="n">to</span> <span class="nb">set</span> <span class="n">up</span><span class="p">:</span>
<span class="c1">##: setenv (or export) PDB_DIR=&#39;directory containing the pdb structures&#39;</span>
<span class="c1">##: setenv (or export) NO_REMOTE_PDB_DIR=1</span>
</pre></div>
</div>
<p>Interestingly, the observation that sequences without structures are those that take the most time to be checked is a reminder of the strongest rational argument that I know of against torture: any innocent would require the maximum amount of torture to establish his/her innocence, which sounds…hummmm…strange.. Then again I was never struck by the efficiency of the Bush Jr administration.</p>
</section>
<section id="q-can-i-use-a-local-installation-of-pdb">
<h4>Q: Can I use a local installation of PDB?<a class="headerlink" href="#q-can-i-use-a-local-installation-of-pdb" title="Permalink to this heading"></a></h4>
<p>A: Yes, T-Coffee supports three types of installations:</p>
<ul class="simple">
<li><p><em>Ad hoc</em> installation where all your structures are in a directory under the form pdbid.pdb, pdbid.id.Z or pdbid.pdb.gz. In that case, all you need to do is set the environement variables correctly:</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Setting</span> <span class="n">up</span> <span class="n">variable</span>
<span class="c1">##: setenv (or export) PDB_DIR=&#39;directory containing the pdb structures&#39;</span>
<span class="c1">##: setenv (or export) NO_REMOTE_PDB_DIR=1</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Full standard PDB installation using the all section of PDB. In that case, you must set the variables to:</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Setting</span> <span class="n">up</span> <span class="n">variable</span>
<span class="c1">##: setenv (or export) PDB_DIR=&#39;&lt;some absolute path&gt;/data/structures/all/pdb/&#39;</span>
<span class="c1">##: setenv (or export) NO_REMOTE_PDB_DIR=1</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Reduced standard PDB installation using the divided section of pdb:</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Setting</span> <span class="n">up</span> <span class="n">the</span> <span class="n">PDB</span><span class="p">:</span>
<span class="c1">##: setenv (or export) PDB_DIR=&#39;&lt;some absolute path&gt;/data/structures/divided/pdb/</span>
<span class="c1">##: setenv (or export) NO_REMOTE_PDB_DIR=1</span>
</pre></div>
</div>
<p>If you need to do more clever things, you should know that all the PDB manipulation is made in T-Coffee by a perl script named <strong>extract_from_pdb</strong>. You can then edit the script to suit your needs; T-Coffee will use your edited version if it is in the current directory and issue a warning that it used a local version. If you make extensive modifications, I would appreciate you send me the corrected file so that I can incorporate it in the next distribution. By default, T-Coffee also requires two important PDB files declared using the two following variables. These variables do not need to be set if the considered files are in the cache directory (default behavior):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Found</span> <span class="n">at</span><span class="p">:</span> <span class="n">ftp</span><span class="p">:</span><span class="o">//</span><span class="n">ftp</span><span class="o">.</span><span class="n">wwpdb</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">pub</span><span class="o">/</span><span class="n">pdb</span><span class="o">/</span><span class="n">derived_data</span><span class="o">/</span><span class="n">pdb_entry_type</span><span class="o">.</span><span class="n">txt</span>
<span class="c1">##: export PDB_ENTRY_TYPE_FILE=&lt;location of the file pdb_entry_type.txt&gt;</span>

<span class="n">Found</span> <span class="n">at</span><span class="p">:</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">rcsb</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">pdb</span><span class="o">/</span><span class="n">rest</span><span class="o">/</span><span class="n">getUnreleased</span>
<span class="c1">##: export PDB_UNREALEASED_FILE=&lt;location of the file unrealeased.xml&gt;</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Since the file <code class="docutils literal notranslate"><span class="pre">unreleased.xml</span></code> is not part of the PDB distribution, T-Coffee will make an attempt to obtain it even when using the <strong>NO_REMOTE_PDB_DIR=1 mode</strong>. You must therefore make sure that the file <code class="docutils literal notranslate"><span class="pre">PDB_UNREALEASED_FILE</span></code> is pointing to is read and write.</p>
</div>
</section>
</section>
<section id="improving-evaluating-your-msas">
<h3>Improving/Evaluating Your MSAs<a class="headerlink" href="#improving-evaluating-your-msas" title="Permalink to this heading"></a></h3>
<section id="q-how-can-i-edit-my-alignment-manually">
<h4>Q: How can I edit my alignment manually?<a class="headerlink" href="#q-how-can-i-edit-my-alignment-manually" title="Permalink to this heading"></a></h4>
<p>A: We recommend to use Jalview, a free program for MSA editing that you can find <a class="reference external" href="http://www.jalview.org">here</a>.</p>
</section>
<section id="q-have-i-improved-or-not-my-alignment">
<h4>Q: Have I improved or not my alignment?<a class="headerlink" href="#q-have-i-improved-or-not-my-alignment" title="Permalink to this heading"></a></h4>
<p>A: Using structural information is the only way to establish whether you have improved or not your alignment. The CORE index can also give you some information. Refers to the <strong>T-Coffee Main Documentation</strong>, section <strong>Evaluating Your Alignment</strong>.</p>
</section>
<section id="q-how-good-is-my-alignment">
<h4>Q: How good is my alignment?<a class="headerlink" href="#q-how-good-is-my-alignment" title="Permalink to this heading"></a></h4>
<p>A: Refers to the <strong>T-Coffee Main Documentation</strong>, section <strong>Evaluating Your Alignment</strong>. Or just look at the color index ;-)</p>
</section>
<section id="q-what-is-that-color-index">
<h4>Q: What is that color index?<a class="headerlink" href="#q-what-is-that-color-index" title="Permalink to this heading"></a></h4>
<p>A: T-Coffee can provide you with a measure of consistency among all the methods used. An html file is produced by default each time you run an alignment. This html file is a colored version of your MSA that you can visualize with any common browser. As alternatives, you can use <strong>score_ps</strong> (postscript), <strong>score_pdf</strong> (pdf file) or <strong>score_ascii</strong> (text file). If you want more information about the CORE index represented by this color index, have a look at this <a class="reference external" href="http://www.tcoffee.org/Publications/Pdf/core.pp.pdf">chapter</a>.</p>
</section>
<section id="q-can-i-evaluate-alignments-not-produced-with-t-coffee">
<h4>Q: Can I evaluate alignments NOT produced with T-Coffee?<a class="headerlink" href="#q-can-i-evaluate-alignments-not-produced-with-t-coffee" title="Permalink to this heading"></a></h4>
<p>A: Yes !! You may have an alignment produced from any source you like. If you have no library available, the library will be computed on the fly but this can take some time depending on your sample size.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>With a library:
$$: t_coffee -infile=sample_aln1.aln -lib=sample_aln1.tc_lib -special_mode=evaluate

Without a library:
$$: t_coffee -infile=sample_aln1.aln -evaluate -method proba_pair
</pre></div>
</div>
</section>
<section id="q-can-i-compare-two-alignments">
<h4>Q: Can I compare two alignments?<a class="headerlink" href="#q-can-i-compare-two-alignments" title="Permalink to this heading"></a></h4>
<p>A: Yes. You can treat one of your alignments as a library and compare it with the second alignment.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee -infile=sample_aln1_1.aln -aln=sample_aln1_2.aln -special_mode=evaluate
</pre></div>
</div>
</section>
<section id="q-i-am-aligning-sequences-with-long-regions-of-very-good-overlap">
<h4>Q: I am aligning sequences with long regions of very good overlap<a class="headerlink" href="#q-i-am-aligning-sequences-with-long-regions-of-very-good-overlap" title="Permalink to this heading"></a></h4>
<p>A: Increase the ktuple size (up to 4-5 for DNA) and up to 3 for proteins. This will speed up the program. It can be very useful, especially when aligning ESTs.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee sample_seq1.fasta -ktuple=3
</pre></div>
</div>
</section>
<section id="q-why-is-t-coffee-changing-the-names-of-my-sequences">
<h4>Q: Why is T-Coffee changing the names of my sequences!!!!<a class="headerlink" href="#q-why-is-t-coffee-changing-the-names-of-my-sequences" title="Permalink to this heading"></a></h4>
<p>A: If there is no duplicated name in your sequence set, T-Coffee handles names similarly to Clustalw. If your dataset contains sequences with identical names, these will automatically be renamed by adding an index (integer) to duplicated names even if there are more than 2. Also be careful, if there are spaces in your names, whatever comes after the space is not read.</p>
<div class="admonition danger">
<p class="admonition-title">Danger</p>
<p>The behaviour is undefined when this creates two sequence with a similar names.</p>
</div>
</section>
</section>
<section id="release-notes">
<h3>Release Notes<a class="headerlink" href="#release-notes" title="Permalink to this heading"></a></h3>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This log of modifications is not as thorough and accurate as it should be…but it’s a beginning !</p>
</div>
<ul class="simple">
<li><p>11.00+: extensive update of the documentation, examples; addition of the latest T-Coffee modes (PSI-Coffee, SARA-Coffee, Pro-Coffee, STRIKE, T-RMSD…); creation of an automated procedure for checking command lines from the documentation <strong>doc2test.pl</strong>.</p></li>
<li><p>9.86 New data structure for the primary library that results in highly improved running times for mcoffee and significantly decreased memory usage.</p></li>
<li><p>5.80 Novel assembly algorithm (linked_pair_wise) and the primary library is now made of probcons style pairwise alignments (proba_pair)</p></li>
<li><p>4.30 and upward: the FAQ has moved into a new tutorial document; <strong>-in</strong> can be replaced by the flags <strong>-profile,-method,-aln,-seq,-pdb</strong>.</p></li>
<li><p>4.02: <strong>-mode=dna</strong> is still available but not any more needed or supported. Use <strong>-type=protein or dna</strong> if you need to force things</p></li>
<li><p>3.28: corrected a bug that prevents short sequences from being correctly aligned</p></li>
<li><p>Use of &#64; as a separator when specifying methods parameters</p></li>
<li><p>The most notable modifications have to do with the structure of the input. From version 2.20, all files must be tagged to indicate their nature (A: alignment, S: Sequence, L: Library…). We are becoming stricter, but that’s for your own good… Another important modification has to do with the flag -matrix: it now controls the matrix being used for the computation</p></li>
</ul>
</section>
</section>
<span id="document-tcoffee_release_guide"></span><section id="t-coffee-release-guide">
<h2>T-Coffee release guide<a class="headerlink" href="#t-coffee-release-guide" title="Permalink to this heading"></a></h2>
<section id="introduction">
<h3>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading"></a></h3>
<p>Before the realease of a new T-Coffee version, many command lines in the documentation are programmatically tested. The purpose of this document is to explain how to make a new release, which command lines are tested, how new command lines can be added to the documentation and how to perform a documentation check before a new release.</p>
</section>
<section id="making-a-new-release">
<h3>Making a new release<a class="headerlink" href="#making-a-new-release" title="Permalink to this heading"></a></h3>
<p>T-Coffee is automatically build by using the [Circle CI](<a class="reference external" href="https://circleci.com/gh/cbcrg/tcoffee">https://circleci.com/gh/cbcrg/tcoffee</a>) service. The procedure starts with an update of the version number followed by a git push that triggers the validation of the new release on circleCI and a posting via an Amazon instance hosting the T-Coffee web site. All these operations are detailed below. Depending on the release type the correspinding counter will be incremented by 1 &lt;nmajor&gt;.&lt;stable&gt;.&lt;beta&gt;</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$#: cd t_coffee/src
$#: make release type=beta(default)|stable|major m=&#39;short description of the main feature&#39; test=core(default)|all|full|remote|docs|web|none
</pre></div>
</div>
<p>core  : will test a throrough set of commands
all   : will run all the test commands packaged as dumps in tests
full  : will test all the commands packaged as dumps in the git repo - they are normally in docs and tests
remote: will run all tze tests command dealing with remote access (BLAST and PDB)
docs  : will run all the dumps compiled from the rst files</p>
<section id="beta-release">
<h4>Beta Release<a class="headerlink" href="#beta-release" title="Permalink to this heading"></a></h4>
<p>For a beta, the following needs to go through:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$#: make release type=beta test=core|none
</pre></div>
</div>
</section>
<section id="stable-release">
<h4>Stable Release<a class="headerlink" href="#stable-release" title="Permalink to this heading"></a></h4>
<p>For a Stable, the following needs to go through:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$#: make release type=beta test=core
$#: make release type=stable teste=none
</pre></div>
</div>
</section>
<section id="major-release">
<h4>Major Release<a class="headerlink" href="#major-release" title="Permalink to this heading"></a></h4>
<p>For a Major, the following needs to go through. Note that a major implies some important milestone such as a publication. For a start, you should make sure the documentation compiles well. If needed you should recompile all the available tests</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$#: doc2test.pl -play docs/doc2test.rst -data docs/.data/ -dump docs/.dumps/ -update
$#: doc2test.pl -play tests/all2test.rst -data tests/.data/ -dump tests/.dumps/ -update
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>doc2test contains the list of ALL the rst files to be tested. Note that in an RST files, the only files CL that get tested are the ones starting wit <strong>$$</strong></p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The files required tu run the command lines are available in docs/.data and test/.data</p>
</div>
<p>Make sure ALL the tests pass well on your local machine before running them on CircleCI</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$#: doc2test.pl -replay  .
</pre></div>
</div>
<p>If they do, you should the run the following</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$#: make release type=beta test=full
</pre></div>
</div>
<p>If this beta is succesful, then you can pack the major</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$#: make release type=major teste=none
</pre></div>
</div>
</section>
</section>
<section id="release-building-procedure">
<h3>Release Building Procedure<a class="headerlink" href="#release-building-procedure" title="Permalink to this heading"></a></h3>
<p>This section explains how the release procedure works. Roughly speaking, the release is initiated on a local machine using the makefile (t_coffee/src/makefile). It is this procedure that increments the release version number (lib/version/version_number.version). This procedure makes a dummy distribution on the local machine and eventually pushes all the files in github. Thanks to a CircleCI hook, the push then initiates the building of a virtual machine in CircleCI where the final building procedure is carried out amd followed by a test (as specifiled in makefile test=&lt;test type&gt;. If the test is succesful, the procedure finishes with a publishing of the distribution.</p>
<section id="triggering-a-release">
<h4>Triggering a release<a class="headerlink" href="#triggering-a-release" title="Permalink to this heading"></a></h4>
<ul class="simple">
<li><p>go into t_coffee/src</p></li>
<li><p>type make release=beta|stable|major m=’commit comments’ – including [ci skip] if needed</p></li>
</ul>
<p>This will trigger
- An  update of the version number in lib/version/version_number.version: Version_&lt;major&gt;.&lt;stable&gt;.&lt;build&gt;.&lt;github Branch Number&gt;
- The file .circleci/config.yml will be programmatically edidted by read_program_version.pl to state the kind of release to be done by CircleCI
- The command ‘make distribution’ will run. Among othe things it will</p>
<blockquote>
<div><ul class="simple">
<li><p>Check that the distribution procedure is functional - it is a similar procedure that will be used by CircleCI</p></li>
<li><p>Compile the documentation with sphinx and update docs/.html – this requires sphinx to be installed on the local machine</p></li>
</ul>
</div></blockquote>
</section>
<section id="circleci-building">
<h4>CircleCI building<a class="headerlink" href="#circleci-building" title="Permalink to this heading"></a></h4>
<dl class="simple">
<dt>The tcoffee git repository is registered to CircleCI via the following hook:</dt><dd><p><a class="reference external" href="https://github.com/cbcrg/tcoffee/settings/hooks">https://github.com/cbcrg/tcoffee/settings/hooks</a></p>
</dd>
</dl>
<p>The Circle build is controlled by the [.circleci/circle.yml](circle.yml) file and processes as follows:</p>
<ol class="arabic simple">
<li><p>The T-Coffee [build/build.sh](build/build.sh) script is executed in the [cbcrg/tcoffee-build-box:1.2](docker/Dockerfile.buildbox) container</p></li>
<li><p>The T-Coffee binaries produced by the build process are created in the folder <cite>~/publish/sandbox/build</cite>. This folder is moved under path <cite>build/tcoffee</cite></p></li>
<li><p>A new Docker image named <cite>xcoffee</cite> is created copying the content of the folder <cite>build/tcoffee</cite>.The image is built by using this [docker/Dockerfile](docker/Dockerfile).</p></li>
<li><p>The new <cite>xcoffee</cite> build is tested by running the [docker/run-tests.sh](docker/run-tests.sh)tests suite.</p></li>
<li><p>The summary of the tests is available on <a class="reference external" href="https://circleci.com/gh/cbcrg/tcoffee/tree/master">https://circleci.com/gh/cbcrg/tcoffee/tree/master</a></p></li>
<li><p>If all tests are passed the <cite>xcoffee</cite> image is pushed to the [Docker Hub](<a class="reference external" href="https://hub.docker.com/r/cbcrg/tcoffee/tags/">https://hub.docker.com/r/cbcrg/tcoffee/tags/</a>) with the names <cite>cbcrg/tcoffee:latest</cite> and <cite>cbcrg/tcoffee:&lt;version.commit-id&gt;</cite></p></li>
<li><p>The environment variable <cite>RELEASE=0|1</cite> is used to mark the build as beta or stable (use the [build/make_release.sh] to trigger a new release build).</p></li>
</ol>
</section>
<section id="publication">
<h4>Publication<a class="headerlink" href="#publication" title="Permalink to this heading"></a></h4>
<p>Once the build is complete and all tests are passed the distribution is pushed onto the web along with the associated documentation.</p>
<p>The utility doc2test.pl makes it possible to run a command line on data located in a folder and to produce a dump file that will then be a stand alone tests, that can be transfered and replayed. The dump file is a container in which the input, the stdoin, stdout, environement and output of the run are recorded.</p>
<p>Tests are systematically carried out on all the command lines that start with the symbol $$. For instance, the following CL will has been tested.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$#: t_coffee
</pre></div>
</div>
<p>Other command lines starting with different symbols are not checked. Two types of command lines identifiers are used:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$#: t_coffee
</pre></div>
</div>
<p>For a command that could be tested but will not be, either for the sake of time or because it is currently unstable. When a new release needs to be urgently made available because of a critical fix, it is advisable to comment out this way non critical command lines failing the test.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$#: t_coffee
</pre></div>
</div>
<p>These commands are never tested, either because they contain system dependant information or non programmatic information.</p>
<p>Whenvever adding a new command, input files must be added to the repository directory ./examples/. New commands can be also be built using the existing files, or they can depend on files newly added to the repository.</p>
</section>
<section id="using-doc2test-pl">
<h4>Using doc2test.pl<a class="headerlink" href="#using-doc2test-pl" title="Permalink to this heading"></a></h4>
<p>The utility doc2test is meant to do the following actions:</p>
<p>The play action will compile dump files.</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#$: ./lib/perl/lib/perl4makefile/doc2test.pl -play &lt;*.rst file or *.tests file or list of cmd in txt&gt; -data &lt;folder containing the data&gt; -dumps &lt;target directory for dumps&gt;</span>
</pre></div>
</div>
</div></blockquote>
<p>The Check action will recursively go through any directory and report the exit status of each dump</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#$: ./lib/perl/lib/perl4makefile/doc2test.pl -check &lt;dump directory - recursive&gt;</span>
</pre></div>
</div>
<p>Note that while compiling Command Lines, you can use check to clean your directory and remove any failed dump.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#$: ./lib/perl/lib/perl4makefile/doc2test.pl -check &lt;dump directory - recursive&gt; -clean FAILED or -clean2 &lt;string in dump to be deleted&gt;</span>
</pre></div>
</div>
<p>You should also use check to make a fresh build and remove all previous dumps:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#$: ./lib/perl/lib/perl4makefile/doc2test.pl -check &lt;dump directory - recursive&gt; -clean ALL</span>
</pre></div>
</div>
<p>And you can the re-run the play that will only regenerate missing dumps:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#$: ./lib/perl/lib/perl4makefile/doc2test.pl -play &lt;*.rst file or *.tests file or list of cmd in txt&gt; -data &lt;folder containing the data&gt; -dumps &lt;target directory for dumps&gt;</span>
</pre></div>
</div>
<p>The replay action will re-run each dump and report the status. It will report new warnings.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#$: ./lib/perl/lib/perl4makefile/doc2test.pl -replay &lt;dump directory - recursive&gt;</span>
</pre></div>
</div>
<p>The unplay option maked it possible to output the inoput files of every dump</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#$: ./lib/perl/lib/perl4makefile/doc2test.pl -replay &lt;dump directory - recursive&gt; -outdir &lt;file in which data should be dumped&gt;</span>
</pre></div>
</div>
</section>
<section id="compiling-tests-from-the-rst-documentation">
<h4>Compiling tests from the rst documentation<a class="headerlink" href="#compiling-tests-from-the-rst-documentation" title="Permalink to this heading"></a></h4>
<p>The rst documentation contain lines tagged with two $$ signs. These lines will be selected for validation and used to build dump files. In order to run a fresh collection of dumps for the full documentation, run the foillowing commands:</p>
<p>The simplest way to compile all possible tests from the the documentation is to run the following command from the top of the git repo.</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#$: ./lib/perl/lib/perl4makefile/doc2test.pl -check docs/.dumps -clean ALL</span>
<span class="c1">#$: ./lib/perl/lib/perl4makefile/doc2test.pl -play docs/doc2test.rst -data docs/.data -dump docs/.dumps</span>
</pre></div>
</div>
</div></blockquote>
<p>The output can then be checked</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#$: ./lib/perl/lib/perl4makefile/doc2test.pl -check docs/.dumps</span>
</pre></div>
</div>
<p>The failing jobs can be removed and re-run once the issue has been identified (usualy a missing file):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#$: ./lib/perl/lib/perl4makefile/doc2test.pl -check docs/.dumps -clean FAILED</span>
</pre></div>
</div>
<p>Note that in order to figure out an issue you can use the replay debug option</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#$: ./lib/perl/lib/perl4makefile/doc2test.pl -replay &lt;dump file&gt; -debug</span>
</pre></div>
</div>
<p>You can the re-run all the dumps. This is how the tests will be carried out by CircleCI</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#$: ./lib/perl/lib/perl4makefile/doc2test.pl -replay docs/.dumps</span>
</pre></div>
</div>
</section>
<section id="compiling-tests-commands">
<h4>Compiling tests commands<a class="headerlink" href="#compiling-tests-commands" title="Permalink to this heading"></a></h4>
<p>tests are special types of pre-compiled commands used to validate specific components of T-Coffee. You can compile and use thsis test in the same way as rst files.</p>
</section>
<section id="creating-a-new-command-to-be-tested">
<h4>Creating a new command to be tested<a class="headerlink" href="#creating-a-new-command-to-be-tested" title="Permalink to this heading"></a></h4>
<p>In order to generate a new test command, all you need to do is to run your command while setting an environement variable. This will generate a dump file that can be used torerun the same call. Dump files are very easy to produce yout simply need to run</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">##:rm -f &lt;your dump file&gt;;export DUMP_4_TCOFFEE=&lt;your dump file&gt;;t_coffee -in seq</span>
<span class="n">OR</span>
<span class="c1">##:rm -f &lt;your dump file&gt;;export DUMP_4_TCOFFEE=&lt;your dump file&gt;;t_coffee -other_pg seq_reformat -in xxxx/xx/s.pep -output fasta_seq &gt; yyy</span>
</pre></div>
</div>
<p>This command will generate a self contained dumpfile. This dumpfile will contain all the information needed ton reprodduce the runn (i.e file name, path, content and T-Coffee parameters). In order to reproduce the call you need to have T-Coffee installed and run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">##: ./lib/perl/lib/perl4makefile/doc2test.pl -replay yourdumpfile</span>
</pre></div>
</div>
<p>Will allow you to check if the command runs and produces similar files. By default the test is “PASSED” if no error is thrown by the call. This can be refined as follows:</p>
<blockquote>
<div><p>##: ./lib/perl/lib/perl4makefile/doc2test.pl -replay yourdumpfile -strict</p>
</div></blockquote>
<p>Will report failure whenever an output file is missing or whenever an error is reported.</p>
<blockquote>
<div><p>##: ./lib/perl/lib/perl4makefile/doc2test.pl -replay yourdumpfile -very_strict</p>
</div></blockquote>
<p>Will report failure whenever there is a warning OR whenever an output file differs (Note that VERSION and CPU are excluded from the comparison as a consequence different versions will not result in different output files). It is possible to visualize the replayed dump for debugging purposes.</p>
<blockquote>
<div><p>##: ./lib/perl/lib/perl4makefile/doc2test.pl -replay yourdumpfile -keepreplayed</p>
</div></blockquote>
</section>
</section>
</section>
<span id="document-tcoffee_release_notes"></span><section id="release-notes">
<h2>Release Notes<a class="headerlink" href="#release-notes" title="Permalink to this heading"></a></h2>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This log of recent modifications is not as thorough and accurate as it should be.</p>
</div>
<p>-14.00 new faster regressive algorithm</p>
<p>-9.86 New data structure for the primary library that results in highly improved running times for mcoffee and significantly decreased memory usage.</p>
<p>-5.80 Novel assembly algorithm (linked_pair_wise) and the primary library is now made of probcons style pairwise alignments (proba_pair)</p>
<p>-4.30 and upward: the FAQ has moved into a new tutorial document</p>
<p>-4.30 and upward: -in has will be deprecated and replaced by the flags: -profile,-method,-aln,-seq,-pdb</p>
<p>-4.02: -mode=dna is still available but not any more needed or supported. Use type=protein or dna if you need to force things</p>
<p>-3.28: corrected a bug that prevents short sequences from being correctly aligned</p>
<p>-Use of &#64; as a separator when specifying methods parameters</p>
<p>-The most notable modifications have to do with the structure of the input. From version 2.20, all files must be tagged to indicate their nature (A: alignment, S: Sequence, L: Library…). We are becoming stricter, but that’s for your own good…</p>
<p>Another important modification has to do with the flag -matrix: it now controls the matrix being used for the computation</p>
</section>
<span id="document-tcoffee_citations_references"></span><section id="citations-references">
<h2>Citations &amp; References<a class="headerlink" href="#citations-references" title="Permalink to this heading"></a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is important that you cite T-Coffee when you use it. Citing us is (almost) like giving us money: it helps us convincing our institutions that what we do is useful and that they should keep paying our salaries and deliver donuts to our offices from time to time (Not that they ever did it, but it would be nice anyway). Cite the approriate web server if you use one, otherwise, cite the original paper from 2000 (By the way…NOOO, it was never named ‘T-Coffee 2000’).</p>
</div>
<section id="comparative-genomics-biology">
<h3>Comparative Genomics &amp; Biology<a class="headerlink" href="#comparative-genomics-biology" title="Permalink to this heading"></a></h3>
<p>Erb, I., Notredame, C. <strong>How should we measure proportionality on relative gene expression data?</strong> Theory Biosci., 135(1-2):21-36 (2016), PMID26762323</p>
<p>Catuara-Solarz, S., Espinosa-Carrasco, J., Erb, I., Langohr, K., Gonzalez, J.R., Notredame, C., Dierssen, M. <strong>Combined treatment with environmental enrichment and (-)-epigallocatchin-3-gallate ameliorates learning deficits and hippocampal alterations in a mouse model of Down syndrome</strong>. eNeuro., 3(5)(2015) pii:ENEURO.0103, PMID:27844057</p>
<p>Di Tommaso, P., Palumbo, E., Chatzou, M., Prieto, P.,Heuer, M.L., Notredame, C. <strong>The impact of Docker containers on ther performance of genomic pipelines</strong>. PeerJ., 3:e1273 (2015), PMID:26421241</p>
<p>Catuara-Solarz, S., Espinosa-Carrasco, J., Erb, I., Langohr, K., Notredame, C., Gonzalez, J.R., Dierssen, M. <strong>Principal component analysis of the effects of environmental enrichment and (-)-epigallocatchin-3-gallate on age-associated learning deficits in a mouse model of Down syndrome</strong>. Front Behav. Neurosci., 9:330 (2015), PMID:26696850</p>
<p>Earl, D., Nguyen, N., Hickey, G., Harris, R.S., Fitzgerald, S., Beal, K. Seledtsov, I., Raney, B.J., Clawson, H., Kim, J., Kemena, C., Chang, J.-M., Erb, I., Poliakov, A., Hou, M., Herrero, J., Kent, W.J., Solovyev, V., Darling, A.E., Ma, J., Notredame, C., Brudno, M., Dubchak, I., Haussler, D., Paten, B. <strong>Alignathon: a competitive assessment of whole-geome alignment methods</strong>. Genome Res., 24(12):2077-2089 (2014), PMID:25273068</p>
<p>The mouse ENCODE Consortium. <strong>A comparative encyclopedia of DNA elements in the mouse genome</strong>.  Nature, 515(7527):355-364 (2014), PMID:25409824</p>
<p>Bussotti, G., Notredame, C., Enright, A.J. <strong>Detecting and comparing non-coding RNAs in the high-throughput era</strong>. Int. J. Mol. Sci., 14(8):15423-15458 (2013), PMID:23887659</p>
<p>Chang, J.-M., Taly, J.-F., Erb, I., Sung, T.Y., Hsu, W.L. Tang, C.Y., Notredame, C., Su, E.C. <strong>Efficient and interpretable prediction of protein functional classes by correspondence analysis and compact set relations</strong>. PLoS One, 8(10):e75542 (2013), PMID:24146760</p>
<p>Magis, C., van der Sloot, A.M., Serrano, L., Notredame, C. <strong>An improved understanding of TNFL/TNFR interactions using structure-based classifications</strong>. Trends Biochem. Sci., 37(9):353-363 (2012), PMID:22789664</p>
<p>Derrien, T., Johnson, R., Bussotti, G., Tanzer, A., Djebali, S., Tilgner, H., Guernec, G., Martin, D., Merkel, A., Knowles, D.G., Lagarde, J., Veeravalli, L., Ruan, X., Ruan, Y., Lassmann, T., Carninci, P., Brown, J.B., Lipovich, L., Gonzalez, J.M., Davis, C.A., Shiekhattar, R., Gingeras, T.R., Hubbard, T.J., Notredame, C., Harrow, J., Guigó, R. <strong>The GENCODE v7 catalog of human long noncoding RNAs: analysis of their gene structure, evolution and expression</strong>. Genome Res., 22(9):1775-1789 (2012), PMID:22955988</p>
<p>Breen, M.S., Kemena, C., Vlasov, P.K., Notredame, C., Kondrashov, F.A. <strong>Epistasis as the primary factor in molecular evolution</strong>. Nature, 490(7421), 535-538 (2012), PMID:23064225</p>
<p>Bussotti, G., Raineri, E., Erb, I., Zytnicki, M., Wilm, A., Beaudoing, E., Bucher, P., Notredame, C. <strong>BlastR-fast and accurate database searches for non-coding RNAs</strong>. Nucleic Acids Res., 39(16):6886-6895 (2011), PMID:21624887</p>
<p>Lin, H.N., Notredame, C., Chang, J.-M., Sung, T.Y., Hsu, W.L. <strong>Improving the alignment quality of consistency based aligners with an evaluation function using synonymous protein words</strong>. PLoS One, 6(12):e27872, (2011), PMID:22163274</p>
<p>Ørom, U.A., Derrien, T., Beringer, M., Gumireddy, K., Gardini, A., Bussotti, G., Lai, F., Zytnicki, M., Notredame, C., Huang, Q., Guigo, R., Shiekhattar, R. <strong>Long noncoding RNAs with enhancer-like function in human cells</strong>. Cell, 143(1):46-58 (2010), PMID:20887892</p>
<p>Coll, O., Villalba, A., Bussotti, G., Notredame, C., Gebauer, F. <strong>A novel, noncanonical mechanism of cytoplasmic polyadenylation operates in Drosophila embryogenesis</strong>. Genes Dev., 24(2):129-134 (2010), PMID:20080951</p>
<p>Rausch, T., Emde, A.K., Weese, D., Döring, A., Notredame, C., Reinert, K. <strong>Segment-based multiple sequence alignment</strong>. Bioinformatics, 24(16):i187-i192 (2008), PMID:18689823</p>
<p>Dietmann, S:, Park, J., Notredame, C., Heger, A., Lappe, M., Holm, L. <strong>A fully automatic evolutionary classification of protein folds: Dali Domain Dictionary version 3</strong>. Nucleic Acids Res., 29(1):55-57 (2001), PMID:11125048</p>
</section>
<section id="t-coffee-alignment-methods">
<h3>T-Coffee Alignment Methods<a class="headerlink" href="#t-coffee-alignment-methods" title="Permalink to this heading"></a></h3>
<p>Kemena, C., Bussotti, G., Capriotti, E., Marti-Renom, M.A., Noredame, C. <strong>Using tertiary structure for computation of highly accurate multiple RNA alignments with the SARA-Coffee package</strong>. Bioinformatics, 29(9):1112-1119 (2013), PMID:234490094</p>
<p>Erb, I., González-Vallinas, J.R., Bussotti, G., Blanco, E., Eyras, E., Notredame, C. <strong>Use of ChIP-Seq data for the design of a multiple promoter-alignment method</strong>. Nucleic Acids Res., 40(7):e52 (2012), PMID:22230796</p>
<p>Chang, J.-M., Di Tommaso, P., Taly, J.-F., Notredame, C. <strong>Accurate multiple sequence alignment of transmembrane proteins with PSI-Coffee</strong>. BMC Bioinformatics, 13 Suppl 4:S1 (2012). PMID:22536955</p>
<p>Di Tommaso, P., Orobitg, M., Guirado, F., Cores, F., Espinosa, T., Notredame, C. <strong>Cloud-Coffee: implementation of a parallel consistency-based multiple alignment algorithm in the T-Coffee package and its benchmarking on the Amazon Elastic-Cloud</strong>. Bioinformatics, 26(15):1903-1904 (2010). PMID:20605929</p>
<p>Wilm, A., Higgins, D.G., Notredame, C. <strong>R-Coffee: a method for multiple alignment of non-coding RNA</strong>. Nucleic Acids Res., 36(9):e52 (2008), PMID:18420654</p>
<p>Armougom, F., Moretti, S., Poirot, O., Audic, S., Dumas, P., Schaeli, B., Keduas, V., Notredame. C. <strong>Expresso: automatic incorporation of structural information in multiple sequence alignments using 3D-Coffee</strong>. Nucleic Acids Res., 34:W604-W608 (2006), PMID:16845081</p>
<p>Wallace, I.M., O’Sullivan, O., Higgins, D.G., Notredame, C. <strong>M-Coffee: combining multiple sequence alignment methods with T-Coffee</strong>. Nucleic Acids Res., 34(6):1692-1699 (2006), PMID:16556910</p>
<p>O’Sullivan, O., Suhre, K., Abergel, C., Higgins, D.G., Notredame, C. <strong>3DCoffee: combining protein sequences and structures within multiple sequence alignments</strong>. J. Mol. Biol., 340(2):385-395 (2004). PMID: 15201059</p>
<p>O’Sullivan, O., Zehnder, M., Higgins, D.G., Bucher, P., Grosdidier, A., Notredame, C. <strong>APDB: a novel measure for benchmarking sequence alignment methods without reference alignments</strong>. Bioinformatics, 19 Suppl 1:i215-i221 (2003). PMID:12855461</p>
<p>Notredame, C. <strong>Mocca: semi-automatic method for domain hunting</strong>. Bioinformatics, 17(4):373-374 (2001). PMID: 11301309</p>
<p>Notredame, C., Higgins, D.G., Heringa, J. <strong>T-Coffee: A novel method for fast and accurate multiple sequence alignment</strong>. J. Mol. Biol., 302(1):205-217 (2000). PMID: 10964570</p>
<p>Notredame, C., Holm, L., Higgins, D.G. <strong>COFFEE: an objective function for multiple sequence alignments</strong>. Bioinformatics, 14(5):407-422 (1998). PMID: 968205</p>
</section>
<section id="t-coffee-web-servers">
<h3>T-Coffee Web Servers<a class="headerlink" href="#t-coffee-web-servers" title="Permalink to this heading"></a></h3>
<p>Floden, E.W., Tommaso, P.D., Chatzou, M., Magis, C., Notredame, C., Chang, J.-M. <strong>PSI/TM-Coffee: a web server for fasta accurate multiple sequence alignments of regular and transmembrane proteins using homology extension on reduced databases</strong>. Nucleic Acids Res., 44(W1):W339-W343 (2016). PMID:27106060</p>
<p>Chang, J.-M.*, Tommaso P.*, Lefort, V., Gascuel, O., Notredame, C. <strong>TCS: a web server for multiple sequence alignment evaluation and phylogenetic reconstruction</strong>. Nucleic Acids Research. 43(W1):W3-6 (2015). PMID: (<a href="#id1"><span class="problematic" id="id2">*</span></a>These two authors contribute equally)</p>
<p>Di Tommaso, P., Bussotti, G., Kemena, C., Capriotti, E., Chatzou, M., Prieto, P., Notredame, C. <strong>SARA-Coffee web server, a tool for computation of RNA sequence and structure multiple alignments</strong>. Nucleic Acids Res., 42(Web Server issue):W356-W360 (2014). PMID:24972831</p>
<p>Magis, C., Di Tommaso, P., Notredame, C. <strong>T-RMSD: a web server for automated fine-grained protein structural classifcation</strong>. Nucleic Acids Res., 41(Web Server issue):W358-W362 (2013). PMID:23716642</p>
<p>Rius, J., Cores, F., Solsona, F., van Hemert, J.I., Koetsier, J., Notredame, C. <strong>A user-friendly web portal for T-Coffee on supercomputers</strong>. BMC Bioinformatics, 12:150 (2011). PMID:21569428</p>
<p>Di Tommaso, P., Moretti, S., Xenarios, I., Orobitg, M., Montanyola, A., Chang, J.-M., Taly, J.-F., Notredame, C. <strong>T-Coffee: a web server for the multiple sequence alignment of protein and RNA sequences using structural information and homology extension</strong>. Nucleic Acids Res., 39(Web Server issue):W13-W17 (2011). PMID:21558174</p>
<p>Moretti, S., Wilm, A., Higgins, D.G., Xenarios, I., Notredame, C. <strong>R-Coffee: a web server for accurately aligning noncoding RNA sequences</strong>., Nucleic Acids Res., 36(Web Server issue):W10-W13 (2008). PMID:18483080</p>
<p>Moretti, S., Armougom, F., Wallace, I.M., Higgins, D.G., Jongeneel, C.V., Notredame, C. <strong>The M-Coffee web server: a meta-method for computing multiple sequence alignments by combining alternative alignment methods</strong>. Nucleic Acids Res., 35(Web Server issue):W645-W648 (2007). PMID:17526519</p>
<p>Moretti, S., Reinier, F., Poirot, O., Armougom, F., Audic, S., Keduas, V., Notredame, C. <strong>PROTOGENE: turning amino acid alignments into bona fide CDS nucleotide alignments</strong>. Nucleic Acids Res., 34(Web server issue):W600-W603 (2006), PMID:16845080</p>
<p>Armougom, F., Moretti, S., Keduas, V., Notredame, C. <strong>The iRMSD: a local measure of sequence alignment accuracy using structural information</strong>. Bioinformatics, 22(14):e35-e39 (2006). PMID:16873492</p>
<p>Armougom, F., Poirot, O., Moretti, S., Higgins, D.G., Bucher, P., Keduas, V., Notredame, C. <strong>APDB: a web server to evaluate the accuracy of the sequence alignments using structural information</strong>. Bioinformatics, 22(19):2439-2440 (2006). PMID:17032685</p>
<p>Claude, J.B., Suhre, K., Notredame, C., Claverie, J.M., Abergel C. <strong>CaspR: a web server for automated molecular replacement using homology modelling</strong>. Nucleic Acids Res., 32(Web Server issue):W606-9 (2004). PMID:15215460</p>
<p>Poirot, O., Suhre, K., Abergel, C., O’Toole, E., Notredame, C. <strong>3DCoffee&#64;igs: a web server for combining sequences and structures into a multiple sequence alignment</strong>. Nucleic Acids Res., 32(Web Server issue):W37-40 (2004). PMID: 15215345</p>
<p>Poirot, O., O’Toole, E., Notredame, C. <strong>Tcoffee&#64;igs: a web server for computing, evaluating and combining multiple sequence alignments</strong>. Nucleic Acids Res., Jul 1;31(13):3503-6 (2003). PMID: 12824354</p>
</section>
<section id="t-coffee-tools-for-msa-evaluation">
<h3>T-Coffee Tools For MSA Evaluation<a class="headerlink" href="#t-coffee-tools-for-msa-evaluation" title="Permalink to this heading"></a></h3>
<p>Chang, J.-M., Tommaso, P., Notredame, C. <strong>TCS: a new Multiple Sequence Alignment reliability measure to estimate alignment accuracy and improve phylogenetic tree reconstruction</strong>. Molecular Biology and Evolution, 31(6):1625-37 (2014). PMID:24694831</p>
<p>Kemena, C., Taly, J.-F., Kleinjung, J., Notredame, C. <strong>STRIKE: evaluation of protein MSAs using a single 3D structure</strong>. Bioinformatics, 27(24):3385-3391 (2011). PMID:220339207</p>
<p>Magis, C., Stricher, F., van der Sloot, A.M., Serrano, L., Notredame, C. <strong>T-RMSD: a fine-grained, structure based classification method and its application to the functional characterization of TNF receptors</strong>. J. Mol. Biol., 400(3):605-617 (2010), PMID:20471393</p>
<p>Armougom, F., Moretti, S., Keduas, V., Notredame, C. <strong>The iRMSD: a local measure of sequence alignment accuracy using structural information</strong>. Bioinformatics, 22(14):e35-e39 (2006), PMID:16873492</p>
</section>
<section id="reviews-briefings-books">
<h3>Reviews, Briefings &amp; Books<a class="headerlink" href="#reviews-briefings-books" title="Permalink to this heading"></a></h3>
<p>Chatzou, M., Magis, C., Chang, J.-M., Kemena, C., Bussotti, G., Erb, I., Notredame, C. <strong>Multiple sequence alignment modeling: methods and applications</strong>. Brief Bioinform., pii: bbv099 (2015). PMID:26615024</p>
<p>Magis, C., Taly, J.-F., Bussotti, G., Chang, J.M., Di Tommaso, P., Erb, I., Espinosa-Carrasco, J., Notredame, C. <strong>T-Coffee: tree-based consistency objective function for alignment evaluation</strong>. Methods Mol. Biol., 1079:117-129 (2014). PMID:24170398</p>
<p>Taly, J.-F.*, Magis, C.*, Bussotti, G., Chang, J.-M., Di Tommaso, P., Erb, I., Espinosa-Carrasco, J., Kemena, C., Notredame, C. <strong>Using the T-Coffee package to build multiple sequence alignments of protein, RNA, DNA sequences and 3D structures</strong>. Nature Protocols, 1669-1682 (2011), PMID:21979275 (<a href="#id3"><span class="problematic" id="id4">*</span></a>These two authors contribute equally)</p>
<p>Notredame, C. <strong>Computing multiple sequence/structure alignments with the T-Coffee package</strong>. Curr. Protoc. Bioinformatics, Chapter 3, Unit 3.8.1-25 (2010). PMID:20205190</p>
<p>Kemena, C., Notredame, C. <strong>Upcoming challenges for multiple sequence alignment methods in the high-throughput era</strong>. Bioinformatics, 25(19):2455-2465 (2009). PMID:19648142</p>
<p>Notredame, C. <strong>Recent evolutions of multiple sequence alignment algorithms</strong>. PLoS Comput. Biol., 3(8):e123 (2007). PMID:17784778</p>
<p>Notredame, C., Suhre, K. <strong>Computing multiple sequence/structure alignments with the T-Coffee package</strong>. Curr. Protoc. Bioinformatics, Chapter 3:Unit 3.8 (2004), PMID:18428722</p>
<p>Notredame, C., Abergel, C. <strong>Using multiple alignment methods to assess the quality of genomic data analysis</strong>. In: Andrade MA, editor. Bioinformatics and genomes: current perspectives. Wymondham (UK): Horizon Scientific Press,30–50 (2003).</p>
<p>Notredame, C. <strong>Recent progress in multiple sequence alignment: a survey</strong>. Pharmacogenomics, 3(1):131-144 (2002). PMID:11966409</p>
</section>
</section>
<span id="document-tcoffee_contacts_adresses"></span><section id="contacts-adresses-contributions">
<h2>Contacts, Adresses &amp; Contributions<a class="headerlink" href="#contacts-adresses-contributions" title="Permalink to this heading"></a></h2>
<section id="contact-us">
<h3>Contact us<a class="headerlink" href="#contact-us" title="Permalink to this heading"></a></h3>
<p>If you have any problem, question, suggestion or else, contact Cedric Notredame by mail at <a class="reference external" href="mailto:cedric&#46;notredame&#37;&#52;&#48;crg&#46;eu">cedric<span>&#46;</span>notredame<span>&#64;</span>crg<span>&#46;</span>eu</a> or at the T-Coffee group <a class="reference external" href="mailto:tcoffee&#37;&#52;&#48;googlegroups&#46;com">tcoffee<span>&#64;</span>googlegroups<span>&#46;</span>com</a>.</p>
</section>
<section id="adresses">
<h3>Adresses<a class="headerlink" href="#adresses" title="Permalink to this heading"></a></h3>
<p>The T-Coffee group is currently at the Centre for Genomic Regulation (CRG), programme of Bioinformatics and Genomics (BiG), in Barcelona (PRBB, 88 calle del Doctor Aiguader, 08003, Barcelona). We are always very eager to get some user feedback, so please do not hesitate to drop us a line at <a class="reference external" href="mailto:cedric&#46;notredame&#37;&#52;&#48;crg&#46;eu">cedric<span>&#46;</span>notredame<span>&#64;</span>crg<span>&#46;</span>eu</a>. The latest updates of T-Coffee are always available on our <a class="reference external" href="http://www.tcoffee.org">group webpage</a> where you will also find links to all the online T-Coffee servers.</p>
</section>
<section id="contributions">
<h3>Contributions<a class="headerlink" href="#contributions" title="Permalink to this heading"></a></h3>
<section id="main-contributions">
<h4>Main Contributions<a class="headerlink" href="#main-contributions" title="Permalink to this heading"></a></h4>
<p>T-coffee is developed, maintained, monitored, used and debugged by a dedicated team that include or have included:</p>
<p>Cedric Notredame, Paolo di Tommaso, Jean-François Taly, Cedrik Magis, Fabrice Armougom, Des Higgins, Sebastien Moretti,
Orla O’Sullivan, Eamon O’Toole, Olivier Poirot, Karsten Suhre, Iain Wallace, Andreas Wilm, Vladimir Keduas.</p>
</section>
<section id="other-contributions">
<h4>Other Contributions<a class="headerlink" href="#other-contributions" title="Permalink to this heading"></a></h4>
<p>We do not mean to steal code, but we will always try to re-use pre-existing code whenever that code exists, free of copyright,
just like we expect people to do with our code. However, whenever this happens, we make a point at properly citing the source
of the original contribution. If ever you recognize a piece of your code improperly cited, please drop us a note and we will be
happy to correct that.</p>
<section id="softwares">
<h5>Softwares<a class="headerlink" href="#softwares" title="Permalink to this heading"></a></h5>
<p>In the mean time, here are some important pieces of code from other packages that have been incorporated within the T-Coffee
package. These include:</p>
<blockquote>
<div><ul class="simple">
<li><p>TMalign package from Zhang, Jeffrey and Skolnik (NAR, 2005, 33:2303).</p></li>
<li><p>The Sim algorithm of Huang and Miller that given two sequences computes the N best scoring local alignments.</p></li>
<li><p>The tree reading/computing routines are taken from the ClustalW Package, courtesy of Julie Thompson, Des Higgins and Toby Gibson (Thompson, Higgins, Gibson, 1994, 4673-4680,vol. 22, Nucleic Acid Research).</p></li>
<li><p>The implementation of the algorithm for aligning two sequences in linear space was adapted from Myers and Miller, in CABIOS, 1988, 11-17, vol. 1).</p></li>
<li><p>Various techniques and algorithms have been implemented. Whenever relevant, the source of the code/algorithm/idea is indicated in the corresponding function.</p></li>
<li><p>64 Bits compliance was implemented by Benjamin Sohn, Performance Computing Center Stuttgart (HLRS), Germany</p></li>
<li><p>David Mathog (Caltech) provided many fixes and useful feedback for improving the code and making the whole soft behaving more rationally.</p></li>
</ul>
</div></blockquote>
<p>An enormous thanks to these people who believe in free open source code.</p>
</section>
<section id="bug-reports-and-feedback">
<h5>Bug reports and feedback<a class="headerlink" href="#bug-reports-and-feedback" title="Permalink to this heading"></a></h5>
<blockquote>
<div><ul class="simple">
<li><p>Prof David Jones (UCL) reported and corrected the PDB1K bug (now t_coffee/sap can align PDB sequences longer than 1000 AA).</p></li>
<li><p>Johan Leckner reported several bugs related to the treatment of PDB structures, insuring a consistent behavior between version 1.37 and current ones.</p></li>
<li><p>Enrico Bonatesta reported several mistakes in the T-Coffee tutorial and provided feedbacks about its readibility.</p></li>
<li><p>…and to everyone else who send us their feedbacks and suggestions helping us to improve T-Coffee.</p></li>
</ul>
</div></blockquote>
</section>
</section>
</section>
</section>
<span id="document-tcoffee_license"></span><section id="license-terms-of-use">
<h2>License &amp; Terms of Use<a class="headerlink" href="#license-terms-of-use" title="Permalink to this heading"></a></h2>
<p><strong>T-Coffee is distributed under the Gnu Public License</strong></p>
<p>Please make sure you have agreed with the terms of the license attached to the package before using the T-Coffee package or its documentation. T-Coffee is a freeware open source distributed under a GPL license. This means that there are very little restrictions to its use, either in an academic or a non academic environment.</p>
<p><strong>T-Coffee code can be re-used freely</strong></p>
<p>Our philosophy is that code is meant to be re-used, including ours. No permission is needed for the cut and paste of a few functions, although we are always happy to receive pieces of improved code.</p>
<p><strong>T-Coffee can be incorporated in most pipelines: Plug-in/Plug-out…</strong></p>
<p>Our philosophy is to insure that as many methods as possible can be used as plug-ins within T-Coffee. Likewise, we will give as much support as possible to anyone wishing to turn T-Coffee into a plug-in for another method. For more details on how to do this, see the plug-in and the plug-out sections of the Tutorial Manual.</p>
<p>Again, you do not need our permission to either use T-Coffee (or your method as a plug-in/out) but if you let us know, we will insure the stability of T-Coffee within your system through future releases.</p>
<p>The current license only allows for the incorporation of T-Coffee in non-commercial pipelines (i.e. where you do not sell the pipeline, or access to it). If your pipeline is commercial, please get in touch with us.</p>
<p>T-Coffee can be used to automatically check if an updated version is available, however the program will not update automatically, as this can cause endless reproducibility problems.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$$: t_coffee -update
</pre></div>
</div>
</section>
</div>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2018, Cedric Notredame.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>